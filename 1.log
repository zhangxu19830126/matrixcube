======== test matrixcube
# go test  -v -count=1 -timeout 600s github.com/matrixorigin/matrixcube/storage
go test  -v -count=1 -timeout 600s github.com/matrixorigin/matrixcube/raftstore
WARNING: Package "github.com/golang/protobuf/protoc-gen-go/generator" is deprecated.
	A future release of golang/protobuf will delete this package,
	which has long been excluded from the compatibility promise.

=== RUN   TestIssue97
2021/08/20 14:25:04.476486 [info] prophet: prophet logger set
2021/08/20 14:25:04.491698 [info] [raftstore]: start scan gc snap files
2021/08/20 14:25:04.491712 [info] [raftstore]: begin start raftstore
2021/08/20 14:25:04.491714 [info] [raftstore]: begin to start prophet
[WARNING] Deprecated '--logger=capnslog' flag is set; use '--logger=zap' flag instead
2021-08-20 14:25:04.491766 I | embed: pprof is enabled under /debug/pprof
2021-08-20 14:25:04.491809 I | embed: name = node-0
2021-08-20 14:25:04.491820 I | embed: data dir = /tmp/cube/node-0/prophet
2021-08-20 14:25:04.491822 I | embed: member dir = /tmp/cube/node-0/prophet/member
2021-08-20 14:25:04.491824 I | embed: heartbeat = 100ms
2021-08-20 14:25:04.491825 I | embed: election = 3000ms
2021-08-20 14:25:04.491826 I | embed: snapshot count = 100000
2021-08-20 14:25:04.491833 I | embed: advertise client URLs = http://127.0.0.1:40000
2021-08-20 14:25:04.495499 I | etcdserver: starting member 93ccda9956d988f4 in cluster 6a4ade671189dc2f
raft2021/08/20 14:25:04 INFO: 93ccda9956d988f4 switched to configuration voters=()
raft2021/08/20 14:25:04 INFO: 93ccda9956d988f4 became follower at term 0
raft2021/08/20 14:25:04 INFO: newRaft 93ccda9956d988f4 [peers: [], term: 0, commit: 0, applied: 0, lastindex: 0, lastterm: 0]
raft2021/08/20 14:25:04 INFO: 93ccda9956d988f4 became follower at term 1
raft2021/08/20 14:25:04 INFO: 93ccda9956d988f4 switched to configuration voters=(10650127570946328820)
2021-08-20 14:25:04.497159 W | auth: simple token is not cryptographically signed
2021-08-20 14:25:04.500562 I | etcdserver: starting server... [version: 3.4.15, cluster version: to_be_decided]
2021-08-20 14:25:04.500673 I | etcdserver: 93ccda9956d988f4 as single-node; fast-forwarding 29 ticks (election ticks 30)
raft2021/08/20 14:25:04 INFO: 93ccda9956d988f4 switched to configuration voters=(10650127570946328820)
2021-08-20 14:25:04.500904 I | etcdserver/membership: added member 93ccda9956d988f4 [http://127.0.0.1:50000] to cluster 6a4ade671189dc2f
2021-08-20 14:25:04.501283 I | embed: listening for peers on 127.0.0.1:50000
raft2021/08/20 14:25:06 INFO: 93ccda9956d988f4 is starting a new election at term 1
raft2021/08/20 14:25:06 INFO: 93ccda9956d988f4 became candidate at term 2
raft2021/08/20 14:25:06 INFO: 93ccda9956d988f4 received MsgVoteResp from 93ccda9956d988f4 at term 2
raft2021/08/20 14:25:06 INFO: 93ccda9956d988f4 became leader at term 2
raft2021/08/20 14:25:06 INFO: raft.node: 93ccda9956d988f4 elected leader 93ccda9956d988f4 at term 2
2021-08-20 14:25:06.496592 I | etcdserver: published {Name:node-0 ClientURLs:[http://127.0.0.1:40000]} to cluster 6a4ade671189dc2f
2021-08-20 14:25:06.496615 I | embed: ready to serve client requests
2021-08-20 14:25:06.496641 I | etcdserver: setting up the initial cluster version to 3.4
2021/08/20 14:25:06.496659 [info] prophet: create etcd v3 client with endpoints [http://127.0.0.1:40000]
2021-08-20 14:25:06.496922 N | embed: serving insecure client requests on 127.0.0.1:40000, this is strongly discouraged!
2021-08-20 14:25:06.497160 N | etcdserver/membership: set the initial cluster version to 3.4
2021-08-20 14:25:06.497211 I | etcdserver/api: enabled capabilities for version 3.4
2021/08/20 14:25:06.498565 [info] prophet: net application started
2021/08/20 14:25:06.498574 [info] prophet: start system time monitor 
2021/08/20 14:25:06.498945 [info] prophet: [prophet-leader/node-0]/loop: current leader is []
2021/08/20 14:25:06.499151 [info] prophet: [prophet-leader/node-0]/campaign: load expect leader: []
2021/08/20 14:25:06.499160 [info] prophet: [prophet-leader/node-0]/campaign: start
2021/08/20 14:25:06.499507 [info] prophet: [prophet-leader/node-0]/campaign: grant lease ok
2021/08/20 14:25:06.499891 [info] prophet: [prophet-leader/node-0]/campaign: completed, start keepalive
2021/08/20 14:25:06.499902 [info] prophet: ********node-0 become to leader now********
2021/08/20 14:25:06.501106 [info] prophet: load 0 containers, cost 925.1µs
2021/08/20 14:25:06.501372 [info] prophet: load 0 resources, cost 253.4µs
2021/08/20 14:25:06.501995 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:06.502024 [info] prophet: coordinator starts to collect cluster information 
2021/08/20 14:25:06.502027 [info] prophet: coordinator has finished cluster information preparation 
2021/08/20 14:25:06.502028 [info] prophet: coordinator starts to run schedulers 
2021/08/20 14:25:06.502045 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:06.502053 [info] prophet: client read loop started 
2021/08/20 14:25:06.502061 [info] prophet: client started
2021/08/20 14:25:06.502064 [info] prophet: client read loop actived, ready to read from leader
2021/08/20 14:25:06.502059 [info] prophet: session 1[127.0.0.1:38468] connected
2021/08/20 14:25:06.502068 [info] [raftstore]: *********Become prophet leader*********
2021/08/20 14:25:06.502070 [info] [raftstore]: begin to bootstrap the cluster
2021/08/20 14:25:06.502113 [info] [raftstore]: raftstore init with store raftAddr:"127.0.0.1:10000" clientAddr:"127.0.0.1:20000" labels:<key:"c" value:"0" > startTime:1629440706 deployPath:"not set" 
2021/08/20 14:25:06.502127 [info] [raftstore]: begin to create local store metadata
2021/08/20 14:25:06.502577 [info] prophet: load 0 jobs
2021/08/20 14:25:06.502834 [info] [raftstore]: create local store with id 1
2021/08/20 14:25:06.503223 [info] [raftstore]: the cluster already bootstrap: false
2021/08/20 14:25:06.503237 [info] [raftstore]: begin to bootstrap the cluster with init shards
2021/08/20 14:25:06.503425 [info] prophet: coordinator begins to actively drive push operator 
2021/08/20 14:25:06.503441 [info] prophet: coordinator starts patrol resources 
2021/08/20 14:25:06.503461 [info] [raftstore]: create init shard id:2 epoch:<confVer:1 version:1 > peers:<id:3 containerID:1 > 
2021/08/20 14:25:06.505954 [info] prophet: container 1 limit added
2021/08/20 14:25:06.506023 [info] [raftstore]: prophet started
2021/08/20 14:25:06.506074 [info] [transport]: net application started
2021/08/20 14:25:06.506086 [info] [raftstore]: start listen at 127.0.0.1:10000 for raft
2021/08/20 14:25:06.506088 [info] prophet: container 1 heartbeat stream binded
2021/08/20 14:25:06.506095 [info] [raftstore]: raft worker 0/0 start
2021/08/20 14:25:06.506089 [info] [raftstore]: raft shards workers started
2021/08/20 14:25:06.506150 [info] [raftstore]: shard 2 init with raft local state {HardState:{Term:5 Vote:0 Commit:5 XXX_unrecognized:[]} LastIndex:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:06.506176 [info] [raftstore]: shard 2 init raft apply state, state=<{AppliedIndex:5 TruncatedState:{Index:5 Term:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:06.506186 [info] [raftstore]: shard 2 init last term, last term=<5>
{"level":"info","ts":"2021-08-20T14:25:06.506+0800","caller":"raft/raft.go:1550","msg":"3 switched to configuration voters=(3)"}
{"level":"info","ts":"2021-08-20T14:25:06.506+0800","caller":"raft/raft.go:711","msg":"3 became follower at term 5"}
{"level":"info","ts":"2021-08-20T14:25:06.506+0800","caller":"raft/raft.go:388","msg":"newRaft 3 [peers: [3], term: 5, commit: 5, applied: 5, lastindex: 5, lastterm: 5]"}
2021/08/20 14:25:06.506244 [info] [raftstore]: shard 2 try to campaign leader, because only self
{"level":"info","ts":"2021-08-20T14:25:06.506+0800","caller":"raft/raft.go:934","msg":"3 is starting a new election at term 5"}
{"level":"info","ts":"2021-08-20T14:25:06.506+0800","caller":"raft/raft.go:724","msg":"3 became candidate at term 6"}
{"level":"info","ts":"2021-08-20T14:25:06.506+0800","caller":"raft/raft.go:835","msg":"3 received MsgVoteResp from 3 at term 6"}
{"level":"info","ts":"2021-08-20T14:25:06.506+0800","caller":"raft/raft.go:776","msg":"3 became leader at term 6"}
2021/08/20 14:25:06.506282 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 add registration job by startShards
2021/08/20 14:25:06.506294 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 add registration job by startShards, completed
2021/08/20 14:25:06.506315 [info] [raftstore]: shard 2 peer 3 raft 3 added, epoch {ConfVer:1 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:06.506326 [info] [raftstore]: starts with 1 shards, including 0 tombstones and 0 applying shards
2021/08/20 14:25:06.506327 [info] [raftstore]: cleanup possible garbage data complete
2021/08/20 14:25:06.506328 [info] [raftstore]: shards started
2021/08/20 14:25:06.506330 [info] [raftstore]: shard timer based tasks started
2021/08/20 14:25:06.506337 [info] [raftstore]: net application started
2021/08/20 14:25:06.506344 [info] [raftstore]: start listen at 127.0.0.1:20000 for client
2021/08/20 14:25:06.506351 [info] [raftstore]: router started
2021/08/20 14:25:06.506388 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:06.506389 [info] [raftstore]: router event loop task started
2021/08/20 14:25:06.506471 [info] prophet: session 2[127.0.0.1:38470] connected
2021/08/20 14:25:06.506475 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:06.506476 [info] prophet: watcher init leader connection 127.0.0.1:30000 succeed
2021/08/20 14:25:06.506499 [info] prophet: new watcher 127.0.0.1:38470 added
2021/08/20 14:25:06.506548 [info] [raftstore]: start init event
2021/08/20 14:25:06.516860 [info] [raftstore]: shard 2 ********become leader now********
2021/08/20 14:25:06.518619 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 6
2021/08/20 14:25:06.626911 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 7
2021/08/20 14:25:06.716913 [info] [raftstore]: shard 2 start split check job from [122 0 0 0 0 0 0 0 0] to [122 0 0 0 0 0 0 0 1]
2021/08/20 14:25:06.716985 [info] [raftstore]: shard 2 try to split, size 40 bytes splitKeys [[122 0 0 0 0 0 0 0 0 107 101 121 50]]
2021/08/20 14:25:06.717088 [info] prophet: alloc ids [6] for resource 5 split
2021/08/20 14:25:06.736857 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 8
2021/08/20 14:25:06.736902 [info] [raftstore]: shard 2 update to {ID:2 Start:[] End:[107 101 121 50] Epoch:{ConfVer:1 Version:2 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} by post applt split
2021/08/20 14:25:06.736925 [info] [raftstore]: shard 5 init with raft local state {HardState:{Term:5 Vote:0 Commit:5 XXX_unrecognized:[]} LastIndex:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:06.736942 [info] [raftstore]: shard 5 init raft apply state, state=<{AppliedIndex:5 TruncatedState:{Index:5 Term:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:06.736943 [info] [raftstore]: shard 5 init last term, last term=<5>
{"level":"info","ts":"2021-08-20T14:25:06.736+0800","caller":"raft/raft.go:1550","msg":"6 switched to configuration voters=(6)"}
{"level":"info","ts":"2021-08-20T14:25:06.737+0800","caller":"raft/raft.go:711","msg":"6 became follower at term 5"}
{"level":"info","ts":"2021-08-20T14:25:06.737+0800","caller":"raft/raft.go:388","msg":"newRaft 6 [peers: [6], term: 5, commit: 5, applied: 5, lastindex: 5, lastterm: 5]"}
2021/08/20 14:25:06.737018 [info] [raftstore]: shard 5 try to campaign leader, because only self
{"level":"info","ts":"2021-08-20T14:25:06.737+0800","caller":"raft/raft.go:934","msg":"6 is starting a new election at term 5"}
{"level":"info","ts":"2021-08-20T14:25:06.737+0800","caller":"raft/raft.go:724","msg":"6 became candidate at term 6"}
{"level":"info","ts":"2021-08-20T14:25:06.737+0800","caller":"raft/raft.go:835","msg":"6 received MsgVoteResp from 6 at term 6"}
{"level":"info","ts":"2021-08-20T14:25:06.737+0800","caller":"raft/raft.go:776","msg":"6 became leader at term 6"}
2021/08/20 14:25:06.737049 [error] [raftstore]: >>>>>>>>>>>> shard 5 peer 6 add registration job by doApplySplit
2021/08/20 14:25:06.737067 [error] [raftstore]: >>>>>>>>>>>> shard 5 peer 6 add registration job by doApplySplit, completed
2021/08/20 14:25:06.737101 [info] [raftstore]: shard 5 peer 6 raft 6 added, epoch {ConfVer:1 Version:2 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:6 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:06.737125 [info] [raftstore]: shard 2 new shard added, new shards [{ID:5 Start:[107 101 121 50] End:[] Epoch:{ConfVer:1 Version:2 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:6 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:06.737151 [info] [raftstore]: shard 5 ********become leader now********
2021/08/20 14:25:06.737223 [info] prophet: resource 2 version changed from 1 to 2
2021/08/20 14:25:06.738591 [error] [raftstore]: >>>>>>>>>>>> shard 5 peer 6 AdvanceApply with 6
2021/08/20 14:25:06.806614 [info] [raftstore]: shard 5 start split check job from [122 0 0 0 0 0 0 0 0 107 101 121 50] to [122 0 0 0 0 0 0 0 1]
2021/08/20 14:25:06.836643 [error] [raftstore]: >>>>>>>>>>>> shard 5 peer 6 AdvanceApply with 7
2021/08/20 14:25:06.916304 [info] [raftstore]: shard 5 start split check job from [122 0 0 0 0 0 0 0 0 107 101 121 50] to [122 0 0 0 0 0 0 0 1]
2021/08/20 14:25:06.916328 [info] [raftstore]: shard 5 try to split, size 40 bytes splitKeys [[122 0 0 0 0 0 0 0 0 107 101 121 51]]
2021/08/20 14:25:06.916695 [info] prophet: alloc ids [8] for resource 7 split
2021/08/20 14:25:06.926270 [error] [raftstore]: >>>>>>>>>>>> shard 5 peer 6 AdvanceApply with 8
2021/08/20 14:25:06.926292 [info] [raftstore]: shard 5 update to {ID:5 Start:[107 101 121 50] End:[107 101 121 51] Epoch:{ConfVer:1 Version:3 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:6 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} by post applt split
2021/08/20 14:25:06.926304 [info] [raftstore]: shard 7 init with raft local state {HardState:{Term:5 Vote:0 Commit:5 XXX_unrecognized:[]} LastIndex:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:06.926308 [info] [raftstore]: shard 7 init raft apply state, state=<{AppliedIndex:5 TruncatedState:{Index:5 Term:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:06.926309 [info] [raftstore]: shard 7 init last term, last term=<5>
{"level":"info","ts":"2021-08-20T14:25:06.926+0800","caller":"raft/raft.go:1550","msg":"8 switched to configuration voters=(8)"}
{"level":"info","ts":"2021-08-20T14:25:06.926+0800","caller":"raft/raft.go:711","msg":"8 became follower at term 5"}
{"level":"info","ts":"2021-08-20T14:25:06.926+0800","caller":"raft/raft.go:388","msg":"newRaft 8 [peers: [8], term: 5, commit: 5, applied: 5, lastindex: 5, lastterm: 5]"}
2021/08/20 14:25:06.926366 [info] [raftstore]: shard 7 try to campaign leader, because only self
{"level":"info","ts":"2021-08-20T14:25:06.926+0800","caller":"raft/raft.go:934","msg":"8 is starting a new election at term 5"}
{"level":"info","ts":"2021-08-20T14:25:06.926+0800","caller":"raft/raft.go:724","msg":"8 became candidate at term 6"}
{"level":"info","ts":"2021-08-20T14:25:06.926+0800","caller":"raft/raft.go:835","msg":"8 received MsgVoteResp from 8 at term 6"}
{"level":"info","ts":"2021-08-20T14:25:06.926+0800","caller":"raft/raft.go:776","msg":"8 became leader at term 6"}
2021/08/20 14:25:06.926397 [error] [raftstore]: >>>>>>>>>>>> shard 7 peer 8 add registration job by doApplySplit
2021/08/20 14:25:06.926415 [error] [raftstore]: >>>>>>>>>>>> shard 7 peer 8 add registration job by doApplySplit, completed
2021/08/20 14:25:06.926421 [info] [raftstore]: shard 7 peer 8 raft 8 added, epoch {ConfVer:1 Version:3 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:8 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:06.926435 [info] [raftstore]: shard 5 new shard added, new shards [{ID:7 Start:[107 101 121 51] End:[] Epoch:{ConfVer:1 Version:3 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:8 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:06.926444 [info] [raftstore]: shard 7 ********become leader now********
2021/08/20 14:25:06.926545 [info] prophet: resource 5 version changed from 2 to 3
2021/08/20 14:25:06.927822 [error] [raftstore]: >>>>>>>>>>>> shard 7 peer 8 AdvanceApply with 6
2021/08/20 14:25:06.946792 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 9
2021/08/20 14:25:06.949075 [error] prophet: client read resp from leader 127.0.0.1:30000 failed with read tcp 127.0.0.1:38468->127.0.0.1:30000: use of closed network connection
2021/08/20 14:25:06.949085 [error] prophet: client read loop stopped
2021/08/20 14:25:06.949102 [error] prophet: watcher read events failed with EOF
2021/08/20 14:25:06.949105 [error] prophet: reset watcher conn failed with <nil>, retry later
2021/08/20 14:25:06.949105 [error] prophet: session 2[127.0.0.1:38470] read failed with read tcp 127.0.0.1:30000->127.0.0.1:38470: use of closed network connection
2021/08/20 14:25:06.949292 [info] prophet: [prophet-leader/node-0]/lease: closed
2021/08/20 14:25:06.949331 [info] prophet: patrol resources has been stopped 
2021/08/20 14:25:06.949346 [info] prophet: drive push operator has been stopped 
2021/08/20 14:25:06.949348 [info] prophet: [prophet-leader/node-0]/keepalive: exit with context done
2021/08/20 14:25:06.949349 [info] prophet: coordinator is stopping
2021/08/20 14:25:06.949353 [info] prophet: coordinator has been stopped
2021/08/20 14:25:06.949356 [info] prophet: [prophet-leader/node-0]/lease: exit with context done
2021/08/20 14:25:06.949365 [error] prophet: [prophet-leader/node-0]/lease: keep lease exit
2021-08-20 14:25:06.949364 I | etcdserver: skipped leadership transfer for single voting member cluster
2021/08/20 14:25:06.956527 [info] [raftstore]: shard 2 handle serve raft stopped
2021/08/20 14:25:06.956542 [info] [raftstore]: shard 5 handle serve raft stopped
2021/08/20 14:25:06.956543 [info] [raftstore]: shard 7 handle serve raft stopped
2021/08/20 14:25:06.956562 [info] [raftstore]: timer based tasks stopped
2021/08/20 14:25:06.956562 [info] [raftstore]: handle resource heartbeat resp task stopped
2021/08/20 14:25:06.956568 [info] [raftstore]: raft worker worker 0/0 exit
2021/08/20 14:25:06.956564 [info] [raftstore]: router event loop task stopped
2021/08/20 14:25:06.956620 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:06.956628 [info] [transport]: transfer stopped
2021/08/20 14:25:06.956632 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:06.956632 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:06.956640 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:06.956641 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:06.956644 [info] [transport]: send raft worker stopped
2021/08/20 14:25:06.956644 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:06.956647 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:06.956649 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:06.958951 [info] prophet: prophet logger set
2021/08/20 14:25:06.973147 [info] [raftstore]: begin start raftstore
2021/08/20 14:25:06.973159 [info] [raftstore]: begin to start prophet
[WARNING] Deprecated '--logger=capnslog' flag is set; use '--logger=zap' flag instead
2021/08/20 14:25:06.973198 [info] [raftstore]: start scan gc snap files
2021-08-20 14:25:06.973200 I | embed: pprof is enabled under /debug/pprof
2021-08-20 14:25:06.973270 I | embed: name = node-0
2021-08-20 14:25:06.973282 I | embed: data dir = /tmp/cube/node-0/prophet
2021-08-20 14:25:06.973285 I | embed: member dir = /tmp/cube/node-0/prophet/member
2021-08-20 14:25:06.973287 I | embed: heartbeat = 100ms
2021-08-20 14:25:06.973289 I | embed: election = 3000ms
2021-08-20 14:25:06.973291 I | embed: snapshot count = 100000
2021-08-20 14:25:06.973295 I | embed: advertise client URLs = http://127.0.0.1:40000
2021-08-20 14:25:06.973297 I | embed: initial advertise peer URLs = http://127.0.0.1:50000
2021-08-20 14:25:06.973301 I | embed: initial cluster = 
2021/08/20 14:25:06.973407 [info] [raftstore]: shard 2 raft tick stopped
2021-08-20 14:25:06.973649 I | etcdserver: restarting member 93ccda9956d988f4 in cluster 6a4ade671189dc2f at commit index 20
{"level":"info","ts":"2021-08-20T14:25:06.973+0800","caller":"raft/raft.go:1550","msg":"93ccda9956d988f4 switched to configuration voters=()"}
{"level":"info","ts":"2021-08-20T14:25:06.973+0800","caller":"raft/raft.go:711","msg":"93ccda9956d988f4 became follower at term 2"}
{"level":"info","ts":"2021-08-20T14:25:06.973+0800","caller":"raft/raft.go:388","msg":"newRaft 93ccda9956d988f4 [peers: [], term: 2, commit: 20, applied: 0, lastindex: 20, lastterm: 2]"}
2021-08-20 14:25:06.974434 W | auth: simple token is not cryptographically signed
2021-08-20 14:25:06.976915 I | etcdserver: starting server... [version: 3.4.15, cluster version: to_be_decided]
{"level":"info","ts":"2021-08-20T14:25:06.977+0800","caller":"raft/raft.go:1550","msg":"93ccda9956d988f4 switched to configuration voters=(10650127570946328820)"}
2021-08-20 14:25:06.977127 I | etcdserver/membership: added member 93ccda9956d988f4 [http://127.0.0.1:50000] to cluster 6a4ade671189dc2f
2021-08-20 14:25:06.977174 N | etcdserver/membership: set the initial cluster version to 3.4
2021-08-20 14:25:06.977214 I | embed: listening for peers on 127.0.0.1:50000
2021/08/20 14:25:07.024343 [info] [raftstore]: shard 5 raft tick stopped
2021/08/20 14:25:07.024357 [info] [raftstore]: shard 7 raft tick stopped
2021/08/20 14:25:07.049646 [info] prophet: [prophet-leader/node-0]/loop: exit
{"level":"info","ts":"2021-08-20T14:25:10.674+0800","caller":"raft/raft.go:934","msg":"93ccda9956d988f4 is starting a new election at term 2"}
{"level":"info","ts":"2021-08-20T14:25:10.674+0800","caller":"raft/raft.go:724","msg":"93ccda9956d988f4 became candidate at term 3"}
{"level":"info","ts":"2021-08-20T14:25:10.674+0800","caller":"raft/raft.go:835","msg":"93ccda9956d988f4 received MsgVoteResp from 93ccda9956d988f4 at term 3"}
{"level":"info","ts":"2021-08-20T14:25:10.674+0800","caller":"raft/raft.go:776","msg":"93ccda9956d988f4 became leader at term 3"}
{"level":"info","ts":"2021-08-20T14:25:10.674+0800","caller":"raft/node.go:325","msg":"raft.node: 93ccda9956d988f4 elected leader 93ccda9956d988f4 at term 3"}
2021-08-20 14:25:10.676008 I | etcdserver: published {Name:node-0 ClientURLs:[http://127.0.0.1:40000]} to cluster 6a4ade671189dc2f
2021/08/20 14:25:10.676023 [info] prophet: create etcd v3 client with endpoints [http://127.0.0.1:40000]
2021-08-20 14:25:10.676024 I | embed: ready to serve client requests
2021-08-20 14:25:10.676697 N | embed: serving insecure client requests on 127.0.0.1:40000, this is strongly discouraged!
2021/08/20 14:25:10.677755 [info] prophet: net application started
2021/08/20 14:25:10.677790 [info] prophet: start system time monitor 
2021/08/20 14:25:10.677981 [info] prophet: [prophet-leader/node-0]/loop: current leader is []
2021/08/20 14:25:10.678181 [info] prophet: [prophet-leader/node-0]/campaign: load expect leader: []
2021/08/20 14:25:10.678190 [info] prophet: [prophet-leader/node-0]/campaign: start
2021/08/20 14:25:10.678458 [info] prophet: [prophet-leader/node-0]/campaign: grant lease ok
2021/08/20 14:25:10.678997 [info] prophet: [prophet-leader/node-0]/campaign: completed, start keepalive
2021/08/20 14:25:10.679014 [info] prophet: ********node-0 become to leader now********
2021/08/20 14:25:10.679803 [info] prophet: load 1 containers, cost 693.8µs
2021/08/20 14:25:10.680042 [info] prophet: load 3 resources, cost 225.5µs
2021/08/20 14:25:10.680419 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:10.680428 [info] prophet: client started
2021/08/20 14:25:10.680440 [info] [raftstore]: *********Become prophet leader*********
2021/08/20 14:25:10.680442 [info] [raftstore]: begin to bootstrap the cluster
2021/08/20 14:25:10.680469 [info] [raftstore]: raftstore init with store raftAddr:"127.0.0.1:10000" clientAddr:"127.0.0.1:20000" labels:<key:"c" value:"0" > startTime:1629440710 deployPath:"not set" 
2021/08/20 14:25:10.680475 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:10.680419 [info] prophet: coordinator starts to collect cluster information 
2021/08/20 14:25:10.680423 [info] prophet: client read loop started 
2021/08/20 14:25:10.680507 [info] prophet: client read loop actived, ready to read from leader
2021/08/20 14:25:10.680483 [info] prophet: session 1[127.0.0.1:38476] connected
2021/08/20 14:25:10.680585 [info] [raftstore]: load local store 1
2021/08/20 14:25:10.680619 [info] [raftstore]: prophet started
2021/08/20 14:25:10.680680 [info] [transport]: net application started
2021/08/20 14:25:10.680694 [info] [raftstore]: start listen at 127.0.0.1:10000 for raft
2021/08/20 14:25:10.680697 [info] [raftstore]: raft shards workers started
2021/08/20 14:25:10.680731 [info] [raftstore]: shard 2 init with raft local state {HardState:{Term:6 Vote:3 Commit:9 XXX_unrecognized:[]} LastIndex:9 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:10.680754 [info] [raftstore]: shard 2 init raft apply state, state=<{AppliedIndex:9 TruncatedState:{Index:5 Term:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:10.680758 [info] [raftstore]: shard 2 init last term, last term=<6>
2021/08/20 14:25:10.680770 [info] [raftstore]: raft worker 0/0 start
{"level":"info","ts":"2021-08-20T14:25:10.680+0800","caller":"raft/raft.go:1550","msg":"3 switched to configuration voters=(3)"}
{"level":"info","ts":"2021-08-20T14:25:10.680+0800","caller":"raft/raft.go:711","msg":"3 became follower at term 6"}
{"level":"info","ts":"2021-08-20T14:25:10.680+0800","caller":"raft/raft.go:388","msg":"newRaft 3 [peers: [3], term: 6, commit: 9, applied: 9, lastindex: 9, lastterm: 6]"}
2021/08/20 14:25:10.680828 [info] [raftstore]: shard 2 try to campaign leader, because only self
2021/08/20 14:25:10.680735 [info] prophet: load 0 jobs
{"level":"info","ts":"2021-08-20T14:25:10.680+0800","caller":"raft/raft.go:934","msg":"3 is starting a new election at term 6"}
{"level":"info","ts":"2021-08-20T14:25:10.680+0800","caller":"raft/raft.go:724","msg":"3 became candidate at term 7"}
{"level":"info","ts":"2021-08-20T14:25:10.680+0800","caller":"raft/raft.go:835","msg":"3 received MsgVoteResp from 3 at term 7"}
{"level":"info","ts":"2021-08-20T14:25:10.680+0800","caller":"raft/raft.go:776","msg":"3 became leader at term 7"}
2021/08/20 14:25:10.680879 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 add registration job by startShards
2021/08/20 14:25:10.680916 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 add registration job by startShards, completed
2021/08/20 14:25:10.680955 [info] [raftstore]: shard 2 peer 3 raft 3 added, epoch {ConfVer:1 Version:2 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:10.680978 [info] [raftstore]: shard 5 init with raft local state {HardState:{Term:6 Vote:6 Commit:9 XXX_unrecognized:[]} LastIndex:9 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:10.680994 [info] [raftstore]: shard 5 init raft apply state, state=<{AppliedIndex:8 TruncatedState:{Index:5 Term:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:10.680998 [info] [raftstore]: shard 5 init last term, last term=<6>
{"level":"info","ts":"2021-08-20T14:25:10.681+0800","caller":"raft/raft.go:1550","msg":"6 switched to configuration voters=(6)"}
{"level":"info","ts":"2021-08-20T14:25:10.681+0800","caller":"raft/raft.go:711","msg":"6 became follower at term 6"}
{"level":"info","ts":"2021-08-20T14:25:10.681+0800","caller":"raft/raft.go:388","msg":"newRaft 6 [peers: [6], term: 6, commit: 9, applied: 8, lastindex: 9, lastterm: 6]"}
2021/08/20 14:25:10.681038 [info] [raftstore]: shard 5 try to campaign leader, because only self
{"level":"info","ts":"2021-08-20T14:25:10.681+0800","caller":"raft/raft.go:934","msg":"6 is starting a new election at term 6"}
{"level":"info","ts":"2021-08-20T14:25:10.681+0800","caller":"raft/raft.go:724","msg":"6 became candidate at term 7"}
{"level":"info","ts":"2021-08-20T14:25:10.681+0800","caller":"raft/raft.go:835","msg":"6 received MsgVoteResp from 6 at term 7"}
{"level":"info","ts":"2021-08-20T14:25:10.681+0800","caller":"raft/raft.go:776","msg":"6 became leader at term 7"}
2021/08/20 14:25:10.681123 [error] [raftstore]: >>>>>>>>>>>> shard 5 peer 6 add registration job by startShards
2021/08/20 14:25:10.681135 [error] [raftstore]: >>>>>>>>>>>> shard 5 peer 6 add registration job by startShards, completed
2021/08/20 14:25:10.681147 [info] [raftstore]: shard 5 peer 6 raft 6 added, epoch {ConfVer:1 Version:3 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:6 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:10.681172 [info] [raftstore]: shard 7 init with raft local state {HardState:{Term:6 Vote:8 Commit:6 XXX_unrecognized:[]} LastIndex:6 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:10.681185 [info] [raftstore]: shard 7 init raft apply state, state=<{AppliedIndex:6 TruncatedState:{Index:5 Term:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:10.681188 [info] [raftstore]: shard 7 init last term, last term=<6>
{"level":"info","ts":"2021-08-20T14:25:10.681+0800","caller":"raft/raft.go:1550","msg":"8 switched to configuration voters=(8)"}
{"level":"info","ts":"2021-08-20T14:25:10.681+0800","caller":"raft/raft.go:711","msg":"8 became follower at term 6"}
2021/08/20 14:25:10.681226 [info] [raftstore]: shard 2 ********become leader now********
{"level":"info","ts":"2021-08-20T14:25:10.681+0800","caller":"raft/raft.go:388","msg":"newRaft 8 [peers: [8], term: 6, commit: 6, applied: 6, lastindex: 6, lastterm: 6]"}
2021/08/20 14:25:10.681317 [info] [raftstore]: shard 7 try to campaign leader, because only self
{"level":"info","ts":"2021-08-20T14:25:10.681+0800","caller":"raft/raft.go:934","msg":"8 is starting a new election at term 6"}
{"level":"info","ts":"2021-08-20T14:25:10.681+0800","caller":"raft/raft.go:724","msg":"8 became candidate at term 7"}
{"level":"info","ts":"2021-08-20T14:25:10.681+0800","caller":"raft/raft.go:835","msg":"8 received MsgVoteResp from 8 at term 7"}
{"level":"info","ts":"2021-08-20T14:25:10.681+0800","caller":"raft/raft.go:776","msg":"8 became leader at term 7"}
2021/08/20 14:25:10.681358 [error] [raftstore]: >>>>>>>>>>>> shard 7 peer 8 add registration job by startShards
2021/08/20 14:25:10.681376 [error] [raftstore]: >>>>>>>>>>>> shard 7 peer 8 add registration job by startShards, completed
2021/08/20 14:25:10.681384 [info] [raftstore]: shard 7 peer 8 raft 8 added, epoch {ConfVer:1 Version:3 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:8 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:10.681395 [info] [raftstore]: starts with 3 shards, including 0 tombstones and 0 applying shards
2021/08/20 14:25:10.681396 [info] [raftstore]: cleanup possible garbage data complete
2021/08/20 14:25:10.681397 [info] [raftstore]: shards started
2021/08/20 14:25:10.681399 [info] [raftstore]: shard timer based tasks started
2021/08/20 14:25:10.681405 [info] [raftstore]: net application started
2021/08/20 14:25:10.681412 [info] [raftstore]: start listen at 127.0.0.1:20000 for client
2021/08/20 14:25:10.681418 [info] [raftstore]: router started
2021/08/20 14:25:10.681463 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:10.681512 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:10.681521 [info] prophet: watcher init leader connection 127.0.0.1:30000 succeed
2021/08/20 14:25:10.681522 [info] [raftstore]: router event loop task started
2021/08/20 14:25:10.681557 [info] prophet: session 2[127.0.0.1:38478] connected
2021/08/20 14:25:10.681590 [info] prophet: new watcher 127.0.0.1:38478 added
2021/08/20 14:25:10.681649 [info] [raftstore]: start init event
2021/08/20 14:25:10.682682 [info] [raftstore]: shard 5 ********become leader now********
2021/08/20 14:25:10.683831 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 10
2021/08/20 14:25:10.683845 [info] [raftstore]: shard 7 ********become leader now********
2021/08/20 14:25:10.691147 [error] [raftstore]: >>>>>>>>>>>> shard 5 peer 6 AdvanceApply with 9
2021/08/20 14:25:10.691161 [error] [raftstore]: >>>>>>>>>>>> shard 5 peer 6 AdvanceApply with 10
2021/08/20 14:25:10.691165 [error] [raftstore]: >>>>>>>>>>>> shard 7 peer 8 AdvanceApply with 7
2021/08/20 14:25:10.791553 [info] [raftstore]: shard 5 start split check job from [122 0 0 0 0 0 0 0 0 107 101 121 50] to [122 0 0 0 0 0 0 0 0 107 101 121 51]
2021/08/20 14:25:10.791665 [error] [raftstore]: shard 5 heartbeat to prophet failed with client is closed
2021/08/20 14:25:10.791684 [error] prophet: client read resp from leader 127.0.0.1:30000 failed with read tcp 127.0.0.1:38476->127.0.0.1:30000: use of closed network connection
2021/08/20 14:25:10.791688 [error] prophet: client read loop stopped
2021/08/20 14:25:10.791686 [error] [raftstore]: shard 7 heartbeat to prophet failed with client is closed
2021/08/20 14:25:10.791708 [error] prophet: flush messages failed with illegal state, closed this session
2021/08/20 14:25:10.791729 [error] prophet: session 1[] read failed with illegal state
2021/08/20 14:25:10.791723 [error] prophet: session 2[127.0.0.1:38478] read failed with read tcp 127.0.0.1:30000->127.0.0.1:38478: use of closed network connection
2021/08/20 14:25:10.791722 [error] prophet: watcher read events failed with EOF
2021/08/20 14:25:10.791735 [error] prophet: reset watcher conn failed with <nil>, retry later
2021/08/20 14:25:10.792156 [info] prophet: [prophet-leader/node-0]/lease: closed
2021/08/20 14:25:10.792213 [info] prophet: [prophet-leader/node-0]/keepalive: exit with context done
2021-08-20 14:25:10.792232 I | etcdserver: skipped leadership transfer for single voting member cluster
2021/08/20 14:25:10.792246 [info] prophet: [prophet-leader/node-0]/lease: exit with context done
2021/08/20 14:25:10.792248 [error] prophet: [prophet-leader/node-0]/lease: keep lease exit
2021/08/20 14:25:10.792252 [info] prophet: coordinator stops running 
2021/08/20 14:25:10.792256 [info] prophet: coordinator is stopping
2021/08/20 14:25:10.792258 [info] prophet: coordinator has been stopped
2021/08/20 14:25:10.801527 [info] [raftstore]: shard 2 handle serve raft stopped
2021/08/20 14:25:10.801540 [info] [raftstore]: shard 5 handle serve raft stopped
2021/08/20 14:25:10.801542 [info] [raftstore]: shard 7 handle serve raft stopped
2021/08/20 14:25:10.801561 [info] [raftstore]: raft worker worker 0/0 exit
2021/08/20 14:25:10.801567 [info] [raftstore]: timer based tasks stopped
2021/08/20 14:25:10.801571 [info] [raftstore]: router event loop task stopped
2021/08/20 14:25:10.801603 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:10.801608 [info] [transport]: transfer stopped
2021/08/20 14:25:10.801617 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:10.801624 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:10.801626 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:10.801628 [info] [transport]: send raft worker stopped
2021/08/20 14:25:10.801624 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:10.801634 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:10.801634 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:10.801640 [info] [transport]: send snapshot worker stopped
--- PASS: TestIssue97 (6.33s)
=== RUN   TestSyncData
2021/08/20 14:25:10.804199 [info] prophet: prophet logger set
2021/08/20 14:25:10.804661 [info] [raftstore]: start scan gc snap files
2021/08/20 14:25:10.804891 [info] [raftstore]: start scan gc snap files
2021/08/20 14:25:10.805143 [info] [raftstore]: begin start raftstore
2021/08/20 14:25:10.805154 [info] [raftstore]: begin to start prophet
[WARNING] Deprecated '--logger=capnslog' flag is set; use '--logger=zap' flag instead
2021/08/20 14:25:10.805190 [info] [raftstore]: start scan gc snap files
2021-08-20 14:25:10.805203 I | embed: pprof is enabled under /debug/pprof
2021-08-20 14:25:10.805235 I | embed: name = node-0
2021-08-20 14:25:10.805247 I | embed: data dir = /tmp/cube/node-0/prophet
2021-08-20 14:25:10.805249 I | embed: member dir = /tmp/cube/node-0/prophet/member
2021-08-20 14:25:10.805250 I | embed: heartbeat = 100ms
2021-08-20 14:25:10.805252 I | embed: election = 3000ms
2021-08-20 14:25:10.805253 I | embed: snapshot count = 100000
2021-08-20 14:25:10.805256 I | embed: advertise client URLs = http://127.0.0.1:40000
2021-08-20 14:25:10.809893 I | etcdserver: starting member 93ccda9956d988f4 in cluster 6a4ade671189dc2f
{"level":"info","ts":"2021-08-20T14:25:10.809+0800","caller":"raft/raft.go:1550","msg":"93ccda9956d988f4 switched to configuration voters=()"}
{"level":"info","ts":"2021-08-20T14:25:10.809+0800","caller":"raft/raft.go:711","msg":"93ccda9956d988f4 became follower at term 0"}
{"level":"info","ts":"2021-08-20T14:25:10.809+0800","caller":"raft/raft.go:388","msg":"newRaft 93ccda9956d988f4 [peers: [], term: 0, commit: 0, applied: 0, lastindex: 0, lastterm: 0]"}
{"level":"info","ts":"2021-08-20T14:25:10.809+0800","caller":"raft/raft.go:711","msg":"93ccda9956d988f4 became follower at term 1"}
{"level":"info","ts":"2021-08-20T14:25:10.809+0800","caller":"raft/raft.go:1550","msg":"93ccda9956d988f4 switched to configuration voters=(10650127570946328820)"}
2021-08-20 14:25:10.811649 W | auth: simple token is not cryptographically signed
2021-08-20 14:25:10.814529 I | etcdserver: starting server... [version: 3.4.15, cluster version: to_be_decided]
2021-08-20 14:25:10.814656 I | etcdserver: 93ccda9956d988f4 as single-node; fast-forwarding 29 ticks (election ticks 30)
2021-08-20 14:25:10.814758 I | embed: listening for peers on 127.0.0.1:50000
{"level":"info","ts":"2021-08-20T14:25:10.814+0800","caller":"raft/raft.go:1550","msg":"93ccda9956d988f4 switched to configuration voters=(10650127570946328820)"}
2021-08-20 14:25:10.814876 I | etcdserver/membership: added member 93ccda9956d988f4 [http://127.0.0.1:50000] to cluster 6a4ade671189dc2f
2021/08/20 14:25:10.873551 [info] [raftstore]: shard 2 raft tick stopped
2021/08/20 14:25:10.873580 [info] [raftstore]: shard 5 raft tick stopped
2021/08/20 14:25:10.873582 [info] [raftstore]: shard 7 raft tick stopped
2021/08/20 14:25:10.892880 [info] prophet: [prophet-leader/node-0]/loop: exit
{"level":"info","ts":"2021-08-20T14:25:11.310+0800","caller":"raft/raft.go:934","msg":"93ccda9956d988f4 is starting a new election at term 1"}
{"level":"info","ts":"2021-08-20T14:25:11.310+0800","caller":"raft/raft.go:724","msg":"93ccda9956d988f4 became candidate at term 2"}
{"level":"info","ts":"2021-08-20T14:25:11.311+0800","caller":"raft/raft.go:835","msg":"93ccda9956d988f4 received MsgVoteResp from 93ccda9956d988f4 at term 2"}
{"level":"info","ts":"2021-08-20T14:25:11.311+0800","caller":"raft/raft.go:776","msg":"93ccda9956d988f4 became leader at term 2"}
{"level":"info","ts":"2021-08-20T14:25:11.311+0800","caller":"raft/node.go:325","msg":"raft.node: 93ccda9956d988f4 elected leader 93ccda9956d988f4 at term 2"}
2021-08-20 14:25:11.311418 I | etcdserver: published {Name:node-0 ClientURLs:[http://127.0.0.1:40000]} to cluster 6a4ade671189dc2f
2021/08/20 14:25:11.311437 [info] prophet: create etcd v3 client with endpoints [http://127.0.0.1:40000]
2021-08-20 14:25:11.311437 I | embed: ready to serve client requests
2021-08-20 14:25:11.311537 I | etcdserver: setting up the initial cluster version to 3.4
2021-08-20 14:25:11.311686 N | embed: serving insecure client requests on 127.0.0.1:40000, this is strongly discouraged!
2021-08-20 14:25:11.311775 N | etcdserver/membership: set the initial cluster version to 3.4
2021/08/20 14:25:11.313627 [info] prophet: net application started
2021/08/20 14:25:11.313641 [info] prophet: start system time monitor 
2021/08/20 14:25:11.314085 [info] prophet: [prophet-leader/node-0]/loop: current leader is []
2021/08/20 14:25:11.314291 [info] prophet: [prophet-leader/node-0]/campaign: load expect leader: []
2021/08/20 14:25:11.314301 [info] prophet: [prophet-leader/node-0]/campaign: start
2021/08/20 14:25:11.314526 [info] prophet: [prophet-leader/node-0]/campaign: grant lease ok
2021/08/20 14:25:11.315044 [info] prophet: [prophet-leader/node-0]/campaign: completed, start keepalive
2021/08/20 14:25:11.315061 [info] prophet: ********node-0 become to leader now********
2021/08/20 14:25:11.315447 [info] prophet: load 0 containers, cost 337.4µs
2021/08/20 14:25:11.315630 [info] prophet: load 0 resources, cost 173.7µs
2021/08/20 14:25:11.316482 [info] prophet: coordinator starts to collect cluster information 
2021/08/20 14:25:11.316493 [info] prophet: client read loop started 
2021/08/20 14:25:11.316499 [info] prophet: coordinator has finished cluster information preparation 
2021/08/20 14:25:11.316500 [info] prophet: coordinator starts to run schedulers 
2021/08/20 14:25:11.316484 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:11.316485 [info] prophet: client started
2021/08/20 14:25:11.316568 [info] [raftstore]: *********Become prophet leader*********
2021/08/20 14:25:11.316570 [info] [raftstore]: begin to bootstrap the cluster
2021/08/20 14:25:11.316585 [info] [raftstore]: raftstore init with store raftAddr:"127.0.0.1:10000" clientAddr:"127.0.0.1:20000" labels:<key:"c" value:"0" > startTime:1629440711 deployPath:"not set" 
2021/08/20 14:25:11.316595 [info] [raftstore]: begin to create local store metadata
2021/08/20 14:25:11.316602 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:11.316609 [info] prophet: client read loop actived, ready to read from leader
2021/08/20 14:25:11.316611 [info] prophet: session 1[127.0.0.1:38484] connected
2021/08/20 14:25:11.316815 [info] prophet: load 0 jobs
2021/08/20 14:25:11.317114 [info] prophet: coordinator begins to actively drive push operator 
2021/08/20 14:25:11.317144 [info] prophet: coordinator starts patrol resources 
2021/08/20 14:25:11.317619 [info] [raftstore]: create local store with id 1
2021/08/20 14:25:11.318038 [info] [raftstore]: the cluster already bootstrap: false
2021/08/20 14:25:11.318047 [info] [raftstore]: begin to bootstrap the cluster with init shards
2021/08/20 14:25:11.318195 [info] [raftstore]: create init shard id:2 epoch:<confVer:1 version:1 > peers:<id:3 containerID:1 > 
2021/08/20 14:25:11.319401 [info] prophet: container 1 limit added
2021/08/20 14:25:11.319475 [info] [raftstore]: prophet started
2021/08/20 14:25:11.319504 [info] [transport]: net application started
2021/08/20 14:25:11.319514 [info] [raftstore]: start listen at 127.0.0.1:10000 for raft
2021/08/20 14:25:11.319517 [info] [raftstore]: raft shards workers started
2021/08/20 14:25:11.319529 [info] prophet: container 1 heartbeat stream binded
2021/08/20 14:25:11.319534 [info] [raftstore]: shard 2 init with raft local state {HardState:{Term:5 Vote:0 Commit:5 XXX_unrecognized:[]} LastIndex:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:11.319541 [info] [raftstore]: shard 2 init raft apply state, state=<{AppliedIndex:5 TruncatedState:{Index:5 Term:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:11.319543 [info] [raftstore]: shard 2 init last term, last term=<5>
2021/08/20 14:25:11.319549 [info] [raftstore]: shard 2 change init applied index from 5 to 5
{"level":"info","ts":"2021-08-20T14:25:11.319+0800","caller":"raft/raft.go:1550","msg":"3 switched to configuration voters=(3)"}
2021/08/20 14:25:11.319591 [info] [raftstore]: raft worker 0/0 start
{"level":"info","ts":"2021-08-20T14:25:11.319+0800","caller":"raft/raft.go:711","msg":"3 became follower at term 5"}
{"level":"info","ts":"2021-08-20T14:25:11.319+0800","caller":"raft/raft.go:388","msg":"newRaft 3 [peers: [3], term: 5, commit: 5, applied: 5, lastindex: 5, lastterm: 5]"}
2021/08/20 14:25:11.319605 [info] [raftstore]: shard 2 try to campaign leader, because only self
{"level":"info","ts":"2021-08-20T14:25:11.319+0800","caller":"raft/raft.go:934","msg":"3 is starting a new election at term 5"}
{"level":"info","ts":"2021-08-20T14:25:11.319+0800","caller":"raft/raft.go:724","msg":"3 became candidate at term 6"}
{"level":"info","ts":"2021-08-20T14:25:11.319+0800","caller":"raft/raft.go:835","msg":"3 received MsgVoteResp from 3 at term 6"}
{"level":"info","ts":"2021-08-20T14:25:11.319+0800","caller":"raft/raft.go:776","msg":"3 became leader at term 6"}
2021/08/20 14:25:11.319637 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 add registration job by startShards
2021/08/20 14:25:11.319656 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 add registration job by startShards, completed
2021/08/20 14:25:11.319685 [info] [raftstore]: shard 2 peer 3 raft 3 added, epoch {ConfVer:1 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:11.319700 [info] [raftstore]: starts with 1 shards, including 0 tombstones and 0 applying shards
2021/08/20 14:25:11.319702 [info] [raftstore]: cleanup possible garbage data complete
2021/08/20 14:25:11.319703 [info] [raftstore]: shards started
2021/08/20 14:25:11.319706 [info] [raftstore]: shard timer based tasks started
2021/08/20 14:25:11.319719 [info] [raftstore]: net application started
2021/08/20 14:25:11.319730 [info] [raftstore]: start listen at 127.0.0.1:20000 for client
2021/08/20 14:25:11.319757 [info] [raftstore]: router started
2021/08/20 14:25:11.319785 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:11.319790 [info] [raftstore]: router event loop task started
2021/08/20 14:25:11.319865 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:11.319873 [info] prophet: watcher init leader connection 127.0.0.1:30000 succeed
2021/08/20 14:25:11.319884 [info] prophet: session 2[127.0.0.1:38486] connected
2021/08/20 14:25:11.319913 [info] prophet: new watcher 127.0.0.1:38486 added
2021/08/20 14:25:11.319975 [info] [raftstore]: start init event
2021/08/20 14:25:11.330044 [info] [raftstore]: shard 2 ********become leader now********
2021/08/20 14:25:11.330092 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 6
2021/08/20 14:25:11.420946 [info] [raftstore]: begin start raftstore
2021/08/20 14:25:11.420958 [info] [raftstore]: begin to start prophet
{"level":"info","ts":"2021-08-20T14:25:11.421+0800","caller":"raft/raft.go:1550","msg":"93ccda9956d988f4 switched to configuration voters=(10650127570946328820 12791365408210890720)"}
2021-08-20 14:25:11.421840 I | etcdserver/membership: added member b1840f1134a12fe0 [http://127.0.0.1:50001] to cluster 6a4ade671189dc2f
2021-08-20 14:25:11.421861 I | rafthttp: starting peer b1840f1134a12fe0...
2021-08-20 14:25:11.421881 I | rafthttp: started HTTP pipelining with peer b1840f1134a12fe0
2021-08-20 14:25:11.422280 I | rafthttp: started streaming with peer b1840f1134a12fe0 (writer)
2021-08-20 14:25:11.422902 I | rafthttp: started streaming with peer b1840f1134a12fe0 (writer)
2021-08-20 14:25:11.423262 I | rafthttp: started peer b1840f1134a12fe0
2021-08-20 14:25:11.423276 I | rafthttp: started streaming with peer b1840f1134a12fe0 (stream MsgApp v2 reader)
2021-08-20 14:25:11.423280 I | rafthttp: added peer b1840f1134a12fe0
2021-08-20 14:25:11.423305 I | rafthttp: started streaming with peer b1840f1134a12fe0 (stream Message reader)
[WARNING] Deprecated '--logger=capnslog' flag is set; use '--logger=zap' flag instead
2021-08-20 14:25:11.423626 I | embed: pprof is enabled under /debug/pprof
2021-08-20 14:25:11.423656 I | embed: name = node-1
2021-08-20 14:25:11.423680 I | embed: data dir = /tmp/cube/node-1/prophet
2021-08-20 14:25:11.423683 I | embed: member dir = /tmp/cube/node-1/prophet/member
2021-08-20 14:25:11.423684 I | embed: heartbeat = 100ms
2021-08-20 14:25:11.423686 I | embed: election = 3000ms
2021-08-20 14:25:11.423687 I | embed: snapshot count = 100000
2021-08-20 14:25:11.423689 I | embed: advertise client URLs = http://127.0.0.1:40001
2021-08-20 14:25:11.427864 I | etcdserver: starting member b1840f1134a12fe0 in cluster 6a4ade671189dc2f
{"level":"info","ts":"2021-08-20T14:25:11.427+0800","caller":"raft/raft.go:1550","msg":"b1840f1134a12fe0 switched to configuration voters=()"}
{"level":"info","ts":"2021-08-20T14:25:11.427+0800","caller":"raft/raft.go:711","msg":"b1840f1134a12fe0 became follower at term 0"}
{"level":"info","ts":"2021-08-20T14:25:11.427+0800","caller":"raft/raft.go:388","msg":"newRaft b1840f1134a12fe0 [peers: [], term: 0, commit: 0, applied: 0, lastindex: 0, lastterm: 0]"}
2021-08-20 14:25:11.429589 W | auth: simple token is not cryptographically signed
2021-08-20 14:25:11.432690 I | rafthttp: started HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:11.432704 I | rafthttp: starting peer 93ccda9956d988f4...
2021-08-20 14:25:11.432710 I | rafthttp: started HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:11.432854 I | rafthttp: started streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:11.432933 I | rafthttp: started streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:11.432951 I | rafthttp: started peer 93ccda9956d988f4
2021-08-20 14:25:11.432957 I | rafthttp: added peer 93ccda9956d988f4
2021-08-20 14:25:11.432960 I | etcdserver: starting server... [version: 3.4.15, cluster version: to_be_decided]
2021-08-20 14:25:11.433043 I | rafthttp: started streaming with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:11.433085 I | rafthttp: started streaming with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:11.433219 I | embed: listening for peers on 127.0.0.1:50001
2021-08-20 14:25:11.433320 I | rafthttp: peer 93ccda9956d988f4 became active
2021-08-20 14:25:11.433342 I | rafthttp: peer b1840f1134a12fe0 became active
2021-08-20 14:25:11.433353 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:11.433398 I | rafthttp: established a TCP streaming connection with peer b1840f1134a12fe0 (stream Message writer)
2021-08-20 14:25:11.433415 I | rafthttp: established a TCP streaming connection with peer b1840f1134a12fe0 (stream MsgApp v2 writer)
2021-08-20 14:25:11.433424 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream Message reader)
{"level":"info","ts":"2021-08-20T14:25:11.510+0800","caller":"raft/raft.go:870","msg":"b1840f1134a12fe0 [term: 0] received a MsgHeartbeat message with higher term from 93ccda9956d988f4 [term: 2]"}
{"level":"info","ts":"2021-08-20T14:25:11.510+0800","caller":"raft/raft.go:711","msg":"b1840f1134a12fe0 became follower at term 2"}
{"level":"info","ts":"2021-08-20T14:25:11.510+0800","caller":"raft/node.go:325","msg":"raft.node: b1840f1134a12fe0 elected leader 93ccda9956d988f4 at term 2"}
{"level":"info","ts":"2021-08-20T14:25:11.512+0800","caller":"raft/raft.go:1550","msg":"b1840f1134a12fe0 switched to configuration voters=(10650127570946328820)"}
2021-08-20 14:25:11.512919 I | etcdserver/membership: added member 93ccda9956d988f4 [http://127.0.0.1:50000] to cluster 6a4ade671189dc2f
2021-08-20 14:25:11.512986 N | etcdserver/membership: set the initial cluster version to 3.4
{"level":"info","ts":"2021-08-20T14:25:11.514+0800","caller":"raft/raft.go:1550","msg":"b1840f1134a12fe0 switched to configuration voters=(10650127570946328820 12791365408210890720)"}
2021-08-20 14:25:11.514835 I | etcdserver/membership: added member b1840f1134a12fe0 [http://127.0.0.1:50001] to cluster 6a4ade671189dc2f
2021-08-20 14:25:11.515167 I | etcdserver: published {Name:node-1 ClientURLs:[http://127.0.0.1:40001]} to cluster 6a4ade671189dc2f
2021-08-20 14:25:11.515186 I | embed: ready to serve client requests
2021/08/20 14:25:11.515195 [info] prophet: create etcd v3 client with endpoints [http://127.0.0.1:40001]
2021-08-20 14:25:11.515483 N | embed: serving insecure client requests on 127.0.0.1:40001, this is strongly discouraged!
2021/08/20 14:25:11.516662 [info] prophet: net application started
2021/08/20 14:25:11.516702 [info] prophet: start system time monitor 
2021/08/20 14:25:11.517250 [info] prophet: [prophet-leader/node-1]/loop: current leader is [涕Ӷnode-0127.0.0.1:30000]
2021/08/20 14:25:11.517262 [info] prophet: [prophet-leader/node-1]/loop: start watch leader 涕Ӷnode-0127.0.0.1:30000
2021/08/20 14:25:11.517266 [info] prophet: ********node-1 become to follower now********
2021/08/20 14:25:11.517295 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:11.517311 [info] prophet: client read loop started 
2021/08/20 14:25:11.517317 [info] prophet: client started
2021/08/20 14:25:11.517320 [info] [raftstore]: *********Become prophet follower*********
2021/08/20 14:25:11.517322 [info] [raftstore]: begin to bootstrap the cluster
2021/08/20 14:25:11.517341 [info] [raftstore]: raftstore init with store raftAddr:"127.0.0.1:10001" clientAddr:"127.0.0.1:20001" labels:<key:"c" value:"1" > startTime:1629440711 deployPath:"not set" 
2021/08/20 14:25:11.517355 [info] [raftstore]: begin to create local store metadata
2021/08/20 14:25:11.517370 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:11.517379 [info] prophet: session 3[127.0.0.1:38516] connected
2021/08/20 14:25:11.517385 [info] prophet: client read loop actived, ready to read from leader
2021/08/20 14:25:11.517522 [info] [raftstore]: create local store with id 5
2021/08/20 14:25:11.518258 [info] [raftstore]: the cluster already bootstrap: true
2021/08/20 14:25:11.521613 [info] prophet: container 5 limit added
2021/08/20 14:25:11.521692 [info] [raftstore]: prophet started
2021/08/20 14:25:11.521726 [info] prophet: container 5 heartbeat stream binded
2021/08/20 14:25:11.521749 [info] [transport]: net application started
2021/08/20 14:25:11.521761 [info] [raftstore]: start listen at 127.0.0.1:10001 for raft
2021/08/20 14:25:11.521766 [info] [raftstore]: raft shards workers started
2021/08/20 14:25:11.521771 [info] [raftstore]: starts with 0 shards, including 0 tombstones and 0 applying shards
2021/08/20 14:25:11.521772 [info] [raftstore]: cleanup possible garbage data complete
2021/08/20 14:25:11.521773 [info] [raftstore]: shards started
2021/08/20 14:25:11.521775 [info] [raftstore]: shard timer based tasks started
2021/08/20 14:25:11.521781 [info] [raftstore]: net application started
2021/08/20 14:25:11.521782 [info] [raftstore]: start listen at 127.0.0.1:20001 for client
2021/08/20 14:25:11.521790 [info] [raftstore]: router started
2021/08/20 14:25:11.521807 [info] [raftstore]: raft worker 0/0 start
2021/08/20 14:25:11.521820 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:11.521829 [info] [raftstore]: router event loop task started
2021/08/20 14:25:11.521923 [info] prophet: session 4[127.0.0.1:38518] connected
2021/08/20 14:25:11.521923 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:11.521944 [info] prophet: watcher init leader connection 127.0.0.1:30000 succeed
2021/08/20 14:25:11.521987 [info] prophet: new watcher 127.0.0.1:38518 added
2021/08/20 14:25:11.522097 [info] [raftstore]: start init event
2021-08-20 14:25:11.523928 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream Message writer)
2021-08-20 14:25:11.523973 I | rafthttp: established a TCP streaming connection with peer b1840f1134a12fe0 (stream Message reader)
2021-08-20 14:25:11.523987 I | rafthttp: established a TCP streaming connection with peer b1840f1134a12fe0 (stream MsgApp v2 reader)
2021-08-20 14:25:11.524164 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 writer)
2021/08/20 14:25:11.531834 [info] prophet: [prophet-leader/node-1]/watch: leader updated to 涕Ӷnode-0127.0.0.1:30000
2021/08/20 14:25:11.618122 [info] prophet: resource 2 add operator add-rule-peer {add peer: container [5]} (kind:resource,replica, resource:2(1,1), createAt:2021-08-20 14:25:11.6180939 +0800 CST m=+7.151620501, startAt:0001-01-01 00:00:00 +0000 UTC, currentStep:0, steps:[add learner peer 6 on container 5, promote learner peer 6 on container 5 to voter]), 
2021/08/20 14:25:11.618147 [info] prophet: resource 2 send schedule command, step add learner peer 6 on container 5, source create
2021/08/20 14:25:11.618244 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:11.620391 [info] [raftstore]: shard-2 propose conf change peer [{ChangeType:AddLearnerNode Peer:{ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:11.620496 [info] prophet: resource 2 send schedule command, step add learner peer 6 on container 5, source heartbeat
2021/08/20 14:25:11.620512 [info] [raftstore]: shard 2 do apply change peer changeType:AddLearnerNode peer:<id:6 containerID:5 role:Learner >  at epoch {ConfVer:1 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:11.620521 [info] [raftstore]: shard-2 add learner peer {ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} successfully, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:11.620568 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:11.630139 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 7
{"level":"info","ts":"2021-08-20T14:25:11.630+0800","caller":"raft/raft.go:1550","msg":"3 switched to configuration voters=(3) learners=(6)"}
2021/08/20 14:25:11.630209 [info] [raftstore]: shard 2 notify pd with {Transition:ConfChangeTransitionAuto Changes:[{Type:ConfChangeAddLearnerNode NodeID:6 XXX_unrecognized:[]}] Context:[10 32 10 16 33 141 251 230 30 102 76 222 183 130 63 53 180 11 83 239 16 2 26 4 8 3 16 1 42 4 8 1 16 1 26 14 8 1 18 10 8 3 18 6 8 6 16 5 24 1] XXX_unrecognized:[]} with changes [{ChangeType:AddLearnerNode Peer:{ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:11.630230 [info] [raftstore]: shard 2 applied changes [{ChangeType:AddLearnerNode Peer:{ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, new peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:11.630255 [info] [raftstore]: shard-2 propose conf change peer [{ChangeType:AddLearnerNode Peer:{ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:11.630380 [info] [raftstore]: shard 2 do apply change peer changeType:AddLearnerNode peer:<id:6 containerID:5 role:Learner >  at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:11.630406 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 8
2021/08/20 14:25:11.630438 [info] prophet: resource 2 ConfVer changed from 1 to 2
2021/08/20 14:25:11.630739 [info] [transport]: connected to store 5
2021/08/20 14:25:11.630762 [info] [transport]: session 1[127.0.0.1:58404] connected
2021/08/20 14:25:11.630801 [info] [raftstore]: shard 2 target peer doesn't exist, peer=<{ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}> message=<MsgApp>
2021/08/20 14:25:11.630809 [info] [raftstore]: shard 2 replicate peer {ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:11.630825 [info] [raftstore]: shard 2 init with raft local state {HardState:{Term:0 Vote:0 Commit:0 XXX_unrecognized:[]} LastIndex:0 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:11.630849 [info] [raftstore]: shard 2 init raft apply state, state=<{AppliedIndex:0 TruncatedState:{Index:0 Term:0 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:11.630850 [info] [raftstore]: shard 2 init last term, last term=<0>
2021/08/20 14:25:11.630854 [info] [raftstore]: shard 2 change init applied index from 0 to 0
{"level":"info","ts":"2021-08-20T14:25:11.630+0800","caller":"raft/raft.go:1550","msg":"6 switched to configuration voters=()"}
{"level":"info","ts":"2021-08-20T14:25:11.630+0800","caller":"raft/raft.go:711","msg":"6 became follower at term 0"}
{"level":"info","ts":"2021-08-20T14:25:11.630+0800","caller":"raft/raft.go:388","msg":"newRaft 6 [peers: [], term: 0, commit: 0, applied: 0, lastindex: 0, lastterm: 0]"}
2021/08/20 14:25:11.630929 [info] [raftstore]: shard 2 peer 6 raft 6 added, epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
{"level":"info","ts":"2021-08-20T14:25:11.630+0800","caller":"raft/raft.go:870","msg":"6 [term: 0] received a MsgHeartbeat message with higher term from 3 [term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:11.630+0800","caller":"raft/raft.go:711","msg":"6 became follower at term 6"}
2021/08/20 14:25:11.631000 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:11.631059 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 skip with no delegates, 0 commits, result <nil>
2021/08/20 14:25:11.631677 [info] prophet: resource 2 send schedule command, step promote learner peer 6 on container 5 to voter, source heartbeat
2021/08/20 14:25:11.631756 [info] [raftstore]: shard-2 AddNode peer {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:11.632082 [info] [transport]: connected to store 1
2021/08/20 14:25:11.632101 [info] [transport]: session 1[127.0.0.1:36090] connected
2021/08/20 14:25:11.632140 [info] [raftstore]: shard-2 propose conf change peer [{ChangeType:AddNode Peer:{ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:11.632193 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:11.632197 [info] [raftstore]: shard 2 do apply change peer peer:<id:6 containerID:5 >  at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:11.632245 [info] [raftstore]: shard-2 add peer {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} successfully, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:11.632249 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 skip with no delegates, 0 commits, result <nil>
{"level":"error","ts":"2021-08-20T14:25:11.632+0800","caller":"raft/log.go:354","msg":"3 >>>>>>>>>>>>>>>> [1:10:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).sendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:442\ngo.etcd.io/etcd/raft.stepLeader\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1150\ngo.etcd.io/etcd/raft.(*raft).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:995\ngo.etcd.io/etcd/raft.(*RawNode).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:114\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleStep\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:257\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:183\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:443\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:11.632370 [info] [raftstore]: shard 2 start snapshot, epoch=<{ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:11.632472 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 9
{"level":"info","ts":"2021-08-20T14:25:11.632+0800","caller":"raft/raft.go:1550","msg":"3 switched to configuration voters=(3 6)"}
{"level":"error","ts":"2021-08-20T14:25:11.632+0800","caller":"raft/log.go:354","msg":"3 >>>>>>>>>>>>>>>> [1:10:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).switchToConfig.func1\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1586\ngo.etcd.io/etcd/raft/tracker.(*ProgressTracker).Visit\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/tracker/tracker.go:209\ngo.etcd.io/etcd/raft.(*raft).switchToConfig\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1585\ngo.etcd.io/etcd/raft.(*raft).applyConfChange\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1537\ngo.etcd.io/etcd/raft.(*RawNode).ApplyConfChange\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:103\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).doApplyConfChange\n\t/root/projects/matrixcube/raftstore/peer_event_post_apply.go:106\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).doPostApplyResult\n\t/root/projects/matrixcube/raftstore/peer_event_post_apply.go:92\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).doPollApply\n\t/root/projects/matrixcube/raftstore/peer_event_post_apply.go:51\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleApplyResult\n\t/root/projects/matrixcube/raftstore/peer_event_post_apply.go:39\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:186\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:443\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:11.632563 [info] [raftstore]: shard 2 notify pd with {Transition:ConfChangeTransitionAuto Changes:[{Type:ConfChangeAddNode NodeID:6 XXX_unrecognized:[]}] Context:[10 32 10 16 129 206 171 239 156 52 70 206 134 50 248 138 14 79 77 202 16 2 26 4 8 3 16 1 42 4 8 2 16 1 26 10 8 1 18 6 18 4 8 6 16 5] XXX_unrecognized:[]} with changes [{ChangeType:AddNode Peer:{ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:11.632578 [info] [raftstore]: shard 2 applied changes [{ChangeType:AddNode Peer:{ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, new peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:11.632638 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:11.632675 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 skip with no delegates, 0 commits, result <nil>
2021/08/20 14:25:11.632644 [info] prophet: resource 2 ConfVer changed from 2 to 3
{"level":"error","ts":"2021-08-20T14:25:11.632+0800","caller":"raft/log.go:354","msg":"3 >>>>>>>>>>>>>>>> [1:10:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).sendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:442\ngo.etcd.io/etcd/raft.stepLeader\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1208\ngo.etcd.io/etcd/raft.(*raft).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:995\ngo.etcd.io/etcd/raft.(*RawNode).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:114\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleStep\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:257\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:183\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:443\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:11.633034 [info] [raftstore]: shard 2 snapshot created, epoch=<confVer:3 version:1 > term=<6> index=<9> 
2021/08/20 14:25:11.633798 [info] prophet: resource 2 operator(add-rule-peer {add peer: container [5]} (kind:resource,replica, resource:2(1,1), createAt:2021-08-20 14:25:11.6180939 +0800 CST m=+7.151620501, startAt:2021-08-20 14:25:11.6181373 +0800 CST m=+7.151663901, currentStep:2, steps:[add learner peer 6 on container 5, promote learner peer 6 on container 5 to voter]) finished) finish, takes 15.6469ms, 
2021/08/20 14:25:11.725651 [info] [raftstore]: begin start raftstore
2021/08/20 14:25:11.725663 [info] [raftstore]: begin to start prophet
2021-08-20 14:25:11.726450 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:c9f427f3296b95b1 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:11.726+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-eaac19d1-edee-457e-a78e-889917edda0a/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:11.726550 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:11.774402 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:11.774442 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 skip with no delegates, 0 commits, result <nil>
{"level":"error","ts":"2021-08-20T14:25:11.774+0800","caller":"raft/log.go:354","msg":"3 >>>>>>>>>>>>>>>> [1:10:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).sendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:442\ngo.etcd.io/etcd/raft.stepLeader\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1208\ngo.etcd.io/etcd/raft.(*raft).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:995\ngo.etcd.io/etcd/raft.(*RawNode).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:114\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleStep\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:257\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:183\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:443\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:11.774593 [info] [transport]: shard 2 start send pending snap, epoch=<confVer:3 version:1 > term=<6> index=<9>
2021/08/20 14:25:11.774712 [info] [transport]: session 2[127.0.0.1:58410] connected
2021/08/20 14:25:11.774716 [info] [raftstore]: shard 2 try to send snap, header=<shard:<id:2 epoch:<confVer:3 version:1 > peers:<id:3 containerID:1 > peers:<id:6 containerID:5 > > from:<id:3 containerID:1 > to:<id:6 containerID:5 role:Learner > term:6 index:9 >,size=<124>
2021/08/20 14:25:11.774768 [info] [raftstore]: shard 2 send snap complete
2021/08/20 14:25:11.774787 [info] [transport]: shard 2 pending snap sent succ, size=<124>, epoch=<confVer:3 version:1 > term=<6> index=<9>
2021/08/20 14:25:11.774717 [info] [transport]: connected to store 5
{"level":"info","ts":"2021-08-20T14:25:11.774+0800","caller":"raft/log.go:301","msg":"log [committed=0, applied=0, unstable.offset=1, len(unstable.Entries)=0] starts to restore snapshot [index: 9, term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:11.774+0800","caller":"raft/raft.go:1550","msg":"6 switched to configuration voters=(3 6)"}
{"level":"info","ts":"2021-08-20T14:25:11.774+0800","caller":"raft/raft.go:1503","msg":"6 [commit: 9, lastindex: 9, lastterm: 6] restored snapshot [index: 9, term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:11.774+0800","caller":"raft/raft.go:1420","msg":"6 [commit: 9] restored snapshot [index: 9, term: 6]"}
2021/08/20 14:25:11.774924 [info] [raftstore]: shard 2 begin to apply snapshot
2021/08/20 14:25:11.774939 [info] [raftstore]: shard 2 clear 0 meta keys and 0 raft keys
2021/08/20 14:25:11.774948 [info] [raftstore]: shard 2 apply snapshot state completed, apply state {AppliedIndex:9 TruncatedState:{Index:9 Term:6 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:11.774964 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 start applying snapshot
2021/08/20 14:25:11.774984 [info] [raftstore]: shard 2 begin apply snapshot data
2021/08/20 14:25:11.775074 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:11.775127 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 add registration job by handleRaftReadyApply
2021/08/20 14:25:11.775148 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 applying snapshot to set read 9
2021/08/20 14:25:11.775172 [info] [raftstore]: shard 2 snapshot is applied, shard=<{ID:2 Start:[] End:[] Epoch:{ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:11.775199 [info] [raftstore]: shard 2 shard changed after apply snapshot, from=<{ID:2 Start:[] End:[] Epoch:{ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}> to=<{ID:2 Start:[] End:[] Epoch:{ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:11.775216 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 AdvanceApply with 9
2021/08/20 14:25:11.775303 [info] [raftstore]: shard 2 delete exists snap gz file /tmp/cube/node-1/snapshots/2_6_9.gz, header is shard:<id:2 epoch:<confVer:2 version:1 > peers:<id:6 containerID:5 role:Learner > peers:<id:3 containerID:1 > > from:<> to:<> term:6 index:9 
2021/08/20 14:25:11.775363 [info] [raftstore]: shard 2 apply snapshot data complete, {Term:6 Vote:0 Commit:9 XXX_unrecognized:[]}
2021/08/20 14:25:11.775380 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 add registration job by handleRaftReadyApply, completed
2021/08/20 14:25:11.823859 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:11.973889 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:12.174021 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:12.227551 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:8ae68e5303dd0380 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:12.227+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-eaac19d1-edee-457e-a78e-889917edda0a/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:12.227673 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:12.373764 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:12.573921 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:12.727881 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:8ae68e5303dd0380 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:12.728+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-eaac19d1-edee-457e-a78e-889917edda0a/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:12.728136 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:12.773859 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:12.974356 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:13.174011 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:13.229073 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:755c3d9656559ea9 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:13.229+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-eaac19d1-edee-457e-a78e-889917edda0a/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:13.229207 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:13.373871 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:13.573830 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:13.729729 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:755c3d9656559ea9 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:13.729+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-eaac19d1-edee-457e-a78e-889917edda0a/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:13.729849 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:13.774383 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:13.973641 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:14.174317 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:14.231061 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:ad228268458467e4 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:14.231+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-eaac19d1-edee-457e-a78e-889917edda0a/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:14.231177 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:14.374372 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:14.574003 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:14.732249 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:ad228268458467e4 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:14.732+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-eaac19d1-edee-457e-a78e-889917edda0a/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:14.732390 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:14.774271 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:14.973416 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:15.174370 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:15.233355 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:9b724de3bf934c9d RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:15.233+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-eaac19d1-edee-457e-a78e-889917edda0a/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:15.233470 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:15.373483 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:15.573512 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:15.734727 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:9b724de3bf934c9d RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:15.734+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-eaac19d1-edee-457e-a78e-889917edda0a/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:15.734875 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:15.774259 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:15.973422 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:16.173749 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:16.235976 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:6b1ace49a9f387c8 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:16.236+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-eaac19d1-edee-457e-a78e-889917edda0a/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:16.236125 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:16.374129 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:16.573640 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
{"level":"info","ts":"2021-08-20T14:25:16.738+0800","caller":"raft/raft.go:1550","msg":"93ccda9956d988f4 switched to configuration voters=(7717707727232010184 10650127570946328820 12791365408210890720)"}
{"level":"info","ts":"2021-08-20T14:25:16.738+0800","caller":"raft/raft.go:1550","msg":"b1840f1134a12fe0 switched to configuration voters=(7717707727232010184 10650127570946328820 12791365408210890720)"}
2021-08-20 14:25:16.738534 I | etcdserver/membership: added member 6b1ace49a9f387c8 [http://127.0.0.1:50002] to cluster 6a4ade671189dc2f
2021-08-20 14:25:16.738538 I | etcdserver/membership: added member 6b1ace49a9f387c8 [http://127.0.0.1:50002] to cluster 6a4ade671189dc2f
2021-08-20 14:25:16.738541 I | rafthttp: starting peer 6b1ace49a9f387c8...
2021-08-20 14:25:16.738544 I | rafthttp: starting peer 6b1ace49a9f387c8...
2021-08-20 14:25:16.738554 I | rafthttp: started HTTP pipelining with peer 6b1ace49a9f387c8
2021-08-20 14:25:16.738679 I | rafthttp: started HTTP pipelining with peer 6b1ace49a9f387c8
2021-08-20 14:25:16.738776 I | rafthttp: started streaming with peer 6b1ace49a9f387c8 (writer)
2021-08-20 14:25:16.738849 I | rafthttp: started streaming with peer 6b1ace49a9f387c8 (writer)
2021-08-20 14:25:16.738930 I | rafthttp: started streaming with peer 6b1ace49a9f387c8 (writer)
2021-08-20 14:25:16.739262 I | rafthttp: started streaming with peer 6b1ace49a9f387c8 (stream MsgApp v2 reader)
2021-08-20 14:25:16.739287 I | rafthttp: started streaming with peer 6b1ace49a9f387c8 (writer)
2021-08-20 14:25:16.739442 I | rafthttp: started peer 6b1ace49a9f387c8
2021-08-20 14:25:16.739488 I | rafthttp: started streaming with peer 6b1ace49a9f387c8 (stream Message reader)
2021-08-20 14:25:16.739525 I | rafthttp: added peer 6b1ace49a9f387c8
2021-08-20 14:25:16.740525 I | rafthttp: started peer 6b1ace49a9f387c8
2021-08-20 14:25:16.740543 I | rafthttp: added peer 6b1ace49a9f387c8
2021-08-20 14:25:16.740718 I | rafthttp: started streaming with peer 6b1ace49a9f387c8 (stream Message reader)
2021-08-20 14:25:16.741355 I | rafthttp: started streaming with peer 6b1ace49a9f387c8 (stream MsgApp v2 reader)
[WARNING] Deprecated '--logger=capnslog' flag is set; use '--logger=zap' flag instead
2021-08-20 14:25:16.742152 I | embed: pprof is enabled under /debug/pprof
2021-08-20 14:25:16.742193 I | embed: name = node-2
2021-08-20 14:25:16.742225 I | embed: data dir = /tmp/cube/node-2/prophet
2021-08-20 14:25:16.742227 I | embed: member dir = /tmp/cube/node-2/prophet/member
2021-08-20 14:25:16.742229 I | embed: heartbeat = 100ms
2021-08-20 14:25:16.742230 I | embed: election = 3000ms
2021-08-20 14:25:16.742232 I | embed: snapshot count = 100000
2021-08-20 14:25:16.742235 I | embed: advertise client URLs = http://127.0.0.1:40002
2021-08-20 14:25:16.746866 I | etcdserver: starting member 6b1ace49a9f387c8 in cluster 6a4ade671189dc2f
{"level":"info","ts":"2021-08-20T14:25:16.746+0800","caller":"raft/raft.go:1550","msg":"6b1ace49a9f387c8 switched to configuration voters=()"}
{"level":"info","ts":"2021-08-20T14:25:16.746+0800","caller":"raft/raft.go:711","msg":"6b1ace49a9f387c8 became follower at term 0"}
{"level":"info","ts":"2021-08-20T14:25:16.746+0800","caller":"raft/raft.go:388","msg":"newRaft 6b1ace49a9f387c8 [peers: [], term: 0, commit: 0, applied: 0, lastindex: 0, lastterm: 0]"}
2021-08-20 14:25:16.748565 W | auth: simple token is not cryptographically signed
2021-08-20 14:25:16.751447 I | rafthttp: started HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:16.751464 I | rafthttp: started HTTP pipelining with peer b1840f1134a12fe0
2021-08-20 14:25:16.751469 I | rafthttp: starting peer 93ccda9956d988f4...
2021-08-20 14:25:16.751473 I | rafthttp: started HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:16.751663 I | rafthttp: started streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:16.751722 I | rafthttp: started peer 93ccda9956d988f4
2021-08-20 14:25:16.751734 I | rafthttp: started streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:16.751737 I | rafthttp: added peer 93ccda9956d988f4
2021-08-20 14:25:16.751739 I | rafthttp: started streaming with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:16.751744 I | rafthttp: starting peer b1840f1134a12fe0...
2021-08-20 14:25:16.751752 I | rafthttp: started HTTP pipelining with peer b1840f1134a12fe0
2021-08-20 14:25:16.751811 I | rafthttp: started streaming with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:16.751919 I | rafthttp: started streaming with peer b1840f1134a12fe0 (writer)
2021-08-20 14:25:16.751948 I | rafthttp: peer 6b1ace49a9f387c8 became active
2021-08-20 14:25:16.751959 I | rafthttp: established a TCP streaming connection with peer 6b1ace49a9f387c8 (stream Message writer)
2021-08-20 14:25:16.751983 I | rafthttp: established a TCP streaming connection with peer 6b1ace49a9f387c8 (stream MsgApp v2 writer)
2021-08-20 14:25:16.751999 I | rafthttp: peer 93ccda9956d988f4 became active
2021-08-20 14:25:16.752005 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:16.752023 I | rafthttp: started streaming with peer b1840f1134a12fe0 (writer)
2021-08-20 14:25:16.752025 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:16.752042 I | rafthttp: started peer b1840f1134a12fe0
2021-08-20 14:25:16.752060 I | rafthttp: added peer b1840f1134a12fe0
2021-08-20 14:25:16.752065 I | etcdserver: starting server... [version: 3.4.15, cluster version: to_be_decided]
2021-08-20 14:25:16.752099 I | rafthttp: started streaming with peer b1840f1134a12fe0 (stream Message reader)
2021-08-20 14:25:16.752142 I | rafthttp: started streaming with peer b1840f1134a12fe0 (stream MsgApp v2 reader)
2021-08-20 14:25:16.752319 I | rafthttp: peer 6b1ace49a9f387c8 became active
2021-08-20 14:25:16.752338 I | rafthttp: established a TCP streaming connection with peer 6b1ace49a9f387c8 (stream Message writer)
2021-08-20 14:25:16.752343 I | rafthttp: established a TCP streaming connection with peer 6b1ace49a9f387c8 (stream MsgApp v2 writer)
2021-08-20 14:25:16.752349 I | embed: listening for peers on 127.0.0.1:50002
2021-08-20 14:25:16.752362 I | rafthttp: peer b1840f1134a12fe0 became active
2021-08-20 14:25:16.752368 I | rafthttp: established a TCP streaming connection with peer b1840f1134a12fe0 (stream MsgApp v2 reader)
2021-08-20 14:25:16.752393 I | rafthttp: established a TCP streaming connection with peer b1840f1134a12fe0 (stream Message reader)
2021/08/20 14:25:16.773996 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:16.803197 I | etcdserver: 6b1ace49a9f387c8 initialized peer connection; fast-forwarding 28 ticks (election ticks 30) with 2 active peer(s)
{"level":"info","ts":"2021-08-20T14:25:16.810+0800","caller":"raft/raft.go:870","msg":"6b1ace49a9f387c8 [term: 0] received a MsgHeartbeat message with higher term from 93ccda9956d988f4 [term: 2]"}
{"level":"info","ts":"2021-08-20T14:25:16.810+0800","caller":"raft/raft.go:711","msg":"6b1ace49a9f387c8 became follower at term 2"}
{"level":"info","ts":"2021-08-20T14:25:16.810+0800","caller":"raft/node.go:325","msg":"raft.node: 6b1ace49a9f387c8 elected leader 93ccda9956d988f4 at term 2"}
{"level":"info","ts":"2021-08-20T14:25:16.812+0800","caller":"raft/raft.go:1550","msg":"6b1ace49a9f387c8 switched to configuration voters=(10650127570946328820)"}
2021-08-20 14:25:16.812150 I | etcdserver/membership: added member 93ccda9956d988f4 [http://127.0.0.1:50000] to cluster 6a4ade671189dc2f
2021-08-20 14:25:16.812194 N | etcdserver/membership: set the initial cluster version to 3.4
{"level":"info","ts":"2021-08-20T14:25:16.812+0800","caller":"raft/raft.go:1550","msg":"6b1ace49a9f387c8 switched to configuration voters=(10650127570946328820 12791365408210890720)"}
2021-08-20 14:25:16.812558 I | etcdserver/membership: added member b1840f1134a12fe0 [http://127.0.0.1:50001] to cluster 6a4ade671189dc2f
{"level":"info","ts":"2021-08-20T14:25:16.812+0800","caller":"raft/raft.go:1550","msg":"6b1ace49a9f387c8 switched to configuration voters=(7717707727232010184 10650127570946328820 12791365408210890720)"}
2021-08-20 14:25:16.812756 I | etcdserver/membership: added member 6b1ace49a9f387c8 [http://127.0.0.1:50002] to cluster 6a4ade671189dc2f
2021-08-20 14:25:16.813326 I | etcdserver: published {Name:node-2 ClientURLs:[http://127.0.0.1:40002]} to cluster 6a4ade671189dc2f
2021-08-20 14:25:16.813341 I | embed: ready to serve client requests
2021/08/20 14:25:16.813342 [info] prophet: create etcd v3 client with endpoints [http://127.0.0.1:40002]
2021-08-20 14:25:16.813579 N | embed: serving insecure client requests on 127.0.0.1:40002, this is strongly discouraged!
2021/08/20 14:25:16.814267 [info] prophet: net application started
2021/08/20 14:25:16.814274 [info] prophet: start system time monitor 
2021/08/20 14:25:16.814742 [info] prophet: [prophet-leader/node-2]/loop: current leader is [涕Ӷnode-0127.0.0.1:30000]
2021/08/20 14:25:16.814755 [info] prophet: [prophet-leader/node-2]/loop: start watch leader 涕Ӷnode-0127.0.0.1:30000
2021/08/20 14:25:16.814757 [info] prophet: ********node-2 become to follower now********
2021/08/20 14:25:16.814786 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:16.814787 [info] prophet: client read loop started 
2021/08/20 14:25:16.814791 [info] prophet: client started
2021/08/20 14:25:16.814844 [info] prophet: session 5[127.0.0.1:38582] connected
2021/08/20 14:25:16.814845 [info] [raftstore]: *********Become prophet follower*********
2021/08/20 14:25:16.814882 [info] [raftstore]: begin to bootstrap the cluster
2021/08/20 14:25:16.814901 [info] [raftstore]: raftstore init with store raftAddr:"127.0.0.1:10002" clientAddr:"127.0.0.1:20002" labels:<key:"c" value:"2" > startTime:1629440716 deployPath:"not set" 
2021/08/20 14:25:16.814904 [info] [raftstore]: begin to create local store metadata
2021/08/20 14:25:16.814854 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:16.814949 [info] prophet: client read loop actived, ready to read from leader
2021/08/20 14:25:16.815020 [info] [raftstore]: create local store with id 7
2021/08/20 14:25:16.815451 [info] [raftstore]: the cluster already bootstrap: true
2021/08/20 14:25:16.817755 [info] prophet: container 7 limit added
2021/08/20 14:25:16.817834 [info] [raftstore]: prophet started
2021/08/20 14:25:16.817889 [info] [transport]: net application started
2021/08/20 14:25:16.817899 [info] [raftstore]: start listen at 127.0.0.1:10002 for raft
2021/08/20 14:25:16.817901 [info] [raftstore]: raft shards workers started
2021/08/20 14:25:16.817834 [info] prophet: container 7 heartbeat stream binded
2021/08/20 14:25:16.817904 [info] [raftstore]: starts with 0 shards, including 0 tombstones and 0 applying shards
2021/08/20 14:25:16.817909 [info] [raftstore]: cleanup possible garbage data complete
2021/08/20 14:25:16.817909 [info] [raftstore]: raft worker 0/0 start
2021/08/20 14:25:16.817910 [info] [raftstore]: shards started
2021/08/20 14:25:16.817912 [info] [raftstore]: shard timer based tasks started
2021/08/20 14:25:16.817919 [info] [raftstore]: net application started
2021/08/20 14:25:16.817920 [info] [raftstore]: start listen at 127.0.0.1:20002 for client
2021/08/20 14:25:16.817930 [info] [raftstore]: router started
2021/08/20 14:25:16.817944 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:16.817948 [info] [raftstore]: router event loop task started
2021/08/20 14:25:16.818005 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:16.818007 [info] prophet: watcher init leader connection 127.0.0.1:30000 succeed
2021/08/20 14:25:16.818013 [info] prophet: session 6[127.0.0.1:38584] connected
2021/08/20 14:25:16.818034 [info] prophet: new watcher 127.0.0.1:38584 added
2021/08/20 14:25:16.818108 [info] [raftstore]: start init event
2021-08-20 14:25:16.840291 I | rafthttp: established a TCP streaming connection with peer b1840f1134a12fe0 (stream MsgApp v2 writer)
2021-08-20 14:25:16.840311 I | rafthttp: established a TCP streaming connection with peer 6b1ace49a9f387c8 (stream MsgApp v2 reader)
2021-08-20 14:25:16.840326 I | rafthttp: established a TCP streaming connection with peer b1840f1134a12fe0 (stream Message writer)
2021-08-20 14:25:16.840337 I | rafthttp: established a TCP streaming connection with peer 6b1ace49a9f387c8 (stream Message reader)
2021/08/20 14:25:16.842534 [info] prophet: resource 2 add operator add-rule-peer {add peer: container [7]} (kind:resource,replica, resource:2(1,3), createAt:2021-08-20 14:25:16.8425177 +0800 CST m=+12.376044301, startAt:0001-01-01 00:00:00 +0000 UTC, currentStep:0, steps:[add learner peer 8 on container 7, promote learner peer 8 on container 7 to voter]), 
2021/08/20 14:25:16.842549 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source create
2021/08/20 14:25:16.842607 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021-08-20 14:25:16.842630 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream Message writer)
2021-08-20 14:25:16.842649 I | rafthttp: established a TCP streaming connection with peer 6b1ace49a9f387c8 (stream MsgApp v2 reader)
2021-08-20 14:25:16.842651 I | rafthttp: established a TCP streaming connection with peer 6b1ace49a9f387c8 (stream Message reader)
2021-08-20 14:25:16.842660 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 writer)
2021/08/20 14:25:16.850350 [info] [raftstore]: shard-2 propose conf change peer [{ChangeType:AddLearnerNode Peer:{ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:16.850452 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:16.850608 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:16.850634 [info] [raftstore]: shard 2 do apply change peer changeType:AddLearnerNode peer:<id:8 containerID:7 role:Learner >  at epoch {ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:16.850646 [info] [raftstore]: shard-2 add learner peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} successfully, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:16.850675 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 10
{"level":"info","ts":"2021-08-20T14:25:16.850+0800","caller":"raft/raft.go:1550","msg":"3 switched to configuration voters=(3 6) learners=(8)"}
2021/08/20 14:25:16.850749 [info] [raftstore]: shard 2 notify pd with {Transition:ConfChangeTransitionAuto Changes:[{Type:ConfChangeAddLearnerNode NodeID:8 XXX_unrecognized:[]}] Context:[10 32 10 16 199 204 83 164 116 131 73 101 184 121 210 1 243 92 244 168 16 2 26 4 8 3 16 1 42 4 8 3 16 1 26 14 8 1 18 10 8 3 18 6 8 8 16 7 24 1] XXX_unrecognized:[]} with changes [{ChangeType:AddLearnerNode Peer:{ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:4 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:16.850772 [info] [raftstore]: shard 2 applied changes [{ChangeType:AddLearnerNode Peer:{ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:4 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, new peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:16.850786 [info] prophet: [prophet-leader/node-2]/watch: leader updated to 涕Ӷnode-0127.0.0.1:30000
2021/08/20 14:25:16.850681 [info] [raftstore]: shard 2 do apply change peer changeType:AddLearnerNode peer:<id:8 containerID:7 role:Learner >  at epoch {ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:16.850835 [info] [raftstore]: shard-2 add learner peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} successfully, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:16.850866 [info] prophet: resource 2 ConfVer changed from 3 to 4
2021/08/20 14:25:16.851930 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 AdvanceApply with 10
{"level":"info","ts":"2021-08-20T14:25:16.851+0800","caller":"raft/raft.go:1550","msg":"6 switched to configuration voters=(3 6) learners=(8)"}
2021/08/20 14:25:16.851992 [info] [raftstore]: shard 2 applied changes [{ChangeType:AddLearnerNode Peer:{ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:4 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, new peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:16.852582 [info] prophet: resource 2 send schedule command, step promote learner peer 8 on container 7 to voter, source heartbeat
2021/08/20 14:25:16.852665 [info] [transport]: connected to store 7
2021/08/20 14:25:16.852690 [info] [raftstore]: shard-2 AddNode peer {ID:8 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:16.852711 [info] [transport]: session 1[127.0.0.1:40862] connected
2021/08/20 14:25:16.852729 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:16.852750 [info] [raftstore]: shard 2 target peer doesn't exist, peer=<{ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}> message=<MsgApp>
2021/08/20 14:25:16.852757 [info] [raftstore]: shard 2 replicate peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:16.852772 [info] [raftstore]: shard 2 init with raft local state {HardState:{Term:0 Vote:0 Commit:0 XXX_unrecognized:[]} LastIndex:0 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:16.852786 [info] [raftstore]: shard 2 init raft apply state, state=<{AppliedIndex:0 TruncatedState:{Index:0 Term:0 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:16.852787 [info] [raftstore]: shard 2 init last term, last term=<0>
2021/08/20 14:25:16.852790 [info] [raftstore]: shard 2 change init applied index from 0 to 0
2021/08/20 14:25:16.852801 [info] [raftstore]: shard-2 propose conf change peer [{ChangeType:AddNode Peer:{ID:8 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
{"level":"info","ts":"2021-08-20T14:25:16.852+0800","caller":"raft/raft.go:1550","msg":"8 switched to configuration voters=()"}
{"level":"info","ts":"2021-08-20T14:25:16.852+0800","caller":"raft/raft.go:711","msg":"8 became follower at term 0"}
{"level":"info","ts":"2021-08-20T14:25:16.852+0800","caller":"raft/raft.go:388","msg":"newRaft 8 [peers: [], term: 0, commit: 0, applied: 0, lastindex: 0, lastterm: 0]"}
2021/08/20 14:25:16.852897 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:16.852937 [info] [raftstore]: shard 2 peer 8 raft 8 added, epoch {ConfVer:4 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
{"level":"info","ts":"2021-08-20T14:25:16.852+0800","caller":"raft/raft.go:870","msg":"8 [term: 0] received a MsgHeartbeat message with higher term from 3 [term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:16.853+0800","caller":"raft/raft.go:711","msg":"8 became follower at term 6"}
2021/08/20 14:25:16.853027 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:16.853031 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 send 1 msgs
2021/08/20 14:25:16.853038 [info] [raftstore]: shard 2 do apply change peer peer:<id:8 containerID:7 >  at epoch {ConfVer:4 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:16.853046 [info] [raftstore]: shard-2 add peer {ID:8 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} successfully, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:16.853054 [info] [raftstore]: shard 2 do apply change peer peer:<id:8 containerID:7 >  at epoch {ConfVer:4 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:16.853055 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 11
2021/08/20 14:25:16.853062 [info] [raftstore]: shard-2 add peer {ID:8 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} successfully, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:16.853071 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 AdvanceApply with 11
{"level":"info","ts":"2021-08-20T14:25:16.853+0800","caller":"raft/raft.go:1550","msg":"6 switched to configuration voters=(3 6 8)"}
2021/08/20 14:25:16.853076 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 skip with no delegates, 0 commits, result <nil>
2021/08/20 14:25:16.853111 [info] [raftstore]: shard 2 applied changes [{ChangeType:AddNode Peer:{ID:8 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:5 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, new peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
{"level":"info","ts":"2021-08-20T14:25:16.853+0800","caller":"raft/raft.go:1550","msg":"3 switched to configuration voters=(3 6 8)"}
2021/08/20 14:25:16.853126 [info] [raftstore]: shard 2 notify pd with {Transition:ConfChangeTransitionAuto Changes:[{Type:ConfChangeAddNode NodeID:8 XXX_unrecognized:[]}] Context:[10 32 10 16 39 152 60 195 179 112 78 217 147 7 41 2 55 168 12 203 16 2 26 4 8 3 16 1 42 4 8 4 16 1 26 10 8 1 18 6 18 4 8 8 16 7] XXX_unrecognized:[]} with changes [{ChangeType:AddNode Peer:{ID:8 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:5 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:16.853145 [info] [raftstore]: shard 2 applied changes [{ChangeType:AddNode Peer:{ID:8 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:5 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, new peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:16.853178 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:16.853222 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 send 1 msgs
2021/08/20 14:25:16.853229 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 skip with no delegates, 0 commits, result <nil>
2021/08/20 14:25:16.853232 [info] prophet: resource 2 ConfVer changed from 4 to 5
2021/08/20 14:25:16.853852 [info] [transport]: connected to store 1
2021/08/20 14:25:16.853878 [info] [transport]: session 2[127.0.0.1:36160] connected
2021/08/20 14:25:16.853941 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 send 2 msgs
2021/08/20 14:25:16.853966 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 skip with no delegates, 0 commits, result <nil>
{"level":"error","ts":"2021-08-20T14:25:16.854+0800","caller":"raft/log.go:354","msg":"3 >>>>>>>>>>>>>>>> [1:12:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).sendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:442\ngo.etcd.io/etcd/raft.stepLeader\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1150\ngo.etcd.io/etcd/raft.(*raft).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:995\ngo.etcd.io/etcd/raft.(*RawNode).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:114\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleStep\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:257\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:183\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:443\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:16.854063 [info] [raftstore]: shard 2 start snapshot, epoch=<{ConfVer:5 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:16.854472 [info] prophet: resource 2 operator(add-rule-peer {add peer: container [7]} (kind:resource,replica, resource:2(1,3), createAt:2021-08-20 14:25:16.8425177 +0800 CST m=+12.376044301, startAt:2021-08-20 14:25:16.8425445 +0800 CST m=+12.376071101, currentStep:2, steps:[add learner peer 8 on container 7, promote learner peer 8 on container 7 to voter]) finished) finish, takes 11.9157ms, 
2021/08/20 14:25:16.855160 [info] [raftstore]: shard 2 snapshot created, epoch=<confVer:5 version:1 > term=<6> index=<11> 
{"level":"error","ts":"2021-08-20T14:25:16.930+0800","caller":"raft/log.go:354","msg":"3 >>>>>>>>>>>>>>>> [1:13:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).sendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:442\ngo.etcd.io/etcd/raft.(*raft).bcastAppend.func1\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:538\ngo.etcd.io/etcd/raft/tracker.(*ProgressTracker).Visit\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/tracker/tracker.go:209\ngo.etcd.io/etcd/raft.(*raft).bcastAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:534\ngo.etcd.io/etcd/raft.stepLeader\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1090\ngo.etcd.io/etcd/raft.(*raft).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:995\ngo.etcd.io/etcd/raft.(*RawNode).Propose\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:83\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).proposeNormal\n\t/root/projects/matrixcube/raftstore/peer_event_proposal.go:198\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).propose\n\t/root/projects/matrixcube/raftstore/peer_event_proposal.go:135\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleRequest\n\t/root/projects/matrixcube/raftstore/peer_event_proposal.go:98\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:187\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:447\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:16.930623 [info] [transport]: shard 2 start send pending snap, epoch=<confVer:5 version:1 > term=<6> index=<11>
2021/08/20 14:25:16.930638 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:16.930744 [info] [raftstore]: shard 2 try to send snap, header=<shard:<id:2 epoch:<confVer:5 version:1 > peers:<id:3 containerID:1 > peers:<id:6 containerID:5 > peers:<id:8 containerID:7 > > from:<id:3 containerID:1 > to:<id:8 containerID:7 role:Learner > term:6 index:11 >,size=<124>
2021/08/20 14:25:16.930789 [info] [raftstore]: shard 2 send snap complete
2021/08/20 14:25:16.930805 [info] [transport]: shard 2 pending snap sent succ, size=<124>, epoch=<confVer:5 version:1 > term=<6> index=<11>
2021/08/20 14:25:16.930900 [info] [transport]: connected to store 7
2021/08/20 14:25:16.930915 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 12
2021/08/20 14:25:16.930912 [info] [transport]: session 2[127.0.0.1:40866] connected
2021/08/20 14:25:16.930999 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
{"level":"info","ts":"2021-08-20T14:25:16.931+0800","caller":"raft/log.go:301","msg":"log [committed=0, applied=0, unstable.offset=1, len(unstable.Entries)=0] starts to restore snapshot [index: 11, term: 6]"}
2021/08/20 14:25:16.931066 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 AdvanceApply with 12
2021/08/20 14:25:16.931072 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
{"level":"info","ts":"2021-08-20T14:25:16.931+0800","caller":"raft/raft.go:1550","msg":"8 switched to configuration voters=(3 6 8)"}
{"level":"info","ts":"2021-08-20T14:25:16.931+0800","caller":"raft/raft.go:1503","msg":"8 [commit: 11, lastindex: 11, lastterm: 6] restored snapshot [index: 11, term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:16.931+0800","caller":"raft/raft.go:1420","msg":"8 [commit: 11] restored snapshot [index: 11, term: 6]"}
2021/08/20 14:25:16.931119 [info] [raftstore]: shard 2 begin to apply snapshot
2021/08/20 14:25:16.931141 [info] [raftstore]: shard 2 clear 0 meta keys and 0 raft keys
2021/08/20 14:25:16.931149 [info] [raftstore]: shard 2 apply snapshot state completed, apply state {AppliedIndex:11 TruncatedState:{Index:11 Term:6 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:16.931156 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 start applying snapshot
2021/08/20 14:25:16.931160 [info] [raftstore]: shard 2 begin apply snapshot data
2021/08/20 14:25:16.931188 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 13
2021/08/20 14:25:16.931191 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:16.931220 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 AdvanceApply with 13
2021/08/20 14:25:16.931235 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 send 1 msgs
2021/08/20 14:25:16.931276 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 add registration job by handleRaftReadyApply
2021/08/20 14:25:16.931293 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 applying snapshot to set read 11
2021/08/20 14:25:16.931316 [info] [raftstore]: shard 2 snapshot is applied, shard=<{ID:2 Start:[] End:[] Epoch:{ConfVer:5 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:16.931330 [info] [raftstore]: shard 2 shard changed after apply snapshot, from=<{ID:2 Start:[] End:[] Epoch:{ConfVer:4 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}> to=<{ID:2 Start:[] End:[] Epoch:{ConfVer:5 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:16.931349 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 AdvanceApply with 11
2021/08/20 14:25:16.931712 [info] [raftstore]: shard 2 delete exists snap gz file /tmp/cube/node-2/snapshots/2_6_11.gz, header is shard:<id:2 epoch:<confVer:4 version:1 > peers:<id:8 containerID:7 role:Learner > peers:<id:3 containerID:1 > > from:<> to:<> term:6 index:11 
2021/08/20 14:25:16.931749 [info] [raftstore]: shard 2 apply snapshot data complete, {Term:6 Vote:0 Commit:11 XXX_unrecognized:[]}
2021/08/20 14:25:16.931753 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 add registration job by handleRaftReadyApply, completed
2021/08/20 14:25:16.973603 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:16.973614 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 send 3 msgs
2021/08/20 14:25:16.973675 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 AdvanceApply with 12
2021/08/20 14:25:16.973755 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 send 3 msgs
2021/08/20 14:25:16.973816 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 AdvanceApply with 13
2021/08/20 14:25:17.030677 [info] [raftstore]: shard 2 start split check job from [122 0 0 0 0 0 0 0 0] to [122 0 0 0 0 0 0 0 1]
2021/08/20 14:25:17.030713 [info] [raftstore]: shard 2 try to split, size 40 bytes splitKeys [[122 0 0 0 0 0 0 0 0 107 101 121 50]]
2021/08/20 14:25:17.030778 [info] prophet: alloc ids [10 11 12] for resource 9 split
2021/08/20 14:25:17.040442 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 send 1 msgs
2021/08/20 14:25:17.040453 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:17.040556 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 14
2021/08/20 14:25:17.040592 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 send 1 msgs
2021/08/20 14:25:17.040605 [info] [raftstore]: shard 2 update to {ID:2 Start:[] End:[107 101 121 50] Epoch:{ConfVer:5 Version:2 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} by post applt split
2021/08/20 14:25:17.040629 [info] [raftstore]: shard 9 init with raft local state {HardState:{Term:5 Vote:0 Commit:5 XXX_unrecognized:[]} LastIndex:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:17.040636 [info] [raftstore]: shard 9 init raft apply state, state=<{AppliedIndex:5 TruncatedState:{Index:5 Term:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:17.040638 [info] [raftstore]: shard 9 init last term, last term=<5>
2021/08/20 14:25:17.040641 [info] [raftstore]: shard 9 change init applied index from 5 to 5
2021/08/20 14:25:17.040651 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 AdvanceApply with 14
{"level":"info","ts":"2021-08-20T14:25:17.040+0800","caller":"raft/raft.go:1550","msg":"a switched to configuration voters=(10 11 12)"}
2021/08/20 14:25:17.040566 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
{"level":"info","ts":"2021-08-20T14:25:17.040+0800","caller":"raft/raft.go:711","msg":"a became follower at term 5"}
2021/08/20 14:25:17.040690 [info] [raftstore]: shard 2 update to {ID:2 Start:[] End:[107 101 121 50] Epoch:{ConfVer:5 Version:2 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} by post applt split
{"level":"info","ts":"2021-08-20T14:25:17.040+0800","caller":"raft/raft.go:388","msg":"newRaft a [peers: [a,b,c], term: 5, commit: 5, applied: 5, lastindex: 5, lastterm: 5]"}
2021/08/20 14:25:17.040704 [info] [raftstore]: shard 9 init with raft local state {HardState:{Term:5 Vote:0 Commit:5 XXX_unrecognized:[]} LastIndex:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:17.040706 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 10 add registration job by doApplySplit
2021/08/20 14:25:17.040710 [info] [raftstore]: shard 9 init raft apply state, state=<{AppliedIndex:5 TruncatedState:{Index:5 Term:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:17.040718 [info] [raftstore]: shard 9 peer 10 raft a added, epoch {ConfVer:5 Version:2 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:10 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:11 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:12 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:17.040733 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 AdvanceApply with 14
2021/08/20 14:25:17.040744 [info] [raftstore]: shard 2 new shard added, new shards [{ID:9 Start:[107 101 121 50] End:[] Epoch:{ConfVer:5 Version:2 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:10 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:11 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:12 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:17.040746 [info] [raftstore]: shard 9 init last term, last term=<5>
2021/08/20 14:25:17.040795 [info] [raftstore]: shard 9 change init applied index from 5 to 5
{"level":"info","ts":"2021-08-20T14:25:17.040+0800","caller":"raft/raft.go:934","msg":"a is starting a new election at term 5"}
{"level":"info","ts":"2021-08-20T14:25:17.040+0800","caller":"raft/raft.go:724","msg":"a became candidate at term 6"}
{"level":"info","ts":"2021-08-20T14:25:17.040+0800","caller":"raft/raft.go:835","msg":"a received MsgVoteResp from a at term 6"}
{"level":"info","ts":"2021-08-20T14:25:17.040+0800","caller":"raft/raft.go:822","msg":"a [logterm: 5, index: 5] sent MsgVote request to b at term 6"}
{"level":"info","ts":"2021-08-20T14:25:17.040+0800","caller":"raft/raft.go:1550","msg":"c switched to configuration voters=(10 11 12)"}
{"level":"info","ts":"2021-08-20T14:25:17.040+0800","caller":"raft/raft.go:822","msg":"a [logterm: 5, index: 5] sent MsgVote request to c at term 6"}
{"level":"info","ts":"2021-08-20T14:25:17.040+0800","caller":"raft/raft.go:711","msg":"c became follower at term 5"}
{"level":"info","ts":"2021-08-20T14:25:17.040+0800","caller":"raft/raft.go:388","msg":"newRaft c [peers: [a,b,c], term: 5, commit: 5, applied: 5, lastindex: 5, lastterm: 5]"}
2021/08/20 14:25:17.040819 [info] prophet: resource 2 version changed from 1 to 2
2021/08/20 14:25:17.040854 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 10 send 2 msgs
2021/08/20 14:25:17.040749 [info] [raftstore]: shard 2 update to {ID:2 Start:[] End:[107 101 121 50] Epoch:{ConfVer:5 Version:2 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} by post applt split
2021/08/20 14:25:17.041088 [info] [raftstore]: shard 9 init with raft local state {HardState:{Term:5 Vote:0 Commit:5 XXX_unrecognized:[]} LastIndex:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:17.041095 [info] [raftstore]: shard 9 init raft apply state, state=<{AppliedIndex:5 TruncatedState:{Index:5 Term:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:17.041097 [info] [raftstore]: shard 9 init last term, last term=<5>
2021/08/20 14:25:17.041102 [info] [raftstore]: shard 9 change init applied index from 5 to 5
{"level":"info","ts":"2021-08-20T14:25:17.041+0800","caller":"raft/raft.go:1550","msg":"b switched to configuration voters=(10 11 12)"}
{"level":"info","ts":"2021-08-20T14:25:17.041+0800","caller":"raft/raft.go:711","msg":"b became follower at term 5"}
{"level":"info","ts":"2021-08-20T14:25:17.041+0800","caller":"raft/raft.go:388","msg":"newRaft b [peers: [a,b,c], term: 5, commit: 5, applied: 5, lastindex: 5, lastterm: 5]"}
2021/08/20 14:25:17.041172 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 11 add registration job by doApplySplit
2021/08/20 14:25:17.040904 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 12 add registration job by doApplySplit
2021/08/20 14:25:17.041192 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 11 add registration job by doApplySplit, completed
2021/08/20 14:25:17.041211 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 12 add registration job by doApplySplit, completed
2021/08/20 14:25:17.041220 [info] [raftstore]: shard 9 peer 11 raft b added, epoch {ConfVer:5 Version:2 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:10 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:11 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:12 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:17.041241 [info] [raftstore]: shard 2 new shard added, new shards [{ID:9 Start:[107 101 121 50] End:[] Epoch:{ConfVer:5 Version:2 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:10 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:11 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:12 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
{"level":"info","ts":"2021-08-20T14:25:17.041+0800","caller":"raft/raft.go:870","msg":"b [term: 5] received a MsgVote message with higher term from a [term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:17.041+0800","caller":"raft/raft.go:711","msg":"b became follower at term 6"}
{"level":"info","ts":"2021-08-20T14:25:17.041+0800","caller":"raft/raft.go:971","msg":"b [logterm: 5, index: 5, vote: 0] cast MsgVote for a [logterm: 5, index: 5] at term 6"}
2021/08/20 14:25:17.041266 [info] [raftstore]: shard 9 peer 12 raft c added, epoch {ConfVer:5 Version:2 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:10 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:11 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:12 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:17.041313 [info] [raftstore]: shard 2 new shard added, new shards [{ID:9 Start:[107 101 121 50] End:[] Epoch:{ConfVer:5 Version:2 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:10 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:11 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:12 ContainerID:7 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
{"level":"info","ts":"2021-08-20T14:25:17.041+0800","caller":"raft/raft.go:870","msg":"c [term: 5] received a MsgVote message with higher term from a [term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:17.041+0800","caller":"raft/raft.go:711","msg":"c became follower at term 6"}
{"level":"info","ts":"2021-08-20T14:25:17.041+0800","caller":"raft/raft.go:971","msg":"c [logterm: 5, index: 5, vote: 0] cast MsgVote for a [logterm: 5, index: 5] at term 6"}
2021/08/20 14:25:17.041346 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 12 send 1 msgs
2021/08/20 14:25:17.040711 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 10 add registration job by doApplySplit, completed
2021/08/20 14:25:17.041290 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 11 send 1 msgs
{"level":"info","ts":"2021-08-20T14:25:17.041+0800","caller":"raft/raft.go:835","msg":"a received MsgVoteResp from c at term 6"}
{"level":"info","ts":"2021-08-20T14:25:17.041+0800","caller":"raft/raft.go:1319","msg":"a has received 2 MsgVoteResp votes and 0 vote rejections"}
{"level":"info","ts":"2021-08-20T14:25:17.041+0800","caller":"raft/raft.go:776","msg":"a became leader at term 6"}
2021/08/20 14:25:17.041465 [info] [raftstore]: shard 9 ********become leader now********
2021/08/20 14:25:17.041472 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 10 send 2 msgs
2021/08/20 14:25:17.041536 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 11 send 1 msgs
2021/08/20 14:25:17.041556 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 12 send 1 msgs
2021/08/20 14:25:17.041668 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 10 AdvanceApply with 6
2021/08/20 14:25:17.041669 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 11 send 1 msgs
2021/08/20 14:25:17.041729 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 12 send 1 msgs
2021/08/20 14:25:17.041781 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 11 AdvanceApply with 6
2021/08/20 14:25:17.041799 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 12 AdvanceApply with 6
2021/08/20 14:25:17.124033 [info] [raftstore]: shard 9 start split check job from [122 0 0 0 0 0 0 0 0 107 101 121 50] to [122 0 0 0 0 0 0 0 1]
2021/08/20 14:25:17.133151 [error] prophet: client read resp from leader 127.0.0.1:30000 failed with read tcp 127.0.0.1:38484->127.0.0.1:30000: use of closed network connection
2021/08/20 14:25:17.133169 [error] prophet: client read loop stopped
2021/08/20 14:25:17.133182 [error] prophet: client read resp from leader 127.0.0.1:30000 failed with EOF
2021/08/20 14:25:17.133183 [error] prophet: session 5[127.0.0.1:38582] read failed with read tcp 127.0.0.1:30000->127.0.0.1:38582: use of closed network connection
2021/08/20 14:25:17.133203 [error] prophet: session 2[127.0.0.1:38486] read failed with read tcp 127.0.0.1:30000->127.0.0.1:38486: use of closed network connection
2021/08/20 14:25:17.133204 [error] prophet: session 4[127.0.0.1:38518] read failed with read tcp 127.0.0.1:30000->127.0.0.1:38518: use of closed network connection
2021/08/20 14:25:17.133209 [error] prophet: watcher read events failed with EOF
2021/08/20 14:25:17.133221 [error] prophet: reset watcher conn failed with <nil>, retry later
2021/08/20 14:25:17.133221 [error] prophet: watcher read events failed with EOF
2021/08/20 14:25:17.133223 [error] prophet: reset watcher conn failed with <nil>, retry later
2021/08/20 14:25:17.133204 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:17.133249 [error] prophet: session 6[127.0.0.1:38584] read failed with read tcp 127.0.0.1:30000->127.0.0.1:38584: use of closed network connection
2021/08/20 14:25:17.133263 [error] prophet: session 3[127.0.0.1:38516] read failed with read tcp 127.0.0.1:30000->127.0.0.1:38516: use of closed network connection
2021/08/20 14:25:17.133278 [error] prophet: client read resp from leader 127.0.0.1:30000 failed with EOF
2021/08/20 14:25:17.133265 [error] prophet: watcher read events failed with EOF
2021/08/20 14:25:17.133306 [error] prophet: reset watcher conn failed with <nil>, retry later
2021/08/20 14:25:17.133291 [error] prophet: init leader conn failed with dial tcp 127.0.0.1:30000: connect: connection refused, retry later
2021/08/20 14:25:17.133338 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:17.133424 [error] prophet: init leader conn failed with dial tcp 127.0.0.1:30000: connect: connection refused, retry later
2021/08/20 14:25:17.134263 [info] prophet: [prophet-leader/node-0]/lease: closed
2021/08/20 14:25:17.134294 [info] prophet: patrol resources has been stopped 
2021/08/20 14:25:17.134618 [info] prophet: [prophet-leader/node-0]/keepalive: exit with context done
2021/08/20 14:25:17.134644 [info] prophet: drive push operator has been stopped 
2021/08/20 14:25:17.134648 [info] prophet: coordinator is stopping
2021/08/20 14:25:17.134650 [info] prophet: coordinator has been stopped
2021/08/20 14:25:17.134710 [info] prophet: [prophet-leader/node-0]/lease: exit with context done
2021/08/20 14:25:17.134787 [error] prophet: [prophet-leader/node-0]/lease: keep lease exit
2021/08/20 14:25:17.134883 [info] prophet: [prophet-leader/node-1]/watch: leader deleted
2021/08/20 14:25:17.134955 [info] prophet: [prophet-leader/node-1]/loop: leader 涕Ӷnode-0127.0.0.1:30000 was out
2021/08/20 14:25:17.135065 [info] prophet: [prophet-leader/node-2]/watch: leader deleted
2021-08-20 14:25:17.134953 I | etcdserver: 93ccda9956d988f4 starts leadership transfer from 93ccda9956d988f4 to b1840f1134a12fe0
2021/08/20 14:25:17.135148 [info] prophet: [prophet-leader/node-2]/loop: leader 涕Ӷnode-0127.0.0.1:30000 was out
{"level":"info","ts":"2021-08-20T14:25:17.135+0800","caller":"raft/raft.go:1278","msg":"93ccda9956d988f4 [term 2] starts to transfer leadership to b1840f1134a12fe0"}
{"level":"info","ts":"2021-08-20T14:25:17.135+0800","caller":"raft/raft.go:1284","msg":"93ccda9956d988f4 sends MsgTimeoutNow to b1840f1134a12fe0 immediately as b1840f1134a12fe0 already has up-to-date log"}
{"level":"info","ts":"2021-08-20T14:25:17.135+0800","caller":"raft/raft.go:1372","msg":"b1840f1134a12fe0 [term 2] received MsgTimeoutNow from 93ccda9956d988f4 and starts an election to get leadership."}
{"level":"info","ts":"2021-08-20T14:25:17.135+0800","caller":"raft/raft.go:724","msg":"b1840f1134a12fe0 became candidate at term 3"}
{"level":"info","ts":"2021-08-20T14:25:17.135+0800","caller":"raft/raft.go:835","msg":"b1840f1134a12fe0 received MsgVoteResp from b1840f1134a12fe0 at term 3"}
{"level":"info","ts":"2021-08-20T14:25:17.135+0800","caller":"raft/raft.go:822","msg":"b1840f1134a12fe0 [logterm: 2, index: 32] sent MsgVote request to 6b1ace49a9f387c8 at term 3"}
{"level":"info","ts":"2021-08-20T14:25:17.135+0800","caller":"raft/raft.go:822","msg":"b1840f1134a12fe0 [logterm: 2, index: 32] sent MsgVote request to 93ccda9956d988f4 at term 3"}
{"level":"info","ts":"2021-08-20T14:25:17.135+0800","caller":"raft/node.go:331","msg":"raft.node: b1840f1134a12fe0 lost leader 93ccda9956d988f4 at term 3"}
{"level":"info","ts":"2021-08-20T14:25:17.136+0800","caller":"raft/raft.go:870","msg":"6b1ace49a9f387c8 [term: 2] received a MsgVote message with higher term from b1840f1134a12fe0 [term: 3]"}
{"level":"info","ts":"2021-08-20T14:25:17.136+0800","caller":"raft/raft.go:711","msg":"6b1ace49a9f387c8 became follower at term 3"}
{"level":"info","ts":"2021-08-20T14:25:17.136+0800","caller":"raft/raft.go:971","msg":"6b1ace49a9f387c8 [logterm: 2, index: 32, vote: 0] cast MsgVote for b1840f1134a12fe0 [logterm: 2, index: 32] at term 3"}
{"level":"info","ts":"2021-08-20T14:25:17.136+0800","caller":"raft/node.go:331","msg":"raft.node: 6b1ace49a9f387c8 lost leader 93ccda9956d988f4 at term 3"}
{"level":"info","ts":"2021-08-20T14:25:17.136+0800","caller":"raft/raft.go:870","msg":"93ccda9956d988f4 [term: 2] received a MsgVote message with higher term from b1840f1134a12fe0 [term: 3]"}
{"level":"info","ts":"2021-08-20T14:25:17.136+0800","caller":"raft/raft.go:711","msg":"93ccda9956d988f4 became follower at term 3"}
{"level":"info","ts":"2021-08-20T14:25:17.136+0800","caller":"raft/raft.go:971","msg":"93ccda9956d988f4 [logterm: 2, index: 32, vote: 0] cast MsgVote for b1840f1134a12fe0 [logterm: 2, index: 32] at term 3"}
{"level":"info","ts":"2021-08-20T14:25:17.136+0800","caller":"raft/node.go:331","msg":"raft.node: 93ccda9956d988f4 lost leader 93ccda9956d988f4 at term 3"}
{"level":"info","ts":"2021-08-20T14:25:17.137+0800","caller":"raft/raft.go:835","msg":"b1840f1134a12fe0 received MsgVoteResp from 93ccda9956d988f4 at term 3"}
{"level":"info","ts":"2021-08-20T14:25:17.137+0800","caller":"raft/raft.go:1319","msg":"b1840f1134a12fe0 has received 2 MsgVoteResp votes and 0 vote rejections"}
{"level":"info","ts":"2021-08-20T14:25:17.137+0800","caller":"raft/raft.go:776","msg":"b1840f1134a12fe0 became leader at term 3"}
{"level":"info","ts":"2021-08-20T14:25:17.137+0800","caller":"raft/node.go:325","msg":"raft.node: b1840f1134a12fe0 elected leader b1840f1134a12fe0 at term 3"}
{"level":"info","ts":"2021-08-20T14:25:17.137+0800","caller":"raft/node.go:325","msg":"raft.node: 6b1ace49a9f387c8 elected leader b1840f1134a12fe0 at term 3"}
{"level":"info","ts":"2021-08-20T14:25:17.137+0800","caller":"raft/node.go:325","msg":"raft.node: 93ccda9956d988f4 elected leader b1840f1134a12fe0 at term 3"}
{"level":"warn","ts":"2021-08-20T14:25:17.137+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-3a2f8f6a-9b8d-4fcc-94db-ea9e943b7f0c/127.0.0.1:40001","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: leader changed"}
{"level":"warn","ts":"2021-08-20T14:25:17.137+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-ed4c2696-2523-4d6f-931e-f49c7d686279/127.0.0.1:40002","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: leader changed"}
2021/08/20 14:25:17.162560 [info] prophet: [prophet-leader/node-1]/campaign: load expect leader: []
2021/08/20 14:25:17.162571 [info] prophet: [prophet-leader/node-1]/campaign: start
2021/08/20 14:25:17.163466 [info] prophet: [prophet-leader/node-1]/campaign: grant lease ok
2021/08/20 14:25:17.164640 [info] prophet: [prophet-leader/node-1]/campaign: completed, start keepalive
2021/08/20 14:25:17.164660 [info] prophet: ********node-1 become to leader now********
2021/08/20 14:25:17.164870 [info] prophet: [prophet-leader/node-2]/campaign: load expect leader: []
2021/08/20 14:25:17.164883 [info] prophet: [prophet-leader/node-2]/campaign: start
2021/08/20 14:25:17.165805 [info] prophet: [prophet-leader/node-2]/campaign: grant lease ok
2021/08/20 14:25:17.167870 [info] prophet: [prophet-leader/node-2]/lease: closed
2021/08/20 14:25:17.167884 [error] prophet: [prophet-leader/node-2]/loop: campaign leader failed with campaign leader failed, other server may campaign ok
2021/08/20 14:25:17.168327 [info] prophet: load 3 containers, cost 3.5574ms
2021/08/20 14:25:17.168585 [info] prophet: load 2 resources, cost 244.9µs
2021/08/20 14:25:17.169013 [info] [raftstore]: *********Become prophet leader*********
2021/08/20 14:25:17.169020 [info] prophet: coordinator starts to collect cluster information 
2021/08/20 14:25:17.169285 [info] prophet: load 0 jobs
2021/08/20 14:25:17.173689 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:17.173696 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 8 send 1 msgs
2021/08/20 14:25:17.223961 [error] [raftstore]: shard 2 heartbeat to prophet failed with client is closed
2021/08/20 14:25:17.224017 [error] [raftstore]: shard 9 heartbeat to prophet failed with client is closed
2021/08/20 14:25:17.224061 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 12 send 1 msgs
2021/08/20 14:25:17.224078 [error] [raftstore]: >>>>>>>>>>>> shard 9 peer 11 send 1 msgs
2021/08/20 14:25:17.234807 [info] prophet: [prophet-leader/node-0]/loop: exit
2021-08-20 14:25:17.235887 I | etcdserver: 93ccda9956d988f4 finished leadership transfer from 93ccda9956d988f4 to b1840f1134a12fe0 (took 100.9347ms)
2021-08-20 14:25:17.235932 I | rafthttp: stopping peer b1840f1134a12fe0...
2021-08-20 14:25:17.236093 W | rafthttp: lost the TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:17.236163 I | rafthttp: closed the TCP streaming connection with peer b1840f1134a12fe0 (stream MsgApp v2 writer)
2021-08-20 14:25:17.236175 I | rafthttp: stopped streaming with peer b1840f1134a12fe0 (writer)
2021-08-20 14:25:17.236298 W | rafthttp: lost the TCP streaming connection with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:17.236311 I | rafthttp: closed the TCP streaming connection with peer b1840f1134a12fe0 (stream Message writer)
2021-08-20 14:25:17.236314 I | rafthttp: stopped streaming with peer b1840f1134a12fe0 (writer)
2021-08-20 14:25:17.236321 I | rafthttp: stopped HTTP pipelining with peer b1840f1134a12fe0
2021-08-20 14:25:17.236353 W | rafthttp: lost the TCP streaming connection with peer b1840f1134a12fe0 (stream MsgApp v2 reader)
2021-08-20 14:25:17.236363 E | rafthttp: failed to read b1840f1134a12fe0 on stream MsgApp v2 (context canceled)
2021-08-20 14:25:17.236365 I | rafthttp: peer b1840f1134a12fe0 became inactive (message send to peer failed)
2021-08-20 14:25:17.236372 I | rafthttp: stopped streaming with peer b1840f1134a12fe0 (stream MsgApp v2 reader)
2021-08-20 14:25:17.236410 W | rafthttp: lost the TCP streaming connection with peer b1840f1134a12fe0 (stream Message reader)
2021-08-20 14:25:17.236422 I | rafthttp: stopped streaming with peer b1840f1134a12fe0 (stream Message reader)
2021-08-20 14:25:17.236424 I | rafthttp: stopped peer b1840f1134a12fe0
2021-08-20 14:25:17.236426 I | rafthttp: stopping peer 6b1ace49a9f387c8...
2021-08-20 14:25:17.236567 W | rafthttp: lost the TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:17.236890 I | rafthttp: closed the TCP streaming connection with peer 6b1ace49a9f387c8 (stream MsgApp v2 writer)
2021-08-20 14:25:17.236903 I | rafthttp: stopped streaming with peer 6b1ace49a9f387c8 (writer)
2021-08-20 14:25:17.236985 I | rafthttp: closed the TCP streaming connection with peer 6b1ace49a9f387c8 (stream Message writer)
2021-08-20 14:25:17.236995 I | rafthttp: stopped streaming with peer 6b1ace49a9f387c8 (writer)
2021-08-20 14:25:17.237014 I | rafthttp: stopped HTTP pipelining with peer 6b1ace49a9f387c8
2021-08-20 14:25:17.237057 W | rafthttp: lost the TCP streaming connection with peer 6b1ace49a9f387c8 (stream MsgApp v2 reader)
2021-08-20 14:25:17.237072 E | rafthttp: failed to read 6b1ace49a9f387c8 on stream MsgApp v2 (context canceled)
2021-08-20 14:25:17.237075 I | rafthttp: peer 6b1ace49a9f387c8 became inactive (message send to peer failed)
2021-08-20 14:25:17.237081 I | rafthttp: stopped streaming with peer 6b1ace49a9f387c8 (stream MsgApp v2 reader)
2021-08-20 14:25:17.237100 W | rafthttp: lost the TCP streaming connection with peer 6b1ace49a9f387c8 (stream Message reader)
2021-08-20 14:25:17.237118 I | rafthttp: stopped streaming with peer 6b1ace49a9f387c8 (stream Message reader)
2021-08-20 14:25:17.237121 I | rafthttp: stopped peer 6b1ace49a9f387c8
2021-08-20 14:25:17.237162 W | rafthttp: lost the TCP streaming connection with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:17.237206 E | rafthttp: failed to find member b1840f1134a12fe0 in cluster 6a4ade671189dc2f
2021-08-20 14:25:17.237226 E | rafthttp: failed to find member b1840f1134a12fe0 in cluster 6a4ade671189dc2f
2021-08-20 14:25:17.237263 E | rafthttp: failed to find member 6b1ace49a9f387c8 in cluster 6a4ade671189dc2f
2021-08-20 14:25:17.237317 E | rafthttp: failed to dial 93ccda9956d988f4 on stream MsgApp v2 (peer 93ccda9956d988f4 failed to find local node b1840f1134a12fe0)
2021-08-20 14:25:17.237331 I | rafthttp: peer 93ccda9956d988f4 became inactive (message send to peer failed)
2021-08-20 14:25:17.237352 E | rafthttp: failed to find member 6b1ace49a9f387c8 in cluster 6a4ade671189dc2f
2021-08-20 14:25:17.237374 E | rafthttp: failed to dial 93ccda9956d988f4 on stream MsgApp v2 (peer 93ccda9956d988f4 failed to find local node 6b1ace49a9f387c8)
2021-08-20 14:25:17.237392 I | rafthttp: peer 93ccda9956d988f4 became inactive (message send to peer failed)
2021/08/20 14:25:17.240677 [info] [raftstore]: shard 2 handle serve raft stopped
2021/08/20 14:25:17.240689 [info] [raftstore]: shard 9 handle serve raft stopped
2021/08/20 14:25:17.240705 [info] [raftstore]: handle resource heartbeat resp task stopped
2021/08/20 14:25:17.240709 [info] [raftstore]: timer based tasks stopped
2021/08/20 14:25:17.240711 [info] [raftstore]: router event loop task stopped
2021/08/20 14:25:17.240714 [info] [raftstore]: raft worker worker 0/0 exit
2021/08/20 14:25:17.240747 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:17.240759 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:17.240759 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:17.240761 [info] [transport]: send raft worker stopped
2021/08/20 14:25:17.240763 [info] [transport]: transfer stopped
2021/08/20 14:25:17.240760 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:17.240775 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:17.240776 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:17.240778 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:17.240780 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:17.240795 [error] [transport]: session 2[127.0.0.1:36160] read failed with read tcp 127.0.0.1:10000->127.0.0.1:36160: use of closed network connection
2021/08/20 14:25:17.240801 [error] [transport]: session 1[127.0.0.1:36090] read failed with read tcp 127.0.0.1:10000->127.0.0.1:36090: use of closed network connection
2021/08/20 14:25:17.242023 [info] prophet: [prophet-leader/node-1]/lease: closed
2021/08/20 14:25:17.242043 [info] prophet: coordinator stops running 
2021/08/20 14:25:17.242047 [info] prophet: coordinator is stopping
2021/08/20 14:25:17.242048 [info] prophet: coordinator has been stopped
2021/08/20 14:25:17.242051 [info] prophet: [prophet-leader/node-1]/keepalive: exit with context done
2021/08/20 14:25:17.242063 [error] prophet: [prophet-leader/node-1]/lease: keep lease exit
2021/08/20 14:25:17.242064 [info] prophet: [prophet-leader/node-1]/lease: exit with context done
2021-08-20 14:25:17.242107 I | etcdserver: b1840f1134a12fe0 starts leadership transfer from b1840f1134a12fe0 to 6b1ace49a9f387c8
{"level":"info","ts":"2021-08-20T14:25:17.242+0800","caller":"raft/raft.go:1278","msg":"b1840f1134a12fe0 [term 3] starts to transfer leadership to 6b1ace49a9f387c8"}
{"level":"info","ts":"2021-08-20T14:25:17.242+0800","caller":"raft/raft.go:1284","msg":"b1840f1134a12fe0 sends MsgTimeoutNow to 6b1ace49a9f387c8 immediately as 6b1ace49a9f387c8 already has up-to-date log"}
{"level":"info","ts":"2021-08-20T14:25:17.242+0800","caller":"raft/raft.go:1372","msg":"6b1ace49a9f387c8 [term 3] received MsgTimeoutNow from b1840f1134a12fe0 and starts an election to get leadership."}
{"level":"info","ts":"2021-08-20T14:25:17.242+0800","caller":"raft/raft.go:724","msg":"6b1ace49a9f387c8 became candidate at term 4"}
{"level":"info","ts":"2021-08-20T14:25:17.242+0800","caller":"raft/raft.go:835","msg":"6b1ace49a9f387c8 received MsgVoteResp from 6b1ace49a9f387c8 at term 4"}
{"level":"info","ts":"2021-08-20T14:25:17.242+0800","caller":"raft/raft.go:822","msg":"6b1ace49a9f387c8 [logterm: 3, index: 39] sent MsgVote request to 93ccda9956d988f4 at term 4"}
{"level":"info","ts":"2021-08-20T14:25:17.242+0800","caller":"raft/raft.go:822","msg":"6b1ace49a9f387c8 [logterm: 3, index: 39] sent MsgVote request to b1840f1134a12fe0 at term 4"}
{"level":"info","ts":"2021-08-20T14:25:17.242+0800","caller":"raft/node.go:331","msg":"raft.node: 6b1ace49a9f387c8 lost leader b1840f1134a12fe0 at term 4"}
{"level":"info","ts":"2021-08-20T14:25:17.242+0800","caller":"raft/raft.go:870","msg":"b1840f1134a12fe0 [term: 3] received a MsgVote message with higher term from 6b1ace49a9f387c8 [term: 4]"}
{"level":"info","ts":"2021-08-20T14:25:17.242+0800","caller":"raft/raft.go:711","msg":"b1840f1134a12fe0 became follower at term 4"}
{"level":"info","ts":"2021-08-20T14:25:17.242+0800","caller":"raft/raft.go:971","msg":"b1840f1134a12fe0 [logterm: 3, index: 39, vote: 0] cast MsgVote for 6b1ace49a9f387c8 [logterm: 3, index: 39] at term 4"}
{"level":"info","ts":"2021-08-20T14:25:17.242+0800","caller":"raft/node.go:331","msg":"raft.node: b1840f1134a12fe0 lost leader b1840f1134a12fe0 at term 4"}
{"level":"info","ts":"2021-08-20T14:25:17.243+0800","caller":"raft/raft.go:835","msg":"6b1ace49a9f387c8 received MsgVoteResp from b1840f1134a12fe0 at term 4"}
{"level":"info","ts":"2021-08-20T14:25:17.243+0800","caller":"raft/raft.go:1319","msg":"6b1ace49a9f387c8 has received 2 MsgVoteResp votes and 0 vote rejections"}
{"level":"info","ts":"2021-08-20T14:25:17.243+0800","caller":"raft/raft.go:776","msg":"6b1ace49a9f387c8 became leader at term 4"}
{"level":"info","ts":"2021-08-20T14:25:17.243+0800","caller":"raft/node.go:325","msg":"raft.node: 6b1ace49a9f387c8 elected leader 6b1ace49a9f387c8 at term 4"}
{"level":"info","ts":"2021-08-20T14:25:17.243+0800","caller":"raft/node.go:325","msg":"raft.node: b1840f1134a12fe0 elected leader 6b1ace49a9f387c8 at term 4"}
2021/08/20 14:25:17.273615 [info] [raftstore]: shard 2 raft tick stopped
2021/08/20 14:25:17.323465 [info] [raftstore]: shard 9 raft tick stopped
2021/08/20 14:25:17.333892 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:17.333915 [error] prophet: reset leader connection failed with client is closed
2021/08/20 14:25:17.333989 [error] prophet: client read loop stopped
2021/08/20 14:25:17.334018 [error] prophet: init leader conn failed with dial tcp 127.0.0.1:30000: connect: connection refused, retry later
2021/08/20 14:25:17.342489 [info] prophet: [prophet-leader/node-1]/loop: exit
2021-08-20 14:25:17.342506 I | etcdserver: b1840f1134a12fe0 finished leadership transfer from b1840f1134a12fe0 to 6b1ace49a9f387c8 (took 100.3955ms)
2021-08-20 14:25:17.342552 I | rafthttp: stopped HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:17.342566 I | rafthttp: stopping peer 93ccda9956d988f4...
2021-08-20 14:25:17.342660 I | rafthttp: closed the TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 writer)
2021-08-20 14:25:17.342671 I | rafthttp: stopped streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:17.342760 I | rafthttp: closed the TCP streaming connection with peer 93ccda9956d988f4 (stream Message writer)
2021-08-20 14:25:17.342772 I | rafthttp: stopped streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:17.342796 I | rafthttp: stopped HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:17.342823 I | rafthttp: stopped streaming with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:17.342828 I | rafthttp: stopped streaming with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:17.342831 I | rafthttp: stopped peer 93ccda9956d988f4
2021-08-20 14:25:17.342833 I | rafthttp: stopping peer 6b1ace49a9f387c8...
2021-08-20 14:25:17.342913 I | rafthttp: closed the TCP streaming connection with peer 6b1ace49a9f387c8 (stream MsgApp v2 writer)
2021-08-20 14:25:17.342927 I | rafthttp: stopped streaming with peer 6b1ace49a9f387c8 (writer)
2021-08-20 14:25:17.343013 I | rafthttp: closed the TCP streaming connection with peer 6b1ace49a9f387c8 (stream Message writer)
2021-08-20 14:25:17.343023 I | rafthttp: stopped streaming with peer 6b1ace49a9f387c8 (writer)
2021-08-20 14:25:17.343051 I | rafthttp: stopped HTTP pipelining with peer 6b1ace49a9f387c8
2021-08-20 14:25:17.343075 W | rafthttp: lost the TCP streaming connection with peer b1840f1134a12fe0 (stream MsgApp v2 reader)
2021-08-20 14:25:17.343102 W | rafthttp: lost the TCP streaming connection with peer b1840f1134a12fe0 (stream Message reader)
2021-08-20 14:25:17.343160 W | rafthttp: lost the TCP streaming connection with peer 6b1ace49a9f387c8 (stream MsgApp v2 reader)
2021-08-20 14:25:17.343186 E | rafthttp: failed to read 6b1ace49a9f387c8 on stream MsgApp v2 (context canceled)
2021-08-20 14:25:17.343190 I | rafthttp: peer 6b1ace49a9f387c8 became inactive (message send to peer failed)
2021-08-20 14:25:17.343206 I | rafthttp: stopped streaming with peer 6b1ace49a9f387c8 (stream MsgApp v2 reader)
2021-08-20 14:25:17.343266 W | rafthttp: lost the TCP streaming connection with peer 6b1ace49a9f387c8 (stream Message reader)
2021-08-20 14:25:17.343281 I | rafthttp: stopped streaming with peer 6b1ace49a9f387c8 (stream Message reader)
2021-08-20 14:25:17.343286 I | rafthttp: stopped peer 6b1ace49a9f387c8
2021-08-20 14:25:17.343325 E | rafthttp: failed to find member 6b1ace49a9f387c8 in cluster 6a4ade671189dc2f
2021-08-20 14:25:17.343393 E | rafthttp: failed to find member 6b1ace49a9f387c8 in cluster 6a4ade671189dc2f
2021-08-20 14:25:17.343426 E | rafthttp: failed to dial b1840f1134a12fe0 on stream MsgApp v2 (peer b1840f1134a12fe0 failed to find local node 6b1ace49a9f387c8)
2021-08-20 14:25:17.343439 I | rafthttp: peer b1840f1134a12fe0 became inactive (message send to peer failed)
2021/08/20 14:25:17.352892 [info] [raftstore]: shard 2 handle serve raft stopped
2021/08/20 14:25:17.352905 [info] [raftstore]: shard 9 handle serve raft stopped
2021/08/20 14:25:17.352924 [info] [raftstore]: handle resource heartbeat resp task stopped
2021/08/20 14:25:17.352929 [info] [raftstore]: timer based tasks stopped
2021/08/20 14:25:17.352930 [info] [raftstore]: router event loop task stopped
2021/08/20 14:25:17.352933 [info] [raftstore]: raft worker worker 0/0 exit
2021/08/20 14:25:17.352964 [info] [transport]: transfer stopped
2021/08/20 14:25:17.353001 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:17.353023 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:17.353040 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:17.353045 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:17.353049 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:17.353052 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:17.353057 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:17.353059 [error] [transport]: session 2[127.0.0.1:58410] read failed with read tcp 127.0.0.1:10001->127.0.0.1:58410: use of closed network connection
2021/08/20 14:25:17.353060 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:17.353057 [info] [transport]: send raft worker stopped
2021/08/20 14:25:17.353060 [error] [transport]: session 1[127.0.0.1:58404] read failed with read tcp 127.0.0.1:10001->127.0.0.1:58404: use of closed network connection
2021/08/20 14:25:17.424158 [info] [raftstore]: shard 2 raft tick stopped
2021/08/20 14:25:17.424199 [info] [raftstore]: shard 9 raft tick stopped
2021-08-20 14:25:17.447409 W | rafthttp: lost the TCP streaming connection with peer 93ccda9956d988f4 (stream Message writer)
2021/08/20 14:25:17.534062 [error] prophet: reset leader connection failed with client is closed
2021/08/20 14:25:17.534130 [error] prophet: client read loop stopped
2021-08-20 14:25:17.548014 W | rafthttp: failed to process raft message (raft: stopped)
2021-08-20 14:25:17.648118 W | rafthttp: lost the TCP streaming connection with peer b1840f1134a12fe0 (stream Message writer)
2021-08-20 14:25:17.648145 W | rafthttp: failed to process raft message (raft: stopped)
2021/08/20 14:25:17.774240 [error] [transport]: session 1[127.0.0.1:40862] read failed with read tcp 127.0.0.1:10002->127.0.0.1:40862: i/o timeout
2021/08/20 14:25:17.818550 [error] [raftstore]: send store heartbeat failed with client is closed
2021/08/20 14:25:17.824683 [error] [transport]: session 2[127.0.0.1:40866] read failed with read tcp 127.0.0.1:10002->127.0.0.1:40866: i/o timeout
{"level":"warn","ts":"2021-08-20T14:25:18.353+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-ed4c2696-2523-4d6f-931e-f49c7d686279/127.0.0.1:40002","attempt":0,"error":"rpc error: code = DeadlineExceeded desc = context deadline exceeded"}
2021/08/20 14:25:18.353618 [info] prophet: [prophet-leader/node-2]/lease: close failed with context deadline exceeded
2021-08-20 14:25:18.353723 W | etcdserver: 6b1ace49a9f387c8 failed to transfer leadership (etcdserver: unhealthy cluster)
2021-08-20 14:25:18.353766 I | rafthttp: stopped HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:18.353778 I | rafthttp: stopped HTTP pipelining with peer b1840f1134a12fe0
2021-08-20 14:25:18.353792 I | rafthttp: stopping peer 93ccda9956d988f4...
2021-08-20 14:25:18.353901 I | rafthttp: closed the TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 writer)
2021-08-20 14:25:18.353915 I | rafthttp: stopped streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:18.353928 I | rafthttp: stopped streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:18.353938 I | rafthttp: stopped HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:18.353942 I | rafthttp: stopped streaming with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:18.353946 I | rafthttp: stopped streaming with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:18.353950 I | rafthttp: stopped peer 93ccda9956d988f4
2021-08-20 14:25:18.353951 I | rafthttp: stopping peer b1840f1134a12fe0...
2021-08-20 14:25:18.354029 I | rafthttp: closed the TCP streaming connection with peer b1840f1134a12fe0 (stream MsgApp v2 writer)
2021-08-20 14:25:18.354041 I | rafthttp: stopped streaming with peer b1840f1134a12fe0 (writer)
2021-08-20 14:25:18.354045 I | rafthttp: stopped streaming with peer b1840f1134a12fe0 (writer)
2021-08-20 14:25:18.354067 I | rafthttp: stopped HTTP pipelining with peer b1840f1134a12fe0
2021-08-20 14:25:18.354075 I | rafthttp: stopped streaming with peer b1840f1134a12fe0 (stream MsgApp v2 reader)
2021-08-20 14:25:18.354079 I | rafthttp: stopped streaming with peer b1840f1134a12fe0 (stream Message reader)
2021-08-20 14:25:18.354083 I | rafthttp: stopped peer b1840f1134a12fe0
2021/08/20 14:25:18.358889 [info] [raftstore]: shard 2 handle serve raft stopped
2021/08/20 14:25:18.358905 [info] [raftstore]: shard 9 handle serve raft stopped
2021/08/20 14:25:18.358922 [info] [raftstore]: router event loop task stopped
2021/08/20 14:25:18.358927 [info] [raftstore]: handle resource heartbeat resp task stopped
2021/08/20 14:25:18.358930 [info] [raftstore]: raft worker worker 0/0 exit
2021/08/20 14:25:18.358938 [info] [raftstore]: timer based tasks stopped
2021/08/20 14:25:18.358979 [info] [transport]: transfer stopped
2021/08/20 14:25:18.358991 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:18.358999 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:18.359000 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:18.359005 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:18.358992 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:18.358987 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:18.358988 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:18.358980 [info] [transport]: send snapshot worker stopped
--- PASS: TestSyncData (7.55s)
2021/08/20 14:25:18.359027 [info] [transport]: send raft worker stopped
=== RUN   TestIssue90
2021/08/20 14:25:18.359781 [info] prophet: prophet logger set
2021/08/20 14:25:18.360262 [info] [raftstore]: start scan gc snap files
2021/08/20 14:25:18.360488 [info] [raftstore]: start scan gc snap files
2021/08/20 14:25:18.360670 [info] [raftstore]: start scan gc snap files
2021/08/20 14:25:18.360681 [info] [raftstore]: begin start raftstore
2021/08/20 14:25:18.360684 [info] [raftstore]: begin to start prophet
[WARNING] Deprecated '--logger=capnslog' flag is set; use '--logger=zap' flag instead
2021-08-20 14:25:18.360735 I | embed: pprof is enabled under /debug/pprof
2021-08-20 14:25:18.360768 I | embed: name = node-0
2021-08-20 14:25:18.360779 I | embed: data dir = /tmp/cube/node-0/prophet
2021-08-20 14:25:18.360781 I | embed: member dir = /tmp/cube/node-0/prophet/member
2021-08-20 14:25:18.360782 I | embed: heartbeat = 100ms
2021-08-20 14:25:18.360784 I | embed: election = 3000ms
2021-08-20 14:25:18.360785 I | embed: snapshot count = 100000
2021-08-20 14:25:18.360788 I | embed: advertise client URLs = http://127.0.0.1:40000
2021-08-20 14:25:18.365162 I | etcdserver: starting member 93ccda9956d988f4 in cluster 6a4ade671189dc2f
{"level":"info","ts":"2021-08-20T14:25:18.365+0800","caller":"raft/raft.go:1550","msg":"93ccda9956d988f4 switched to configuration voters=()"}
{"level":"info","ts":"2021-08-20T14:25:18.365+0800","caller":"raft/raft.go:711","msg":"93ccda9956d988f4 became follower at term 0"}
{"level":"info","ts":"2021-08-20T14:25:18.365+0800","caller":"raft/raft.go:388","msg":"newRaft 93ccda9956d988f4 [peers: [], term: 0, commit: 0, applied: 0, lastindex: 0, lastterm: 0]"}
{"level":"info","ts":"2021-08-20T14:25:18.365+0800","caller":"raft/raft.go:711","msg":"93ccda9956d988f4 became follower at term 1"}
{"level":"info","ts":"2021-08-20T14:25:18.365+0800","caller":"raft/raft.go:1550","msg":"93ccda9956d988f4 switched to configuration voters=(10650127570946328820)"}
2021-08-20 14:25:18.366919 W | auth: simple token is not cryptographically signed
2021-08-20 14:25:18.369854 I | etcdserver: starting server... [version: 3.4.15, cluster version: to_be_decided]
2021-08-20 14:25:18.369999 I | etcdserver: 93ccda9956d988f4 as single-node; fast-forwarding 29 ticks (election ticks 30)
{"level":"info","ts":"2021-08-20T14:25:18.370+0800","caller":"raft/raft.go:1550","msg":"93ccda9956d988f4 switched to configuration voters=(10650127570946328820)"}
2021-08-20 14:25:18.370153 I | etcdserver/membership: added member 93ccda9956d988f4 [http://127.0.0.1:50000] to cluster 6a4ade671189dc2f
2021-08-20 14:25:18.370181 I | embed: listening for peers on 127.0.0.1:50000
2021/08/20 14:25:18.423716 [info] [raftstore]: shard 2 raft tick stopped
2021/08/20 14:25:18.423756 [info] [raftstore]: shard 9 raft tick stopped
2021/08/20 14:25:20.168104 [info] prophet: [prophet-leader/node-2]/loop: exit
{"level":"info","ts":"2021-08-20T14:25:20.965+0800","caller":"raft/raft.go:934","msg":"93ccda9956d988f4 is starting a new election at term 1"}
{"level":"info","ts":"2021-08-20T14:25:20.966+0800","caller":"raft/raft.go:724","msg":"93ccda9956d988f4 became candidate at term 2"}
{"level":"info","ts":"2021-08-20T14:25:20.966+0800","caller":"raft/raft.go:835","msg":"93ccda9956d988f4 received MsgVoteResp from 93ccda9956d988f4 at term 2"}
{"level":"info","ts":"2021-08-20T14:25:20.966+0800","caller":"raft/raft.go:776","msg":"93ccda9956d988f4 became leader at term 2"}
{"level":"info","ts":"2021-08-20T14:25:20.966+0800","caller":"raft/node.go:325","msg":"raft.node: 93ccda9956d988f4 elected leader 93ccda9956d988f4 at term 2"}
2021-08-20 14:25:20.966235 I | etcdserver: setting up the initial cluster version to 3.4
2021-08-20 14:25:20.966917 N | etcdserver/membership: set the initial cluster version to 3.4
2021-08-20 14:25:20.966942 I | etcdserver: published {Name:node-0 ClientURLs:[http://127.0.0.1:40000]} to cluster 6a4ade671189dc2f
2021-08-20 14:25:20.966949 I | embed: ready to serve client requests
2021/08/20 14:25:20.966965 [info] prophet: create etcd v3 client with endpoints [http://127.0.0.1:40000]
2021-08-20 14:25:20.967245 N | embed: serving insecure client requests on 127.0.0.1:40000, this is strongly discouraged!
2021/08/20 14:25:20.967988 [info] prophet: net application started
2021/08/20 14:25:20.968045 [info] prophet: start system time monitor 
2021/08/20 14:25:20.968362 [info] prophet: [prophet-leader/node-0]/loop: current leader is []
2021/08/20 14:25:20.968540 [info] prophet: [prophet-leader/node-0]/campaign: load expect leader: []
2021/08/20 14:25:20.968552 [info] prophet: [prophet-leader/node-0]/campaign: start
2021/08/20 14:25:20.968792 [info] prophet: [prophet-leader/node-0]/campaign: grant lease ok
2021/08/20 14:25:20.969214 [info] prophet: [prophet-leader/node-0]/campaign: completed, start keepalive
2021/08/20 14:25:20.969233 [info] prophet: ********node-0 become to leader now********
2021/08/20 14:25:20.969673 [info] prophet: load 0 containers, cost 389.9µs
2021/08/20 14:25:20.969873 [info] prophet: load 0 resources, cost 189.1µs
2021/08/20 14:25:20.970452 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:20.970486 [info] prophet: client started
2021/08/20 14:25:20.970487 [info] prophet: coordinator starts to collect cluster information 
2021/08/20 14:25:20.970491 [info] [raftstore]: *********Become prophet leader*********
2021/08/20 14:25:20.970491 [info] prophet: coordinator has finished cluster information preparation 
2021/08/20 14:25:20.970494 [info] prophet: coordinator starts to run schedulers 
2021/08/20 14:25:20.970501 [info] prophet: client read loop started 
2021/08/20 14:25:20.970493 [info] [raftstore]: begin to bootstrap the cluster
2021/08/20 14:25:20.970535 [info] prophet: session 1[127.0.0.1:38752] connected
2021/08/20 14:25:20.970543 [info] [raftstore]: raftstore init with store raftAddr:"127.0.0.1:10000" clientAddr:"127.0.0.1:20000" labels:<key:"c" value:"0" > startTime:1629440720 deployPath:"not set" 
2021/08/20 14:25:20.970551 [info] [raftstore]: begin to create local store metadata
2021/08/20 14:25:20.970555 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:20.970582 [info] prophet: client read loop actived, ready to read from leader
2021/08/20 14:25:20.970905 [info] prophet: load 0 jobs
2021/08/20 14:25:20.971100 [info] [raftstore]: create local store with id 1
2021/08/20 14:25:20.971631 [info] [raftstore]: the cluster already bootstrap: false
2021/08/20 14:25:20.971648 [info] [raftstore]: begin to bootstrap the cluster with init shards
2021/08/20 14:25:20.971670 [info] prophet: coordinator begins to actively drive push operator 
2021/08/20 14:25:20.971696 [info] prophet: coordinator starts patrol resources 
2021/08/20 14:25:20.971758 [info] [raftstore]: create init shard id:2 epoch:<confVer:1 version:1 > peers:<id:3 containerID:1 > 
2021/08/20 14:25:20.973714 [info] prophet: container 1 limit added
2021/08/20 14:25:20.973797 [info] [raftstore]: prophet started
2021/08/20 14:25:20.973832 [info] prophet: container 1 heartbeat stream binded
2021/08/20 14:25:20.973873 [info] [transport]: net application started
2021/08/20 14:25:20.973877 [info] [raftstore]: start listen at 127.0.0.1:10000 for raft
2021/08/20 14:25:20.973882 [info] [raftstore]: raft shards workers started
2021/08/20 14:25:20.973895 [info] [raftstore]: shard 2 init with raft local state {HardState:{Term:5 Vote:0 Commit:5 XXX_unrecognized:[]} LastIndex:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:20.973900 [info] [raftstore]: shard 2 init raft apply state, state=<{AppliedIndex:5 TruncatedState:{Index:5 Term:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:20.973909 [info] [raftstore]: shard 2 init last term, last term=<5>
{"level":"info","ts":"2021-08-20T14:25:20.973+0800","caller":"raft/raft.go:1550","msg":"3 switched to configuration voters=(3)"}
{"level":"info","ts":"2021-08-20T14:25:20.973+0800","caller":"raft/raft.go:711","msg":"3 became follower at term 5"}
{"level":"info","ts":"2021-08-20T14:25:20.973+0800","caller":"raft/raft.go:388","msg":"newRaft 3 [peers: [3], term: 5, commit: 5, applied: 5, lastindex: 5, lastterm: 5]"}
2021/08/20 14:25:20.973950 [info] [raftstore]: shard 2 try to campaign leader, because only self
{"level":"info","ts":"2021-08-20T14:25:20.973+0800","caller":"raft/raft.go:934","msg":"3 is starting a new election at term 5"}
{"level":"info","ts":"2021-08-20T14:25:20.973+0800","caller":"raft/raft.go:724","msg":"3 became candidate at term 6"}
2021/08/20 14:25:20.973959 [info] [raftstore]: raft worker 0/0 start
{"level":"info","ts":"2021-08-20T14:25:20.973+0800","caller":"raft/raft.go:835","msg":"3 received MsgVoteResp from 3 at term 6"}
{"level":"info","ts":"2021-08-20T14:25:20.973+0800","caller":"raft/raft.go:776","msg":"3 became leader at term 6"}
2021/08/20 14:25:20.974001 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 add registration job by startShards
2021/08/20 14:25:20.974021 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 add registration job by startShards, completed
2021/08/20 14:25:20.974041 [info] [raftstore]: shard 2 peer 3 raft 3 added, epoch {ConfVer:1 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:20.974050 [info] [raftstore]: starts with 1 shards, including 0 tombstones and 0 applying shards
2021/08/20 14:25:20.974051 [info] [raftstore]: cleanup possible garbage data complete
2021/08/20 14:25:20.974052 [info] [raftstore]: shards started
2021/08/20 14:25:20.974054 [info] [raftstore]: shard timer based tasks started
2021/08/20 14:25:20.974059 [info] [raftstore]: net application started
2021/08/20 14:25:20.974062 [info] [raftstore]: start listen at 127.0.0.1:20000 for client
2021/08/20 14:25:20.974067 [info] [raftstore]: router started
2021/08/20 14:25:20.974096 [info] [raftstore]: shard 2 ********become leader now********
2021/08/20 14:25:20.974104 [info] [raftstore]: router event loop task started
2021/08/20 14:25:20.974102 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:20.974127 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 6
2021/08/20 14:25:20.974162 [info] prophet: session 2[127.0.0.1:38754] connected
2021/08/20 14:25:20.974183 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:20.974185 [info] prophet: watcher init leader connection 127.0.0.1:30000 succeed
2021/08/20 14:25:20.974250 [info] prophet: new watcher 127.0.0.1:38754 added
2021/08/20 14:25:20.974325 [info] [raftstore]: start init event
2021/08/20 14:25:20.975754 [info] [raftstore]: begin start raftstore
2021/08/20 14:25:20.975770 [info] [raftstore]: begin to start prophet
{"level":"info","ts":"2021-08-20T14:25:20.976+0800","caller":"raft/raft.go:1550","msg":"93ccda9956d988f4 switched to configuration voters=(10650127570946328820 13550435519089516396)"}
2021-08-20 14:25:20.976365 I | etcdserver/membership: added member bc0cd14fb32a9f6c [http://127.0.0.1:50001] to cluster 6a4ade671189dc2f
2021-08-20 14:25:20.976379 I | rafthttp: starting peer bc0cd14fb32a9f6c...
2021-08-20 14:25:20.976406 I | rafthttp: started HTTP pipelining with peer bc0cd14fb32a9f6c
2021-08-20 14:25:20.976568 I | rafthttp: started streaming with peer bc0cd14fb32a9f6c (writer)
2021-08-20 14:25:20.976645 I | rafthttp: started streaming with peer bc0cd14fb32a9f6c (writer)
2021-08-20 14:25:20.976678 I | rafthttp: started peer bc0cd14fb32a9f6c
2021-08-20 14:25:20.976693 I | rafthttp: added peer bc0cd14fb32a9f6c
2021-08-20 14:25:20.976695 I | rafthttp: started streaming with peer bc0cd14fb32a9f6c (stream Message reader)
2021-08-20 14:25:20.976704 I | rafthttp: started streaming with peer bc0cd14fb32a9f6c (stream MsgApp v2 reader)
[WARNING] Deprecated '--logger=capnslog' flag is set; use '--logger=zap' flag instead
2021-08-20 14:25:20.977004 I | embed: pprof is enabled under /debug/pprof
2021-08-20 14:25:20.977029 I | embed: name = node-1
2021-08-20 14:25:20.977039 I | embed: data dir = /tmp/cube/node-1/prophet
2021-08-20 14:25:20.977041 I | embed: member dir = /tmp/cube/node-1/prophet/member
2021-08-20 14:25:20.977043 I | embed: heartbeat = 100ms
2021-08-20 14:25:20.977044 I | embed: election = 3000ms
2021-08-20 14:25:20.977045 I | embed: snapshot count = 100000
2021-08-20 14:25:20.977048 I | embed: advertise client URLs = http://127.0.0.1:40001
2021-08-20 14:25:20.981261 I | etcdserver: starting member bc0cd14fb32a9f6c in cluster 6a4ade671189dc2f
{"level":"info","ts":"2021-08-20T14:25:20.981+0800","caller":"raft/raft.go:1550","msg":"bc0cd14fb32a9f6c switched to configuration voters=()"}
{"level":"info","ts":"2021-08-20T14:25:20.981+0800","caller":"raft/raft.go:711","msg":"bc0cd14fb32a9f6c became follower at term 0"}
{"level":"info","ts":"2021-08-20T14:25:20.981+0800","caller":"raft/raft.go:388","msg":"newRaft bc0cd14fb32a9f6c [peers: [], term: 0, commit: 0, applied: 0, lastindex: 0, lastterm: 0]"}
2021-08-20 14:25:20.982958 W | auth: simple token is not cryptographically signed
2021-08-20 14:25:20.986019 I | rafthttp: started HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:20.986033 I | rafthttp: starting peer 93ccda9956d988f4...
2021-08-20 14:25:20.986039 I | rafthttp: started HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:20.986172 I | rafthttp: started streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:20.986248 I | rafthttp: started streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:20.986306 I | rafthttp: started peer 93ccda9956d988f4
2021-08-20 14:25:20.986319 I | rafthttp: added peer 93ccda9956d988f4
2021-08-20 14:25:20.986327 I | etcdserver: starting server... [version: 3.4.15, cluster version: to_be_decided]
2021-08-20 14:25:20.986330 I | rafthttp: started streaming with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:20.986347 I | rafthttp: started streaming with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:20.986532 I | rafthttp: peer 93ccda9956d988f4 became active
2021-08-20 14:25:20.986557 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:20.986565 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:20.986588 I | rafthttp: peer bc0cd14fb32a9f6c became active
2021-08-20 14:25:20.986619 I | embed: listening for peers on 127.0.0.1:50001
2021-08-20 14:25:20.986654 I | rafthttp: established a TCP streaming connection with peer bc0cd14fb32a9f6c (stream Message writer)
2021-08-20 14:25:20.986660 I | rafthttp: established a TCP streaming connection with peer bc0cd14fb32a9f6c (stream MsgApp v2 writer)
{"level":"info","ts":"2021-08-20T14:25:21.065+0800","caller":"raft/raft.go:870","msg":"bc0cd14fb32a9f6c [term: 0] received a MsgHeartbeat message with higher term from 93ccda9956d988f4 [term: 2]"}
{"level":"info","ts":"2021-08-20T14:25:21.065+0800","caller":"raft/raft.go:711","msg":"bc0cd14fb32a9f6c became follower at term 2"}
{"level":"info","ts":"2021-08-20T14:25:21.065+0800","caller":"raft/node.go:325","msg":"raft.node: bc0cd14fb32a9f6c elected leader 93ccda9956d988f4 at term 2"}
{"level":"info","ts":"2021-08-20T14:25:21.067+0800","caller":"raft/raft.go:1550","msg":"bc0cd14fb32a9f6c switched to configuration voters=(10650127570946328820)"}
2021-08-20 14:25:21.067490 I | etcdserver/membership: added member 93ccda9956d988f4 [http://127.0.0.1:50000] to cluster 6a4ade671189dc2f
2021-08-20 14:25:21.067530 N | etcdserver/membership: set the initial cluster version to 3.4
{"level":"info","ts":"2021-08-20T14:25:21.068+0800","caller":"raft/raft.go:1550","msg":"bc0cd14fb32a9f6c switched to configuration voters=(10650127570946328820 13550435519089516396)"}
2021-08-20 14:25:21.068363 I | etcdserver/membership: added member bc0cd14fb32a9f6c [http://127.0.0.1:50001] to cluster 6a4ade671189dc2f
2021-08-20 14:25:21.068654 I | etcdserver: published {Name:node-1 ClientURLs:[http://127.0.0.1:40001]} to cluster 6a4ade671189dc2f
2021-08-20 14:25:21.068686 I | embed: ready to serve client requests
2021/08/20 14:25:21.068702 [info] prophet: create etcd v3 client with endpoints [http://127.0.0.1:40001]
2021-08-20 14:25:21.068986 N | embed: serving insecure client requests on 127.0.0.1:40001, this is strongly discouraged!
2021/08/20 14:25:21.069783 [info] prophet: start system time monitor 
2021/08/20 14:25:21.069791 [info] prophet: net application started
2021/08/20 14:25:21.070365 [info] prophet: [prophet-leader/node-1]/loop: current leader is [涕Ӷnode-0127.0.0.1:30000]
2021/08/20 14:25:21.070378 [info] prophet: [prophet-leader/node-1]/loop: start watch leader 涕Ӷnode-0127.0.0.1:30000
2021/08/20 14:25:21.070380 [info] prophet: ********node-1 become to follower now********
2021/08/20 14:25:21.070402 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:21.070415 [info] prophet: client read loop started 
2021/08/20 14:25:21.070419 [info] prophet: client started
2021/08/20 14:25:21.070426 [info] [raftstore]: *********Become prophet follower*********
2021/08/20 14:25:21.070449 [info] [raftstore]: begin to bootstrap the cluster
2021/08/20 14:25:21.070470 [info] prophet: session 3[127.0.0.1:38784] connected
2021/08/20 14:25:21.070474 [info] [raftstore]: raftstore init with store raftAddr:"127.0.0.1:10001" clientAddr:"127.0.0.1:20001" labels:<key:"c" value:"1" > startTime:1629440721 deployPath:"not set" 
2021/08/20 14:25:21.070471 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:21.070476 [info] [raftstore]: begin to create local store metadata
2021/08/20 14:25:21.070478 [info] prophet: client read loop actived, ready to read from leader
2021/08/20 14:25:21.070581 [info] [raftstore]: create local store with id 5
2021/08/20 14:25:21.071304 [info] [raftstore]: the cluster already bootstrap: true
2021/08/20 14:25:21.075685 [info] prophet: container 5 limit added
2021/08/20 14:25:21.075747 [info] [raftstore]: prophet started
2021/08/20 14:25:21.075763 [info] prophet: container 5 heartbeat stream binded
2021/08/20 14:25:21.075784 [info] [transport]: net application started
2021/08/20 14:25:21.075794 [info] [raftstore]: start listen at 127.0.0.1:10001 for raft
2021/08/20 14:25:21.075797 [info] [raftstore]: raft shards workers started
2021/08/20 14:25:21.075800 [info] [raftstore]: starts with 0 shards, including 0 tombstones and 0 applying shards
2021/08/20 14:25:21.075801 [info] [raftstore]: cleanup possible garbage data complete
2021/08/20 14:25:21.075801 [info] [raftstore]: shards started
2021/08/20 14:25:21.075801 [info] [raftstore]: raft worker 0/0 start
2021/08/20 14:25:21.075803 [info] [raftstore]: shard timer based tasks started
2021/08/20 14:25:21.075825 [info] [raftstore]: net application started
2021/08/20 14:25:21.075834 [info] [raftstore]: start listen at 127.0.0.1:20001 for client
2021/08/20 14:25:21.075850 [info] [raftstore]: router started
2021/08/20 14:25:21.075863 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:21.075880 [info] [raftstore]: router event loop task started
2021/08/20 14:25:21.075903 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:21.075905 [info] prophet: watcher init leader connection 127.0.0.1:30000 succeed
2021/08/20 14:25:21.075925 [info] prophet: session 4[127.0.0.1:38786] connected
2021/08/20 14:25:21.075942 [info] prophet: new watcher 127.0.0.1:38786 added
2021/08/20 14:25:21.075988 [info] [raftstore]: start init event
2021-08-20 14:25:21.077503 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream Message writer)
2021-08-20 14:25:21.077519 I | rafthttp: established a TCP streaming connection with peer bc0cd14fb32a9f6c (stream Message reader)
2021-08-20 14:25:21.077522 I | rafthttp: established a TCP streaming connection with peer bc0cd14fb32a9f6c (stream MsgApp v2 reader)
2021-08-20 14:25:21.077526 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 writer)
2021/08/20 14:25:21.077662 [info] [raftstore]: begin start raftstore
2021/08/20 14:25:21.077676 [info] [raftstore]: begin to start prophet
2021-08-20 14:25:21.078158 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:3a0a456430dd7267 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:21.078+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-3e76cdb8-b029-4fd1-88c8-24f9d86e4f24/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:21.078511 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:21.085807 [info] prophet: [prophet-leader/node-1]/watch: leader updated to 涕Ӷnode-0127.0.0.1:30000
2021/08/20 14:25:21.172330 [info] prophet: resource 2 add operator add-rule-peer {add peer: container [5]} (kind:resource,replica, resource:2(1,1), createAt:2021-08-20 14:25:21.1723048 +0800 CST m=+16.705831501, startAt:0001-01-01 00:00:00 +0000 UTC, currentStep:0, steps:[add learner peer 6 on container 5, promote learner peer 6 on container 5 to voter]), 
2021/08/20 14:25:21.172354 [info] prophet: resource 2 send schedule command, step add learner peer 6 on container 5, source create
2021/08/20 14:25:21.172476 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:21.173550 [info] [raftstore]: shard-2 propose conf change peer [{ChangeType:AddLearnerNode Peer:{ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:21.173636 [info] [raftstore]: shard 2 do apply change peer changeType:AddLearnerNode peer:<id:6 containerID:5 role:Learner >  at epoch {ConfVer:1 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:21.173653 [info] [raftstore]: shard-2 add learner peer {ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} successfully, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:21.174737 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 7
{"level":"info","ts":"2021-08-20T14:25:21.174+0800","caller":"raft/raft.go:1550","msg":"3 switched to configuration voters=(3) learners=(6)"}
2021/08/20 14:25:21.174807 [info] [raftstore]: shard 2 notify pd with {Transition:ConfChangeTransitionAuto Changes:[{Type:ConfChangeAddLearnerNode NodeID:6 XXX_unrecognized:[]}] Context:[10 32 10 16 231 147 13 8 31 81 75 77 177 237 255 128 237 148 7 83 16 2 26 4 8 3 16 1 42 4 8 1 16 1 26 14 8 1 18 10 8 3 18 6 8 6 16 5 24 1] XXX_unrecognized:[]} with changes [{ChangeType:AddLearnerNode Peer:{ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:21.174824 [info] [raftstore]: shard 2 applied changes [{ChangeType:AddLearnerNode Peer:{ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, new peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:21.174984 [info] prophet: resource 2 ConfVer changed from 1 to 2
2021/08/20 14:25:21.176348 [info] [transport]: connected to store 5
2021/08/20 14:25:21.176382 [info] [transport]: session 1[127.0.0.1:58674] connected
2021/08/20 14:25:21.176470 [info] [raftstore]: shard 2 target peer doesn't exist, peer=<{ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}> message=<MsgApp>
2021/08/20 14:25:21.176487 [info] [raftstore]: shard 2 replicate peer {ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:21.176528 [info] [raftstore]: shard 2 init with raft local state {HardState:{Term:0 Vote:0 Commit:0 XXX_unrecognized:[]} LastIndex:0 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:21.176547 [info] [raftstore]: shard 2 init raft apply state, state=<{AppliedIndex:0 TruncatedState:{Index:0 Term:0 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:21.176550 [info] [raftstore]: shard 2 init last term, last term=<0>
{"level":"info","ts":"2021-08-20T14:25:21.176+0800","caller":"raft/raft.go:1550","msg":"6 switched to configuration voters=()"}
{"level":"info","ts":"2021-08-20T14:25:21.176+0800","caller":"raft/raft.go:711","msg":"6 became follower at term 0"}
{"level":"info","ts":"2021-08-20T14:25:21.176+0800","caller":"raft/raft.go:388","msg":"newRaft 6 [peers: [], term: 0, commit: 0, applied: 0, lastindex: 0, lastterm: 0]"}
2021/08/20 14:25:21.176741 [info] [raftstore]: shard 2 peer 6 raft 6 added, epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
{"level":"info","ts":"2021-08-20T14:25:21.176+0800","caller":"raft/raft.go:870","msg":"6 [term: 0] received a MsgHeartbeat message with higher term from 3 [term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:21.176+0800","caller":"raft/raft.go:711","msg":"6 became follower at term 6"}
2021/08/20 14:25:21.176873 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:21.177023 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 skip with no delegates, 0 commits, result <nil>
2021/08/20 14:25:21.178181 [info] [transport]: connected to store 1
2021/08/20 14:25:21.178198 [info] [transport]: session 1[127.0.0.1:36360] connected
2021/08/20 14:25:21.178298 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:21.178309 [info] prophet: resource 2 send schedule command, step promote learner peer 6 on container 5 to voter, source heartbeat
2021/08/20 14:25:21.178326 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 skip with no delegates, 0 commits, result <nil>
2021/08/20 14:25:21.178344 [info] prophet: resource 2 send schedule command, step promote learner peer 6 on container 5 to voter, source heartbeat
{"level":"error","ts":"2021-08-20T14:25:21.178+0800","caller":"raft/log.go:354","msg":"3 >>>>>>>>>>>>>>>> [1:8:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).sendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:442\ngo.etcd.io/etcd/raft.stepLeader\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1150\ngo.etcd.io/etcd/raft.(*raft).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:995\ngo.etcd.io/etcd/raft.(*RawNode).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:114\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleStep\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:257\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:183\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:443\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:21.178393 [info] [raftstore]: shard-2 AddNode peer {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:21.178418 [info] [raftstore]: shard-2 AddNode peer {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:21.178412 [info] [raftstore]: shard 2 start snapshot, epoch=<{ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:21.178548 [info] [raftstore]: shard-2 propose conf change peer [{ChangeType:AddNode Peer:{ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
{"level":"error","ts":"2021-08-20T14:25:21.178+0800","caller":"raft/log.go:354","msg":"3 >>>>>>>>>>>>>>>> [1:9:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).sendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:442\ngo.etcd.io/etcd/raft.(*raft).bcastAppend.func1\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:538\ngo.etcd.io/etcd/raft/tracker.(*ProgressTracker).Visit\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/tracker/tracker.go:209\ngo.etcd.io/etcd/raft.(*raft).bcastAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:534\ngo.etcd.io/etcd/raft.stepLeader\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1090\ngo.etcd.io/etcd/raft.(*raft).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:995\ngo.etcd.io/etcd/raft.(*RawNode).ProposeConfChange\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:98\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).proposeConfChangeInternal\n\t/root/projects/matrixcube/raftstore/peer_event_proposal.go:262\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).proposeConfChange\n\t/root/projects/matrixcube/raftstore/peer_event_proposal.go:232\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).propose\n\t/root/projects/matrixcube/raftstore/peer_event_proposal.go:141\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleRequest\n\t/root/projects/matrixcube/raftstore/peer_event_proposal.go:98\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:187\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:443\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:21.178634 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:21.178676 [info] [raftstore]: shard 2 do apply change peer peer:<id:6 containerID:5 >  at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:21.178692 [info] [raftstore]: shard-2 add peer {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} successfully, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:21.178697 [info] [raftstore]: shard 2 snapshot created, epoch=<confVer:2 version:1 > term=<6> index=<7> 
2021/08/20 14:25:21.184425 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 8
{"level":"info","ts":"2021-08-20T14:25:21.184+0800","caller":"raft/raft.go:1550","msg":"3 switched to configuration voters=(3 6)"}
{"level":"error","ts":"2021-08-20T14:25:21.184+0800","caller":"raft/log.go:354","msg":"3 >>>>>>>>>>>>>>>> [1:9:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).switchToConfig.func1\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1586\ngo.etcd.io/etcd/raft/tracker.(*ProgressTracker).Visit\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/tracker/tracker.go:209\ngo.etcd.io/etcd/raft.(*raft).switchToConfig\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1585\ngo.etcd.io/etcd/raft.(*raft).applyConfChange\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1537\ngo.etcd.io/etcd/raft.(*RawNode).ApplyConfChange\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:103\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).doApplyConfChange\n\t/root/projects/matrixcube/raftstore/peer_event_post_apply.go:106\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).doPostApplyResult\n\t/root/projects/matrixcube/raftstore/peer_event_post_apply.go:92\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).doPollApply\n\t/root/projects/matrixcube/raftstore/peer_event_post_apply.go:51\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleApplyResult\n\t/root/projects/matrixcube/raftstore/peer_event_post_apply.go:39\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:186\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:447\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:21.184524 [info] [raftstore]: shard 2 notify pd with {Transition:ConfChangeTransitionAuto Changes:[{Type:ConfChangeAddNode NodeID:6 XXX_unrecognized:[]}] Context:[10 32 10 16 132 3 123 20 122 38 79 174 136 184 71 167 179 18 229 49 16 2 26 4 8 3 16 1 42 4 8 2 16 1 26 10 8 1 18 6 18 4 8 6 16 5] XXX_unrecognized:[]} with changes [{ChangeType:AddNode Peer:{ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:21.184542 [info] [raftstore]: shard 2 applied changes [{ChangeType:AddNode Peer:{ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, new peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:21.184605 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:21.184632 [info] prophet: resource 2 ConfVer changed from 2 to 3
2021/08/20 14:25:21.184640 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 skip with no delegates, 0 commits, result <nil>
{"level":"error","ts":"2021-08-20T14:25:21.184+0800","caller":"raft/log.go:354","msg":"3 >>>>>>>>>>>>>>>> [1:9:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).sendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:442\ngo.etcd.io/etcd/raft.stepLeader\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1208\ngo.etcd.io/etcd/raft.(*raft).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:995\ngo.etcd.io/etcd/raft.(*RawNode).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:114\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleStep\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:257\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:183\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:443\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:21.184706 [info] [raftstore]: shard 2 snapshot epoch 2/3 stale, generate again.
2021/08/20 14:25:21.184711 [info] [raftstore]: shard 2 start snapshot, epoch=<{ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:21.184954 [info] [raftstore]: shard 2 snapshot created, epoch=<confVer:3 version:1 > term=<6> index=<8> 
2021/08/20 14:25:21.185596 [info] prophet: resource 2 operator(add-rule-peer {add peer: container [5]} (kind:resource,replica, resource:2(1,1), createAt:2021-08-20 14:25:21.1723048 +0800 CST m=+16.705831501, startAt:2021-08-20 14:25:21.172347 +0800 CST m=+16.705873601, currentStep:2, steps:[add learner peer 6 on container 5, promote learner peer 6 on container 5 to voter]) finished) finish, takes 13.2397ms, 
2021/08/20 14:25:21.273694 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:21.273740 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 skip with no delegates, 0 commits, result <nil>
{"level":"error","ts":"2021-08-20T14:25:21.273+0800","caller":"raft/log.go:354","msg":"3 >>>>>>>>>>>>>>>> [1:9:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).sendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:442\ngo.etcd.io/etcd/raft.stepLeader\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1208\ngo.etcd.io/etcd/raft.(*raft).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:995\ngo.etcd.io/etcd/raft.(*RawNode).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:114\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleStep\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:257\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:183\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:443\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:21.273864 [info] [transport]: shard 2 start send pending snap, epoch=<confVer:3 version:1 > term=<6> index=<8>
2021/08/20 14:25:21.273939 [info] [transport]: connected to store 5
2021/08/20 14:25:21.273962 [info] [transport]: session 2[127.0.0.1:58678] connected
{"level":"info","ts":"2021-08-20T14:25:21.273+0800","caller":"raft/log.go:301","msg":"log [committed=0, applied=0, unstable.offset=1, len(unstable.Entries)=0] starts to restore snapshot [index: 8, term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:21.274+0800","caller":"raft/raft.go:1550","msg":"6 switched to configuration voters=(3 6)"}
{"level":"info","ts":"2021-08-20T14:25:21.274+0800","caller":"raft/raft.go:1503","msg":"6 [commit: 8, lastindex: 8, lastterm: 6] restored snapshot [index: 8, term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:21.274+0800","caller":"raft/raft.go:1420","msg":"6 [commit: 8] restored snapshot [index: 8, term: 6]"}
2021/08/20 14:25:21.274081 [info] [raftstore]: shard 2 peer 6 receiving snapshot, skip further handling
2021/08/20 14:25:21.274192 [info] [raftstore]: shard 2 try to send snap, header=<shard:<id:2 epoch:<confVer:3 version:1 > peers:<id:3 containerID:1 > peers:<id:6 containerID:5 > > from:<id:3 containerID:1 > to:<id:6 containerID:5 role:Learner > term:6 index:8 >,size=<124>
2021/08/20 14:25:21.274247 [info] [raftstore]: shard 2 send snap complete
2021/08/20 14:25:21.274267 [info] [transport]: shard 2 pending snap sent succ, size=<124>, epoch=<confVer:3 version:1 > term=<6> index=<8>
2021/08/20 14:25:21.473977 [info] [raftstore]: shard 2 begin to apply snapshot
2021/08/20 14:25:21.473998 [info] [raftstore]: shard 2 clear 0 meta keys and 0 raft keys
2021/08/20 14:25:21.474012 [info] [raftstore]: shard 2 apply snapshot state completed, apply state {AppliedIndex:8 TruncatedState:{Index:8 Term:6 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:21.474021 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 start applying snapshot
2021/08/20 14:25:21.474035 [info] [raftstore]: shard 2 begin apply snapshot data
2021/08/20 14:25:21.474121 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:21.474172 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 add registration job by handleRaftReadyApply
2021/08/20 14:25:21.474184 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 applying snapshot to set read 8
2021/08/20 14:25:21.474225 [info] [raftstore]: shard 2 snapshot is applied, shard=<{ID:2 Start:[] End:[] Epoch:{ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:21.474249 [info] [raftstore]: shard 2 shard changed after apply snapshot, from=<{ID:2 Start:[] End:[] Epoch:{ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:6 ContainerID:5 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}> to=<{ID:2 Start:[] End:[] Epoch:{ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:21.474254 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 AdvanceApply with 8
2021/08/20 14:25:21.474272 [info] [raftstore]: shard 2 delete exists snap gz file /tmp/cube/node-1/snapshots/2_6_8.gz, header is shard:<id:2 epoch:<confVer:2 version:1 > peers:<id:6 containerID:5 role:Learner > peers:<id:3 containerID:1 > > from:<> to:<> term:6 index:8 
2021/08/20 14:25:21.474324 [info] [raftstore]: shard 2 apply snapshot data complete, {Term:6 Vote:0 Commit:8 XXX_unrecognized:[]}
2021/08/20 14:25:21.474340 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 add registration job by handleRaftReadyApply, completed
2021/08/20 14:25:21.573386 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:21.579215 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:3a0a456430dd7267 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:21.579+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-3e76cdb8-b029-4fd1-88c8-24f9d86e4f24/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:21.579355 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:21.674425 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:21.873407 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:22.073456 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:22.079638 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:5585a2d95b7a9bc6 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:22.079+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-3e76cdb8-b029-4fd1-88c8-24f9d86e4f24/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:22.079794 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:22.273847 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:22.473642 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:22.580949 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:5585a2d95b7a9bc6 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:22.581+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-3e76cdb8-b029-4fd1-88c8-24f9d86e4f24/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:22.581099 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:22.673714 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:22.874381 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:23.073787 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:23.082057 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:5b1233f9e55d0a25 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:23.082+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-3e76cdb8-b029-4fd1-88c8-24f9d86e4f24/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:23.082204 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:23.273946 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:23.474396 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:23.583318 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:5b1233f9e55d0a25 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:23.583+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-3e76cdb8-b029-4fd1-88c8-24f9d86e4f24/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:23.583436 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:23.674387 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:23.873847 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:24.073653 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:24.083630 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:eac8d0c1c3a23ff7 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:24.083+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-3e76cdb8-b029-4fd1-88c8-24f9d86e4f24/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:24.083775 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:24.274156 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:24.474316 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:24.584570 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:eac8d0c1c3a23ff7 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:24.584+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-3e76cdb8-b029-4fd1-88c8-24f9d86e4f24/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:24.584726 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:24.674227 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:24.873706 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:25.074471 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:25.085549 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:12e18f369135082f RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:25.085+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-3e76cdb8-b029-4fd1-88c8-24f9d86e4f24/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:25.085683 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:25.273765 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:25.473514 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:25.586062 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:12e18f369135082f RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:25.586+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-3e76cdb8-b029-4fd1-88c8-24f9d86e4f24/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:25.586208 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:25.674060 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:25.874239 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:26.074085 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
{"level":"info","ts":"2021-08-20T14:25:26.087+0800","caller":"raft/raft.go:1550","msg":"93ccda9956d988f4 switched to configuration voters=(9302531233895466631 10650127570946328820 13550435519089516396)"}
2021-08-20 14:25:26.087517 I | etcdserver/membership: added member 81193adecc50c687 [http://127.0.0.1:50002] to cluster 6a4ade671189dc2f
2021-08-20 14:25:26.087525 I | rafthttp: starting peer 81193adecc50c687...
{"level":"info","ts":"2021-08-20T14:25:26.087+0800","caller":"raft/raft.go:1550","msg":"bc0cd14fb32a9f6c switched to configuration voters=(9302531233895466631 10650127570946328820 13550435519089516396)"}
2021-08-20 14:25:26.087544 I | rafthttp: started HTTP pipelining with peer 81193adecc50c687
2021-08-20 14:25:26.087565 I | etcdserver/membership: added member 81193adecc50c687 [http://127.0.0.1:50002] to cluster 6a4ade671189dc2f
2021-08-20 14:25:26.087573 I | rafthttp: starting peer 81193adecc50c687...
2021-08-20 14:25:26.087580 I | rafthttp: started HTTP pipelining with peer 81193adecc50c687
2021-08-20 14:25:26.087815 I | rafthttp: started streaming with peer 81193adecc50c687 (writer)
2021-08-20 14:25:26.087923 I | rafthttp: started streaming with peer 81193adecc50c687 (writer)
2021-08-20 14:25:26.088011 I | rafthttp: started streaming with peer 81193adecc50c687 (writer)
2021-08-20 14:25:26.088048 I | rafthttp: started streaming with peer 81193adecc50c687 (writer)
2021-08-20 14:25:26.088203 I | rafthttp: started peer 81193adecc50c687
2021-08-20 14:25:26.088218 I | rafthttp: added peer 81193adecc50c687
2021-08-20 14:25:26.088231 I | rafthttp: started streaming with peer 81193adecc50c687 (stream MsgApp v2 reader)
2021-08-20 14:25:26.088362 I | rafthttp: started streaming with peer 81193adecc50c687 (stream Message reader)
2021-08-20 14:25:26.088406 I | rafthttp: started peer 81193adecc50c687
2021-08-20 14:25:26.088415 I | rafthttp: added peer 81193adecc50c687
2021-08-20 14:25:26.088429 I | rafthttp: started streaming with peer 81193adecc50c687 (stream MsgApp v2 reader)
2021-08-20 14:25:26.088446 I | rafthttp: started streaming with peer 81193adecc50c687 (stream Message reader)
[WARNING] Deprecated '--logger=capnslog' flag is set; use '--logger=zap' flag instead
2021-08-20 14:25:26.088835 I | embed: pprof is enabled under /debug/pprof
2021-08-20 14:25:26.088906 I | embed: name = node-2
2021-08-20 14:25:26.088921 I | embed: data dir = /tmp/cube/node-2/prophet
2021-08-20 14:25:26.088923 I | embed: member dir = /tmp/cube/node-2/prophet/member
2021-08-20 14:25:26.088925 I | embed: heartbeat = 100ms
2021-08-20 14:25:26.088927 I | embed: election = 3000ms
2021-08-20 14:25:26.088929 I | embed: snapshot count = 100000
2021-08-20 14:25:26.088932 I | embed: advertise client URLs = http://127.0.0.1:40002
2021-08-20 14:25:26.093481 I | etcdserver: starting member 81193adecc50c687 in cluster 6a4ade671189dc2f
{"level":"info","ts":"2021-08-20T14:25:26.093+0800","caller":"raft/raft.go:1550","msg":"81193adecc50c687 switched to configuration voters=()"}
{"level":"info","ts":"2021-08-20T14:25:26.093+0800","caller":"raft/raft.go:711","msg":"81193adecc50c687 became follower at term 0"}
{"level":"info","ts":"2021-08-20T14:25:26.093+0800","caller":"raft/raft.go:388","msg":"newRaft 81193adecc50c687 [peers: [], term: 0, commit: 0, applied: 0, lastindex: 0, lastterm: 0]"}
2021-08-20 14:25:26.095186 W | auth: simple token is not cryptographically signed
2021-08-20 14:25:26.098281 I | rafthttp: started HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:26.098297 I | rafthttp: started HTTP pipelining with peer bc0cd14fb32a9f6c
2021-08-20 14:25:26.098303 I | rafthttp: starting peer 93ccda9956d988f4...
2021-08-20 14:25:26.098309 I | rafthttp: started HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:26.098575 I | rafthttp: started streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:26.098718 I | rafthttp: started streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:26.098999 I | rafthttp: started peer 93ccda9956d988f4
2021-08-20 14:25:26.099014 I | rafthttp: added peer 93ccda9956d988f4
2021-08-20 14:25:26.099017 I | rafthttp: starting peer bc0cd14fb32a9f6c...
2021-08-20 14:25:26.099020 I | rafthttp: started streaming with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:26.099036 I | rafthttp: started streaming with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:26.099093 I | rafthttp: started HTTP pipelining with peer bc0cd14fb32a9f6c
2021-08-20 14:25:26.099275 I | rafthttp: peer 81193adecc50c687 became active
2021-08-20 14:25:26.099296 I | rafthttp: peer 93ccda9956d988f4 became active
2021-08-20 14:25:26.099301 I | rafthttp: established a TCP streaming connection with peer 81193adecc50c687 (stream Message writer)
2021-08-20 14:25:26.099305 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:26.099311 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:26.099386 I | rafthttp: started streaming with peer bc0cd14fb32a9f6c (writer)
2021-08-20 14:25:26.099427 I | rafthttp: established a TCP streaming connection with peer 81193adecc50c687 (stream MsgApp v2 writer)
2021-08-20 14:25:26.099635 I | rafthttp: started streaming with peer bc0cd14fb32a9f6c (writer)
2021-08-20 14:25:26.100066 I | rafthttp: started peer bc0cd14fb32a9f6c
2021-08-20 14:25:26.100081 I | rafthttp: added peer bc0cd14fb32a9f6c
2021-08-20 14:25:26.100086 I | etcdserver: starting server... [version: 3.4.15, cluster version: to_be_decided]
2021-08-20 14:25:26.100088 I | rafthttp: started streaming with peer bc0cd14fb32a9f6c (stream MsgApp v2 reader)
2021-08-20 14:25:26.100092 I | rafthttp: started streaming with peer bc0cd14fb32a9f6c (stream Message reader)
2021-08-20 14:25:26.101003 I | embed: listening for peers on 127.0.0.1:50002
2021-08-20 14:25:26.101051 I | rafthttp: peer bc0cd14fb32a9f6c became active
2021-08-20 14:25:26.101083 I | rafthttp: peer 81193adecc50c687 became active
2021-08-20 14:25:26.101098 I | rafthttp: established a TCP streaming connection with peer bc0cd14fb32a9f6c (stream Message reader)
2021-08-20 14:25:26.101102 I | rafthttp: established a TCP streaming connection with peer 81193adecc50c687 (stream Message writer)
2021-08-20 14:25:26.101125 I | rafthttp: established a TCP streaming connection with peer bc0cd14fb32a9f6c (stream MsgApp v2 reader)
2021-08-20 14:25:26.102526 I | rafthttp: established a TCP streaming connection with peer 81193adecc50c687 (stream MsgApp v2 writer)
2021-08-20 14:25:26.150792 I | etcdserver: 81193adecc50c687 initialized peer connection; fast-forwarding 28 ticks (election ticks 30) with 2 active peer(s)
{"level":"info","ts":"2021-08-20T14:25:26.166+0800","caller":"raft/raft.go:870","msg":"81193adecc50c687 [term: 0] received a MsgHeartbeat message with higher term from 93ccda9956d988f4 [term: 2]"}
{"level":"info","ts":"2021-08-20T14:25:26.166+0800","caller":"raft/raft.go:711","msg":"81193adecc50c687 became follower at term 2"}
{"level":"info","ts":"2021-08-20T14:25:26.166+0800","caller":"raft/node.go:325","msg":"raft.node: 81193adecc50c687 elected leader 93ccda9956d988f4 at term 2"}
{"level":"info","ts":"2021-08-20T14:25:26.168+0800","caller":"raft/raft.go:1550","msg":"81193adecc50c687 switched to configuration voters=(10650127570946328820)"}
2021-08-20 14:25:26.168172 I | etcdserver/membership: added member 93ccda9956d988f4 [http://127.0.0.1:50000] to cluster 6a4ade671189dc2f
2021-08-20 14:25:26.168198 N | etcdserver/membership: set the initial cluster version to 3.4
{"level":"info","ts":"2021-08-20T14:25:26.168+0800","caller":"raft/raft.go:1550","msg":"81193adecc50c687 switched to configuration voters=(10650127570946328820 13550435519089516396)"}
2021-08-20 14:25:26.168588 I | etcdserver/membership: added member bc0cd14fb32a9f6c [http://127.0.0.1:50001] to cluster 6a4ade671189dc2f
{"level":"info","ts":"2021-08-20T14:25:26.168+0800","caller":"raft/raft.go:1550","msg":"81193adecc50c687 switched to configuration voters=(9302531233895466631 10650127570946328820 13550435519089516396)"}
2021-08-20 14:25:26.168789 I | etcdserver/membership: added member 81193adecc50c687 [http://127.0.0.1:50002] to cluster 6a4ade671189dc2f
2021-08-20 14:25:26.169397 I | etcdserver: published {Name:node-2 ClientURLs:[http://127.0.0.1:40002]} to cluster 6a4ade671189dc2f
2021-08-20 14:25:26.169411 I | embed: ready to serve client requests
2021/08/20 14:25:26.169434 [info] prophet: create etcd v3 client with endpoints [http://127.0.0.1:40002]
2021-08-20 14:25:26.169647 N | embed: serving insecure client requests on 127.0.0.1:40002, this is strongly discouraged!
2021/08/20 14:25:26.170482 [info] prophet: net application started
2021/08/20 14:25:26.170499 [info] prophet: start system time monitor 
2021/08/20 14:25:26.170857 [info] prophet: [prophet-leader/node-2]/loop: current leader is [涕Ӷnode-0127.0.0.1:30000]
2021/08/20 14:25:26.170867 [info] prophet: [prophet-leader/node-2]/loop: start watch leader 涕Ӷnode-0127.0.0.1:30000
2021/08/20 14:25:26.170870 [info] prophet: ********node-2 become to follower now********
2021/08/20 14:25:26.170895 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:26.170949 [info] prophet: client started
2021/08/20 14:25:26.170962 [info] [raftstore]: *********Become prophet follower*********
2021/08/20 14:25:26.170962 [info] prophet: session 5[127.0.0.1:38848] connected
2021/08/20 14:25:26.170953 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:26.170900 [info] prophet: client read loop started 
2021/08/20 14:25:26.170968 [info] prophet: client read loop actived, ready to read from leader
2021/08/20 14:25:26.170964 [info] [raftstore]: begin to bootstrap the cluster
2021/08/20 14:25:26.171002 [info] [raftstore]: raftstore init with store raftAddr:"127.0.0.1:10002" clientAddr:"127.0.0.1:20002" labels:<key:"c" value:"2" > startTime:1629440726 deployPath:"not set" 
2021/08/20 14:25:26.171011 [info] [raftstore]: begin to create local store metadata
2021/08/20 14:25:26.171101 [info] [raftstore]: create local store with id 7
2021/08/20 14:25:26.171500 [info] [raftstore]: the cluster already bootstrap: true
2021/08/20 14:25:26.173527 [info] prophet: container 7 limit added
2021/08/20 14:25:26.173598 [info] [raftstore]: prophet started
2021/08/20 14:25:26.173625 [info] prophet: container 7 heartbeat stream binded
2021/08/20 14:25:26.173644 [info] [transport]: net application started
2021/08/20 14:25:26.173646 [info] [raftstore]: start listen at 127.0.0.1:10002 for raft
2021/08/20 14:25:26.173648 [info] [raftstore]: raft shards workers started
2021/08/20 14:25:26.173651 [info] [raftstore]: starts with 0 shards, including 0 tombstones and 0 applying shards
2021/08/20 14:25:26.173654 [info] [raftstore]: cleanup possible garbage data complete
2021/08/20 14:25:26.173655 [info] [raftstore]: shards started
2021/08/20 14:25:26.173656 [info] [raftstore]: shard timer based tasks started
2021/08/20 14:25:26.173660 [info] [raftstore]: net application started
2021/08/20 14:25:26.173661 [info] [raftstore]: start listen at 127.0.0.1:20002 for client
2021/08/20 14:25:26.173663 [info] [raftstore]: raft worker 0/0 start
2021/08/20 14:25:26.173669 [info] [raftstore]: router started
2021/08/20 14:25:26.173678 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:26.173702 [info] [raftstore]: router event loop task started
2021/08/20 14:25:26.173723 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:26.173726 [info] prophet: watcher init leader connection 127.0.0.1:30000 succeed
2021/08/20 14:25:26.173766 [info] prophet: session 6[127.0.0.1:38850] connected
2021/08/20 14:25:26.173796 [info] prophet: new watcher 127.0.0.1:38850 added
2021/08/20 14:25:26.173871 [info] [raftstore]: start init event
2021/08/20 14:25:26.184708 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:26.184834 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 9
2021/08/20 14:25:26.184835 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:26.184891 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 AdvanceApply with 9
2021/08/20 14:25:26.184908 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:26.184956 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:26.185019 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:26.185114 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:26.185176 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 AdvanceApply with 10
2021/08/20 14:25:26.185191 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021-08-20 14:25:26.188618 I | rafthttp: established a TCP streaming connection with peer 81193adecc50c687 (stream MsgApp v2 reader)
2021-08-20 14:25:26.188640 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 writer)
2021-08-20 14:25:26.188658 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream Message writer)
2021-08-20 14:25:26.188676 I | rafthttp: established a TCP streaming connection with peer 81193adecc50c687 (stream Message reader)
2021-08-20 14:25:26.188795 I | rafthttp: established a TCP streaming connection with peer bc0cd14fb32a9f6c (stream Message writer)
2021-08-20 14:25:26.188808 I | rafthttp: established a TCP streaming connection with peer 81193adecc50c687 (stream Message reader)
2021-08-20 14:25:26.188875 I | rafthttp: established a TCP streaming connection with peer 81193adecc50c687 (stream MsgApp v2 reader)
2021-08-20 14:25:26.188933 I | rafthttp: established a TCP streaming connection with peer bc0cd14fb32a9f6c (stream MsgApp v2 writer)
2021/08/20 14:25:26.195395 [info] prophet: resource 2 add operator add-rule-peer {add peer: container [7]} (kind:resource,replica, resource:2(1,3), createAt:2021-08-20 14:25:26.195375 +0800 CST m=+21.728901601, startAt:0001-01-01 00:00:00 +0000 UTC, currentStep:0, steps:[add learner peer 8 on container 7, promote learner peer 8 on container 7 to voter]), 
2021/08/20 14:25:26.195415 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source create
2021/08/20 14:25:26.195533 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:26.197743 [info] prophet: [prophet-leader/node-2]/watch: leader updated to 涕Ӷnode-0127.0.0.1:30000
2021/08/20 14:25:26.204107 [info] [raftstore]: shard-2 propose conf change peer [{ChangeType:AddLearnerNode Peer:{ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:26.204190 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:26.204298 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:26.204371 [info] [raftstore]: shard 2 do apply change peer changeType:AddLearnerNode peer:<id:8 containerID:7 role:Learner >  at epoch {ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:26.204391 [info] [raftstore]: shard-2 add learner peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} successfully, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:26.204402 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 AdvanceApply with 11
{"level":"info","ts":"2021-08-20T14:25:26.204+0800","caller":"raft/raft.go:1550","msg":"6 switched to configuration voters=(3 6) learners=(8)"}
2021/08/20 14:25:26.204463 [info] [raftstore]: shard 2 applied changes [{ChangeType:AddLearnerNode Peer:{ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:4 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, new peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:26.274409 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:26.274465 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:26.274562 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:26.284116 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:26.374895 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:26.374990 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:26.384502 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:26.474093 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:26.474263 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:26.474354 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:26.484965 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:26.575071 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:26.575234 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:26.584743 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:26.674317 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:26.674362 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:26.674414 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:26.684031 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:26.774890 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:26.774988 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:26.784485 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:26.874151 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:26.874340 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:26.874399 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:26.885039 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:26.984269 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:26.984372 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:26.994915 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:27.074259 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:27.074274 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:27.074342 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:27.084125 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:27.185035 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:27.185095 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:27.194401 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:27.273929 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:27.284671 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:27.284859 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:27.294058 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:27.374787 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:27.374876 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:27.384444 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:27.473530 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:27.474790 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:27.474919 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:27.484407 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:27.574762 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:27.574904 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:27.584414 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:27.674451 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:27.674499 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:27.674631 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:27.684138 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:27.784443 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:27.784515 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:27.794932 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:27.874443 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:27.874486 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:27.874564 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:27.884150 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:27.985090 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:27.985176 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:27.994544 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:28.073921 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:28.085034 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:28.085129 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:28.094388 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:28.184862 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:28.184964 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:28.194195 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:28.273711 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:28.274906 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:28.274985 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:28.284511 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:28.384760 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:28.384855 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:28.394088 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:28.473880 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:28.484626 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:28.484704 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:28.494093 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:28.584714 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:28.584859 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:28.594061 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:28.673804 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:28.675041 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:28.675123 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:28.684599 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:28.774431 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:28.774626 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:28.784154 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:28.873966 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:28.884781 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:28.884843 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:28.894069 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:28.984748 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:28.984826 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:28.994350 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:29.073772 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:29.074985 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:29.075053 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:29.084897 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:29.184761 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:29.184861 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:29.194115 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:29.273750 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:29.274999 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:29.275067 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:29.284552 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:29.374628 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:29.374706 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:29.384361 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:29.474488 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:29.474526 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:29.474677 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:29.484092 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:29.584310 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:29.584409 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:29.594740 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:29.674151 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:29.674273 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:29.674391 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:29.684003 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:29.774773 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:29.774856 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:29.784367 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:29.874178 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:29.874261 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:29.874405 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:29.884035 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:29.984175 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:29.984245 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:29.994769 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:30.074067 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:30.074283 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:30.074379 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:30.084183 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:30.185000 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:30.185108 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:30.194364 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:30.274002 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:30.284638 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:30.284722 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:30.293990 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:30.374872 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:30.374973 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:30.384528 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:30.473443 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:30.474897 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:30.474969 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:30.484473 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:30.574419 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:30.574482 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:30.584052 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:30.674123 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:30.674275 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:30.674383 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:30.684002 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:30.775022 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:30.775142 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:30.784700 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:30.873911 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:30.884689 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:30.884891 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:30.894022 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:30.974233 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:30.974407 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:30.984250 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:31.074095 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:31.084187 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:31.084284 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:31.095021 [error] [raftstore]: shard-2 there is a pending conf change, try later
2021/08/20 14:25:31.184754 [info] prophet: resource 2 send schedule command, step add learner peer 8 on container 7, source heartbeat
2021/08/20 14:25:31.184837 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:31.185967 [info] [raftstore]: shard 2 do apply change peer changeType:AddLearnerNode peer:<id:8 containerID:7 role:Learner >  at epoch {ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:31.185989 [info] [raftstore]: shard-2 add learner peer {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} successfully, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:31.194301 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 10
2021/08/20 14:25:31.194322 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 11
{"level":"info","ts":"2021-08-20T14:25:31.194+0800","caller":"raft/raft.go:1550","msg":"3 switched to configuration voters=(3 6) learners=(8)"}
2021/08/20 14:25:31.194387 [info] [raftstore]: shard 2 notify pd with {Transition:ConfChangeTransitionAuto Changes:[{Type:ConfChangeAddLearnerNode NodeID:8 XXX_unrecognized:[]}] Context:[10 32 10 16 16 111 98 168 108 183 65 234 129 16 104 148 38 72 215 46 16 2 26 4 8 3 16 1 42 4 8 3 16 1 26 14 8 1 18 10 8 3 18 6 8 8 16 7 24 1] XXX_unrecognized:[]} with changes [{ChangeType:AddLearnerNode Peer:{ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:4 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:31.194418 [error] prophet: session 4[127.0.0.1:38786] read failed with read tcp 127.0.0.1:30000->127.0.0.1:38786: use of closed network connection
2021/08/20 14:25:31.194432 [info] [raftstore]: shard 2 applied changes [{ChangeType:AddLearnerNode Peer:{ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:4 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, new peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:31.194453 [error] prophet: session 6[127.0.0.1:38850] read failed with read tcp 127.0.0.1:30000->127.0.0.1:38850: use of closed network connection
2021/08/20 14:25:31.194464 [error] prophet: session 2[127.0.0.1:38754] read failed with read tcp 127.0.0.1:30000->127.0.0.1:38754: use of closed network connection
2021/08/20 14:25:31.194468 [error] prophet: watcher read events failed with EOF
2021/08/20 14:25:31.194490 [error] prophet: session 3[127.0.0.1:38784] read failed with read tcp 127.0.0.1:30000->127.0.0.1:38784: use of closed network connection
2021/08/20 14:25:31.194493 [error] prophet: reset watcher conn failed with <nil>, retry later
2021/08/20 14:25:31.194495 [error] prophet: client read resp from leader 127.0.0.1:30000 failed with EOF
2021/08/20 14:25:31.194475 [info] [raftstore]: shard-2 propose conf change peer [{ChangeType:AddLearnerNode Peer:{ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:31.194500 [error] prophet: client read resp from leader 127.0.0.1:30000 failed with EOF
2021/08/20 14:25:31.194504 [error] prophet: watcher read events failed with EOF
2021/08/20 14:25:31.194521 [error] prophet: reset watcher conn failed with <nil>, retry later
2021/08/20 14:25:31.194522 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:31.194524 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:31.194478 [error] prophet: session 5[127.0.0.1:38848] read failed with read tcp 127.0.0.1:30000->127.0.0.1:38848: use of closed network connection
2021/08/20 14:25:31.194396 [error] prophet: client read resp from leader 127.0.0.1:30000 failed with read tcp 127.0.0.1:38752->127.0.0.1:30000: use of closed network connection
2021/08/20 14:25:31.194545 [error] prophet: client read loop stopped
2021/08/20 14:25:31.194581 [error] prophet: init leader conn failed with dial tcp 127.0.0.1:30000: connect: connection refused, retry later
2021/08/20 14:25:31.194592 [error] prophet: init leader conn failed with dial tcp 127.0.0.1:30000: connect: connection refused, retry later
2021/08/20 14:25:31.194482 [error] prophet: watcher read events failed with EOF
2021/08/20 14:25:31.194606 [error] prophet: reset watcher conn failed with <nil>, retry later
2021/08/20 14:25:31.194664 [error] [raftstore]: shard 2 heartbeat to prophet failed with client is closed
2021/08/20 14:25:31.196165 [info] prophet: [prophet-leader/node-0]/lease: closed
2021/08/20 14:25:31.196229 [info] prophet: [prophet-leader/node-0]/keepalive: exit with context done
2021/08/20 14:25:31.196251 [info] prophet: [prophet-leader/node-0]/lease: exit with context done
2021/08/20 14:25:31.196260 [error] prophet: [prophet-leader/node-0]/lease: keep lease exit
2021-08-20 14:25:31.196274 I | etcdserver: 93ccda9956d988f4 starts leadership transfer from 93ccda9956d988f4 to bc0cd14fb32a9f6c
{"level":"warn","ts":"2021-08-20T14:25:31.196+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-09008a89-a79c-4465-9d79-06ee96940511/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = transport is closing"}
2021/08/20 14:25:31.196281 [info] prophet: coordinator is stopping
2021/08/20 14:25:31.196288 [info] prophet: patrol resources has been stopped 
2021/08/20 14:25:31.196323 [error] prophet: read /prophet/containers/00000000000000000007 from etcd failed with context canceled
{"level":"info","ts":"2021-08-20T14:25:31.196+0800","caller":"raft/raft.go:1278","msg":"93ccda9956d988f4 [term 2] starts to transfer leadership to bc0cd14fb32a9f6c"}
{"level":"info","ts":"2021-08-20T14:25:31.196+0800","caller":"raft/raft.go:1284","msg":"93ccda9956d988f4 sends MsgTimeoutNow to bc0cd14fb32a9f6c immediately as bc0cd14fb32a9f6c already has up-to-date log"}
2021/08/20 14:25:31.196292 [info] prophet: drive push operator has been stopped 
2021/08/20 14:25:31.196365 [info] prophet: coordinator has been stopped
2021/08/20 14:25:31.196359 [info] prophet: [prophet-leader/node-1]/watch: leader deleted
2021/08/20 14:25:31.196392 [info] prophet: [prophet-leader/node-1]/loop: leader 涕Ӷnode-0127.0.0.1:30000 was out
2021/08/20 14:25:31.196434 [error] [transport]: shard 2 send msg shardID:2 from:<id:3 containerID:1 > to:<id:8 containerID:7 role:Learner > message:<type:MsgAppMsgApp to:8 from:3 term:6 logTerm:6 index:10 entries:<Term:6 Index:11 Type:EntryConfChangeEntryConfChange Data:"\010\000\020\003\030\010\"2\n \n\020\020ob\250l\267A\352\201\020h\224&H\327.\020\002\032\004\010\003\020\001*\004\010\003\020\001\032\016\010\001\022\n\010\003\022\006\010\010\020\007\030\001" > commit:11 snapshot:<metadata:<conf_state:<auto_leave:false > index:0 term:0 > > reject:false rejectHint:0 > shardEpoch:<confVer:4 version:1 >  from 3 to 8 failed with not connected
{"level":"info","ts":"2021-08-20T14:25:31.196+0800","caller":"raft/raft.go:1372","msg":"bc0cd14fb32a9f6c [term 2] received MsgTimeoutNow from 93ccda9956d988f4 and starts an election to get leadership."}
WARNING: 2021/08/20 14:25:31 grpc: Server.processUnaryRPC failed to write status: connection error: desc = "transport is closing"
{"level":"warn","ts":"2021-08-20T14:25:31.196+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-09008a89-a79c-4465-9d79-06ee96940511/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Canceled desc = context canceled"}
{"level":"info","ts":"2021-08-20T14:25:31.196+0800","caller":"raft/raft.go:724","msg":"bc0cd14fb32a9f6c became candidate at term 3"}
2021/08/20 14:25:31.196491 [error] prophet: read /prophet/containers/00000000000000000007 from etcd failed with context canceled
{"level":"info","ts":"2021-08-20T14:25:31.196+0800","caller":"raft/raft.go:835","msg":"bc0cd14fb32a9f6c received MsgVoteResp from bc0cd14fb32a9f6c at term 3"}
2021/08/20 14:25:31.196510 [info] prophet: [prophet-leader/node-2]/watch: leader deleted
2021/08/20 14:25:31.196514 [error] [transport]: shard 2 send msg shardID:2 from:<id:3 containerID:1 > to:<id:8 containerID:7 role:Learner > message:<type:MsgHeartbeatMsgHeartbeat to:8 from:3 term:6 logTerm:0 index:0 commit:0 snapshot:<metadata:<conf_state:<auto_leave:false > index:0 term:0 > > reject:false rejectHint:0 > shardEpoch:<confVer:4 version:1 >  from 3 to 8 failed with not connected
{"level":"info","ts":"2021-08-20T14:25:31.196+0800","caller":"raft/raft.go:822","msg":"bc0cd14fb32a9f6c [logterm: 2, index: 28] sent MsgVote request to 81193adecc50c687 at term 3"}
2021/08/20 14:25:31.196515 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 2 msgs
{"level":"info","ts":"2021-08-20T14:25:31.196+0800","caller":"raft/raft.go:822","msg":"bc0cd14fb32a9f6c [logterm: 2, index: 28] sent MsgVote request to 93ccda9956d988f4 at term 3"}
{"level":"info","ts":"2021-08-20T14:25:31.196+0800","caller":"raft/node.go:331","msg":"raft.node: bc0cd14fb32a9f6c lost leader 93ccda9956d988f4 at term 3"}
2021/08/20 14:25:31.196539 [info] prophet: [prophet-leader/node-2]/loop: leader 涕Ӷnode-0127.0.0.1:30000 was out
2021/08/20 14:25:31.196623 [info] [raftstore]: shard 2 do apply change peer changeType:AddLearnerNode peer:<id:8 containerID:7 role:Learner >  at epoch {ConfVer:4 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:31.196624 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:31.196670 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 12
2021/08/20 14:25:31.196683 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
2021/08/20 14:25:31.196740 [info] [raftstore]: shard 2 do apply change peer changeType:AddLearnerNode peer:<id:8 containerID:7 role:Learner >  at epoch {ConfVer:4 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:6 ContainerID:5 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:8 ContainerID:7 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:31.196966 [info] prophet: [prophet-leader/node-2]/campaign: load expect leader: []
2021/08/20 14:25:31.196977 [info] prophet: [prophet-leader/node-2]/campaign: start
{"level":"info","ts":"2021-08-20T14:25:31.197+0800","caller":"raft/raft.go:870","msg":"81193adecc50c687 [term: 2] received a MsgVote message with higher term from bc0cd14fb32a9f6c [term: 3]"}
{"level":"info","ts":"2021-08-20T14:25:31.197+0800","caller":"raft/raft.go:711","msg":"81193adecc50c687 became follower at term 3"}
{"level":"info","ts":"2021-08-20T14:25:31.197+0800","caller":"raft/raft.go:971","msg":"81193adecc50c687 [logterm: 2, index: 28, vote: 0] cast MsgVote for bc0cd14fb32a9f6c [logterm: 2, index: 28] at term 3"}
{"level":"info","ts":"2021-08-20T14:25:31.197+0800","caller":"raft/node.go:331","msg":"raft.node: 81193adecc50c687 lost leader 93ccda9956d988f4 at term 3"}
{"level":"info","ts":"2021-08-20T14:25:31.197+0800","caller":"raft/raft.go:870","msg":"93ccda9956d988f4 [term: 2] received a MsgVote message with higher term from bc0cd14fb32a9f6c [term: 3]"}
{"level":"info","ts":"2021-08-20T14:25:31.197+0800","caller":"raft/raft.go:711","msg":"93ccda9956d988f4 became follower at term 3"}
{"level":"info","ts":"2021-08-20T14:25:31.197+0800","caller":"raft/raft.go:971","msg":"93ccda9956d988f4 [logterm: 2, index: 28, vote: 0] cast MsgVote for bc0cd14fb32a9f6c [logterm: 2, index: 28] at term 3"}
{"level":"info","ts":"2021-08-20T14:25:31.197+0800","caller":"raft/node.go:331","msg":"raft.node: 93ccda9956d988f4 lost leader 93ccda9956d988f4 at term 3"}
{"level":"info","ts":"2021-08-20T14:25:31.197+0800","caller":"raft/raft.go:835","msg":"bc0cd14fb32a9f6c received MsgVoteResp from 81193adecc50c687 at term 3"}
{"level":"info","ts":"2021-08-20T14:25:31.197+0800","caller":"raft/raft.go:1319","msg":"bc0cd14fb32a9f6c has received 2 MsgVoteResp votes and 0 vote rejections"}
{"level":"info","ts":"2021-08-20T14:25:31.197+0800","caller":"raft/raft.go:776","msg":"bc0cd14fb32a9f6c became leader at term 3"}
{"level":"info","ts":"2021-08-20T14:25:31.197+0800","caller":"raft/node.go:325","msg":"raft.node: bc0cd14fb32a9f6c elected leader bc0cd14fb32a9f6c at term 3"}
{"level":"info","ts":"2021-08-20T14:25:31.197+0800","caller":"raft/node.go:325","msg":"raft.node: 93ccda9956d988f4 elected leader bc0cd14fb32a9f6c at term 3"}
{"level":"warn","ts":"2021-08-20T14:25:31.197+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-9bb580ea-be4f-4c7d-ad4a-7ec2d905feb7/127.0.0.1:40001","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: leader changed"}
{"level":"info","ts":"2021-08-20T14:25:31.197+0800","caller":"raft/node.go:325","msg":"raft.node: 81193adecc50c687 elected leader bc0cd14fb32a9f6c at term 3"}
2021/08/20 14:25:31.199886 [info] prophet: [prophet-leader/node-2]/campaign: grant lease ok
2021/08/20 14:25:31.201096 [info] prophet: [prophet-leader/node-2]/campaign: completed, start keepalive
2021/08/20 14:25:31.201110 [info] prophet: ********node-2 become to leader now********
2021/08/20 14:25:31.203149 [info] prophet: load 3 containers, cost 1.9466ms
2021/08/20 14:25:31.203562 [info] prophet: load 1 resources, cost 399.7µs
2021/08/20 14:25:31.204259 [info] [raftstore]: *********Become prophet leader*********
2021/08/20 14:25:31.204268 [info] prophet: coordinator starts to collect cluster information 
2021/08/20 14:25:31.204624 [info] prophet: load 0 jobs
2021/08/20 14:25:31.206773 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 AdvanceApply with 12
2021/08/20 14:25:31.225655 [info] prophet: [prophet-leader/node-1]/campaign: load expect leader: []
2021/08/20 14:25:31.225665 [info] prophet: [prophet-leader/node-1]/campaign: start
2021/08/20 14:25:31.226519 [info] prophet: [prophet-leader/node-1]/campaign: grant lease ok
2021/08/20 14:25:31.229247 [info] prophet: [prophet-leader/node-1]/lease: closed
2021/08/20 14:25:31.229261 [error] prophet: [prophet-leader/node-1]/loop: campaign leader failed with campaign leader failed, other server may campaign ok
2021/08/20 14:25:31.274172 [error] [raftstore]: shard 2 heartbeat to prophet failed with client is closed
2021/08/20 14:25:31.274183 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 6 send 1 msgs
{"level":"warn","ts":"2021-08-20T14:25:31.274+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-09008a89-a79c-4465-9d79-06ee96940511/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Canceled desc = context canceled"}
2021/08/20 14:25:31.274236 [error] prophet: read /prophet/containers/00000000000000000007 from etcd failed with context canceled
2021/08/20 14:25:31.274274 [error] [transport]: shard 2 send msg shardID:2 from:<id:3 containerID:1 > to:<id:8 containerID:7 role:Learner > message:<type:MsgHeartbeatMsgHeartbeat to:8 from:3 term:6 logTerm:0 index:0 commit:0 snapshot:<metadata:<conf_state:<auto_leave:false > index:0 term:0 > > reject:false rejectHint:0 > shardEpoch:<confVer:4 version:1 >  from 3 to 8 failed with not connected
2021-08-20 14:25:31.296314 I | etcdserver: 93ccda9956d988f4 finished leadership transfer from 93ccda9956d988f4 to bc0cd14fb32a9f6c (took 100.0326ms)
2021/08/20 14:25:31.296320 [info] prophet: [prophet-leader/node-0]/loop: exit
2021-08-20 14:25:31.296360 I | rafthttp: stopping peer 81193adecc50c687...
2021-08-20 14:25:31.296568 W | rafthttp: lost the TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:31.296663 I | rafthttp: closed the TCP streaming connection with peer 81193adecc50c687 (stream MsgApp v2 writer)
2021-08-20 14:25:31.296677 I | rafthttp: stopped streaming with peer 81193adecc50c687 (writer)
2021-08-20 14:25:31.296809 W | rafthttp: lost the TCP streaming connection with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:31.296861 I | rafthttp: closed the TCP streaming connection with peer 81193adecc50c687 (stream Message writer)
2021-08-20 14:25:31.296880 I | rafthttp: stopped streaming with peer 81193adecc50c687 (writer)
2021-08-20 14:25:31.296900 I | rafthttp: stopped HTTP pipelining with peer 81193adecc50c687
2021-08-20 14:25:31.296942 W | rafthttp: lost the TCP streaming connection with peer 81193adecc50c687 (stream MsgApp v2 reader)
2021-08-20 14:25:31.296955 E | rafthttp: failed to read 81193adecc50c687 on stream MsgApp v2 (context canceled)
2021-08-20 14:25:31.296957 I | rafthttp: peer 81193adecc50c687 became inactive (message send to peer failed)
2021-08-20 14:25:31.296965 I | rafthttp: stopped streaming with peer 81193adecc50c687 (stream MsgApp v2 reader)
2021-08-20 14:25:31.297002 W | rafthttp: lost the TCP streaming connection with peer 81193adecc50c687 (stream Message reader)
2021-08-20 14:25:31.297016 I | rafthttp: stopped streaming with peer 81193adecc50c687 (stream Message reader)
2021-08-20 14:25:31.297028 I | rafthttp: stopped peer 81193adecc50c687
2021-08-20 14:25:31.297039 I | rafthttp: stopping peer bc0cd14fb32a9f6c...
2021-08-20 14:25:31.297180 W | rafthttp: lost the TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:31.297292 I | rafthttp: closed the TCP streaming connection with peer bc0cd14fb32a9f6c (stream MsgApp v2 writer)
2021-08-20 14:25:31.297306 I | rafthttp: stopped streaming with peer bc0cd14fb32a9f6c (writer)
2021-08-20 14:25:31.297431 W | rafthttp: lost the TCP streaming connection with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:31.297518 I | rafthttp: closed the TCP streaming connection with peer bc0cd14fb32a9f6c (stream Message writer)
2021-08-20 14:25:31.297530 I | rafthttp: stopped streaming with peer bc0cd14fb32a9f6c (writer)
2021-08-20 14:25:31.297548 I | rafthttp: stopped HTTP pipelining with peer bc0cd14fb32a9f6c
2021-08-20 14:25:31.297575 W | rafthttp: lost the TCP streaming connection with peer bc0cd14fb32a9f6c (stream MsgApp v2 reader)
2021-08-20 14:25:31.297586 E | rafthttp: failed to read bc0cd14fb32a9f6c on stream MsgApp v2 (context canceled)
2021-08-20 14:25:31.297588 I | rafthttp: peer bc0cd14fb32a9f6c became inactive (message send to peer failed)
2021-08-20 14:25:31.297593 I | rafthttp: stopped streaming with peer bc0cd14fb32a9f6c (stream MsgApp v2 reader)
2021-08-20 14:25:31.297614 W | rafthttp: lost the TCP streaming connection with peer bc0cd14fb32a9f6c (stream Message reader)
2021-08-20 14:25:31.297624 I | rafthttp: stopped streaming with peer bc0cd14fb32a9f6c (stream Message reader)
2021-08-20 14:25:31.297626 I | rafthttp: stopped peer bc0cd14fb32a9f6c
2021-08-20 14:25:31.297683 E | rafthttp: failed to find member bc0cd14fb32a9f6c in cluster 6a4ade671189dc2f
2021-08-20 14:25:31.297717 E | rafthttp: failed to find member 81193adecc50c687 in cluster 6a4ade671189dc2f
2021-08-20 14:25:31.297750 E | rafthttp: failed to find member bc0cd14fb32a9f6c in cluster 6a4ade671189dc2f
2021-08-20 14:25:31.297769 E | rafthttp: failed to find member 81193adecc50c687 in cluster 6a4ade671189dc2f
2021-08-20 14:25:31.297814 E | rafthttp: failed to dial 93ccda9956d988f4 on stream MsgApp v2 (peer 93ccda9956d988f4 failed to find local node bc0cd14fb32a9f6c)
2021-08-20 14:25:31.297842 I | rafthttp: peer 93ccda9956d988f4 became inactive (message send to peer failed)
2021-08-20 14:25:31.297861 E | rafthttp: failed to dial 93ccda9956d988f4 on stream Message (peer 93ccda9956d988f4 failed to find local node 81193adecc50c687)
2021-08-20 14:25:31.297873 I | rafthttp: peer 93ccda9956d988f4 became inactive (message send to peer failed)
2021/08/20 14:25:31.304089 [info] [raftstore]: shard 2 handle serve raft stopped
2021/08/20 14:25:31.304108 [info] [raftstore]: handle resource heartbeat resp task stopped
2021/08/20 14:25:31.304115 [info] [raftstore]: timer based tasks stopped
2021/08/20 14:25:31.304116 [info] [raftstore]: router event loop task stopped
2021/08/20 14:25:31.304119 [info] [raftstore]: raft worker worker 0/0 exit
2021/08/20 14:25:31.304151 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:31.304161 [info] [transport]: send raft worker stopped
2021/08/20 14:25:31.304164 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:31.304167 [info] [transport]: transfer stopped
2021/08/20 14:25:31.304169 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:31.304170 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:31.304172 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:31.304172 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:31.304175 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:31.304178 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:31.304207 [error] [transport]: session 1[127.0.0.1:36360] read failed with read tcp 127.0.0.1:10000->127.0.0.1:36360: use of closed network connection
2021-08-20 14:25:31.305191 W | etcdserver: failed to apply request "header:<ID:11487692411363153166 > lease_revoke:<id:1f6c7b623c40550a>" with response "size:27" took (42µs) to execute, err is lease not found
2021-08-20 14:25:31.305233 W | etcdserver: failed to apply request "header:<ID:11487692411363153166 > lease_revoke:<id:1f6c7b623c40550a>" with response "size:27" took (28.6µs) to execute, err is lease not found
{"level":"warn","ts":"2021-08-20T14:25:31.305+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-9bb580ea-be4f-4c7d-ad4a-7ec2d905feb7/127.0.0.1:40001","attempt":0,"error":"rpc error: code = NotFound desc = etcdserver: requested lease not found"}
2021/08/20 14:25:31.305302 [info] prophet: [prophet-leader/node-1]/lease: close failed with etcdserver: requested lease not found
2021-08-20 14:25:31.305390 I | etcdserver: bc0cd14fb32a9f6c starts leadership transfer from bc0cd14fb32a9f6c to 81193adecc50c687
{"level":"info","ts":"2021-08-20T14:25:31.305+0800","caller":"raft/raft.go:1278","msg":"bc0cd14fb32a9f6c [term 3] starts to transfer leadership to 81193adecc50c687"}
{"level":"info","ts":"2021-08-20T14:25:31.305+0800","caller":"raft/raft.go:1284","msg":"bc0cd14fb32a9f6c sends MsgTimeoutNow to 81193adecc50c687 immediately as 81193adecc50c687 already has up-to-date log"}
{"level":"info","ts":"2021-08-20T14:25:31.305+0800","caller":"raft/raft.go:1372","msg":"81193adecc50c687 [term 3] received MsgTimeoutNow from bc0cd14fb32a9f6c and starts an election to get leadership."}
{"level":"info","ts":"2021-08-20T14:25:31.305+0800","caller":"raft/raft.go:724","msg":"81193adecc50c687 became candidate at term 4"}
{"level":"info","ts":"2021-08-20T14:25:31.305+0800","caller":"raft/raft.go:835","msg":"81193adecc50c687 received MsgVoteResp from 81193adecc50c687 at term 4"}
{"level":"info","ts":"2021-08-20T14:25:31.305+0800","caller":"raft/raft.go:822","msg":"81193adecc50c687 [logterm: 3, index: 35] sent MsgVote request to 93ccda9956d988f4 at term 4"}
{"level":"info","ts":"2021-08-20T14:25:31.305+0800","caller":"raft/raft.go:822","msg":"81193adecc50c687 [logterm: 3, index: 35] sent MsgVote request to bc0cd14fb32a9f6c at term 4"}
{"level":"info","ts":"2021-08-20T14:25:31.305+0800","caller":"raft/node.go:331","msg":"raft.node: 81193adecc50c687 lost leader bc0cd14fb32a9f6c at term 4"}
{"level":"info","ts":"2021-08-20T14:25:31.306+0800","caller":"raft/raft.go:870","msg":"bc0cd14fb32a9f6c [term: 3] received a MsgVote message with higher term from 81193adecc50c687 [term: 4]"}
{"level":"info","ts":"2021-08-20T14:25:31.306+0800","caller":"raft/raft.go:711","msg":"bc0cd14fb32a9f6c became follower at term 4"}
{"level":"info","ts":"2021-08-20T14:25:31.306+0800","caller":"raft/raft.go:971","msg":"bc0cd14fb32a9f6c [logterm: 3, index: 35, vote: 0] cast MsgVote for 81193adecc50c687 [logterm: 3, index: 35] at term 4"}
{"level":"info","ts":"2021-08-20T14:25:31.306+0800","caller":"raft/node.go:331","msg":"raft.node: bc0cd14fb32a9f6c lost leader bc0cd14fb32a9f6c at term 4"}
{"level":"info","ts":"2021-08-20T14:25:31.307+0800","caller":"raft/raft.go:835","msg":"81193adecc50c687 received MsgVoteResp from bc0cd14fb32a9f6c at term 4"}
{"level":"info","ts":"2021-08-20T14:25:31.307+0800","caller":"raft/raft.go:1319","msg":"81193adecc50c687 has received 2 MsgVoteResp votes and 0 vote rejections"}
{"level":"info","ts":"2021-08-20T14:25:31.307+0800","caller":"raft/raft.go:776","msg":"81193adecc50c687 became leader at term 4"}
{"level":"info","ts":"2021-08-20T14:25:31.307+0800","caller":"raft/node.go:325","msg":"raft.node: 81193adecc50c687 elected leader 81193adecc50c687 at term 4"}
{"level":"info","ts":"2021-08-20T14:25:31.307+0800","caller":"raft/node.go:325","msg":"raft.node: bc0cd14fb32a9f6c elected leader 81193adecc50c687 at term 4"}
2021/08/20 14:25:31.355051 [info] prophet: [prophet-leader/node-2]/keepalive: exit with etcd leader changed
2021/08/20 14:25:31.355082 [error] prophet: [prophet-leader/node-2]/lease: keep lease exit
2021/08/20 14:25:31.355093 [info] prophet: [prophet-leader/node-2]/lease: exit with context done
2021/08/20 14:25:31.373861 [info] [raftstore]: shard 2 raft tick stopped
2021/08/20 14:25:31.394798 [error] prophet: reset leader connection failed with client is closed
2021/08/20 14:25:31.394815 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:31.394838 [error] prophet: client read loop stopped
2021/08/20 14:25:31.394857 [error] prophet: init leader conn failed with dial tcp 127.0.0.1:30000: connect: connection refused, retry later
2021-08-20 14:25:31.405518 I | etcdserver: bc0cd14fb32a9f6c finished leadership transfer from bc0cd14fb32a9f6c to 81193adecc50c687 (took 100.1265ms)
2021-08-20 14:25:31.405567 I | rafthttp: stopped HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:31.405581 I | rafthttp: stopping peer 93ccda9956d988f4...
2021-08-20 14:25:31.405932 I | rafthttp: closed the TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 writer)
2021-08-20 14:25:31.405949 I | rafthttp: stopped streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:31.406204 I | rafthttp: closed the TCP streaming connection with peer 93ccda9956d988f4 (stream Message writer)
2021-08-20 14:25:31.406217 I | rafthttp: stopped streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:31.406232 I | rafthttp: stopped HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:31.406245 I | rafthttp: stopped streaming with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:31.406264 I | rafthttp: stopped streaming with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:31.406268 I | rafthttp: stopped peer 93ccda9956d988f4
2021-08-20 14:25:31.406270 I | rafthttp: stopping peer 81193adecc50c687...
2021-08-20 14:25:31.406371 I | rafthttp: closed the TCP streaming connection with peer 81193adecc50c687 (stream MsgApp v2 writer)
2021-08-20 14:25:31.406382 I | rafthttp: stopped streaming with peer 81193adecc50c687 (writer)
2021-08-20 14:25:31.406509 W | rafthttp: lost the TCP streaming connection with peer bc0cd14fb32a9f6c (stream MsgApp v2 reader)
2021-08-20 14:25:31.406534 W | rafthttp: lost the TCP streaming connection with peer bc0cd14fb32a9f6c (stream Message reader)
2021-08-20 14:25:31.406721 I | rafthttp: closed the TCP streaming connection with peer 81193adecc50c687 (stream Message writer)
2021-08-20 14:25:31.406736 I | rafthttp: stopped streaming with peer 81193adecc50c687 (writer)
2021-08-20 14:25:31.406743 I | rafthttp: stopped HTTP pipelining with peer 81193adecc50c687
2021-08-20 14:25:31.406772 W | rafthttp: lost the TCP streaming connection with peer 81193adecc50c687 (stream MsgApp v2 reader)
2021-08-20 14:25:31.406784 E | rafthttp: failed to read 81193adecc50c687 on stream MsgApp v2 (context canceled)
2021-08-20 14:25:31.406786 I | rafthttp: peer 81193adecc50c687 became inactive (message send to peer failed)
2021-08-20 14:25:31.406793 I | rafthttp: stopped streaming with peer 81193adecc50c687 (stream MsgApp v2 reader)
2021-08-20 14:25:31.406835 W | rafthttp: lost the TCP streaming connection with peer 81193adecc50c687 (stream Message reader)
2021-08-20 14:25:31.406844 I | rafthttp: stopped streaming with peer 81193adecc50c687 (stream Message reader)
2021-08-20 14:25:31.406855 I | rafthttp: stopped peer 81193adecc50c687
2021-08-20 14:25:31.406970 E | rafthttp: failed to find member 81193adecc50c687 in cluster 6a4ade671189dc2f
2021-08-20 14:25:31.407016 E | rafthttp: failed to find member 81193adecc50c687 in cluster 6a4ade671189dc2f
2021-08-20 14:25:31.407070 E | rafthttp: failed to dial bc0cd14fb32a9f6c on stream Message (peer bc0cd14fb32a9f6c failed to find local node 81193adecc50c687)
2021-08-20 14:25:31.407074 I | rafthttp: peer bc0cd14fb32a9f6c became inactive (message send to peer failed)
2021/08/20 14:25:31.416443 [info] [raftstore]: shard 2 handle serve raft stopped
2021/08/20 14:25:31.416476 [info] [raftstore]: handle resource heartbeat resp task stopped
2021/08/20 14:25:31.416480 [info] [raftstore]: raft worker worker 0/0 exit
2021/08/20 14:25:31.416477 [info] [raftstore]: router event loop task stopped
2021/08/20 14:25:31.416484 [info] [raftstore]: timer based tasks stopped
2021/08/20 14:25:31.416520 [info] [transport]: transfer stopped
2021/08/20 14:25:31.416553 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:31.416576 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:31.416582 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:31.416586 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:31.416592 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:31.416594 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:31.416597 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:31.416599 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:31.416601 [info] [transport]: send raft worker stopped
2021/08/20 14:25:31.416613 [error] [transport]: session 1[127.0.0.1:58674] read failed with read tcp 127.0.0.1:10001->127.0.0.1:58674: use of closed network connection
2021/08/20 14:25:31.416622 [error] [transport]: session 2[127.0.0.1:58678] read failed with read tcp 127.0.0.1:10001->127.0.0.1:58678: use of closed network connection
2021/08/20 14:25:31.473919 [info] [raftstore]: shard 2 raft tick stopped
2021-08-20 14:25:31.494700 W | rafthttp: lost the TCP streaming connection with peer 93ccda9956d988f4 (stream Message writer)
2021-08-20 14:25:31.594536 W | rafthttp: failed to process raft message (raft: stopped)
2021/08/20 14:25:31.595753 [error] prophet: reset leader connection failed with client is closed
2021/08/20 14:25:31.595784 [error] prophet: client read loop stopped
2021-08-20 14:25:31.694647 W | rafthttp: failed to process raft message (raft: stopped)
2021-08-20 14:25:31.694735 W | rafthttp: lost the TCP streaming connection with peer bc0cd14fb32a9f6c (stream Message writer)
2021-08-20 14:25:31.794131 W | rafthttp: failed to process raft message (raft: stopped)
2021/08/20 14:25:32.173950 [error] [raftstore]: send store heartbeat failed with client is closed
{"level":"warn","ts":"2021-08-20T14:25:32.417+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-3821bae4-e6fd-4e7b-9c4c-e269c21a5473/127.0.0.1:40002","attempt":0,"error":"rpc error: code = DeadlineExceeded desc = context deadline exceeded"}
2021/08/20 14:25:32.417655 [info] prophet: [prophet-leader/node-2]/lease: close failed with context deadline exceeded
{"level":"warn","ts":"2021-08-20T14:25:32.417+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-3821bae4-e6fd-4e7b-9c4c-e269c21a5473/127.0.0.1:40002","attempt":0,"error":"rpc error: code = Canceled desc = context canceled"}
2021/08/20 14:25:32.417726 [info] prophet: coordinator stops running 
2021/08/20 14:25:32.417748 [info] prophet: coordinator is stopping
2021/08/20 14:25:32.417749 [info] prophet: coordinator has been stopped
2021/08/20 14:25:32.417745 [error] prophet: read /electors/leader/prophet-leader from etcd failed with context canceled
2021/08/20 14:25:32.417753 [error] prophet: [prophet-leader/node-2]/loop: load current leader failed with context canceled, retry later
2021-08-20 14:25:32.417800 W | etcdserver: 81193adecc50c687 failed to transfer leadership (etcdserver: unhealthy cluster)
2021-08-20 14:25:32.417833 W | etcdserver: read-only range request "key:\"/electors/leader/prophet-leader\" " with result "error:context canceled" took too long (961.5534ms) to execute
WARNING: 2021/08/20 14:25:32 grpc: Server.processUnaryRPC failed to write status: connection error: desc = "transport is closing"
2021-08-20 14:25:32.417953 I | rafthttp: stopped HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:32.417983 I | rafthttp: stopped HTTP pipelining with peer bc0cd14fb32a9f6c
2021-08-20 14:25:32.417994 I | rafthttp: stopping peer 93ccda9956d988f4...
2021-08-20 14:25:32.418369 I | rafthttp: closed the TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 writer)
2021-08-20 14:25:32.418382 I | rafthttp: stopped streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:32.418405 I | rafthttp: stopped streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:32.418413 I | rafthttp: stopped HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:32.418418 I | rafthttp: stopped streaming with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:32.418421 I | rafthttp: stopped streaming with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:32.418442 I | rafthttp: stopped peer 93ccda9956d988f4
2021-08-20 14:25:32.418445 I | rafthttp: stopping peer bc0cd14fb32a9f6c...
2021-08-20 14:25:32.418675 I | rafthttp: closed the TCP streaming connection with peer bc0cd14fb32a9f6c (stream MsgApp v2 writer)
2021-08-20 14:25:32.418686 I | rafthttp: stopped streaming with peer bc0cd14fb32a9f6c (writer)
2021-08-20 14:25:32.418696 I | rafthttp: stopped streaming with peer bc0cd14fb32a9f6c (writer)
2021-08-20 14:25:32.418709 I | rafthttp: stopped HTTP pipelining with peer bc0cd14fb32a9f6c
2021-08-20 14:25:32.418724 I | rafthttp: stopped streaming with peer bc0cd14fb32a9f6c (stream MsgApp v2 reader)
2021-08-20 14:25:32.418727 I | rafthttp: stopped streaming with peer bc0cd14fb32a9f6c (stream Message reader)
2021-08-20 14:25:32.418728 I | rafthttp: stopped peer bc0cd14fb32a9f6c
2021/08/20 14:25:32.419974 [info] [raftstore]: router event loop task stopped
2021/08/20 14:25:32.419979 [info] [raftstore]: raft worker worker 0/0 exit
2021/08/20 14:25:32.419980 [info] [raftstore]: timer based tasks stopped
2021/08/20 14:25:32.419979 [info] [raftstore]: handle resource heartbeat resp task stopped
2021/08/20 14:25:32.420035 [info] [transport]: send raft worker stopped
2021/08/20 14:25:32.420047 [info] [transport]: transfer stopped
2021/08/20 14:25:32.420049 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:32.420056 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:32.420067 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:32.420069 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:32.420071 [info] [transport]: send snapshot worker stopped
--- PASS: TestIssue90 (14.06s)
=== RUN   TestIssue133
2021/08/20 14:25:32.420091 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:32.420098 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:32.420100 [info] [transport]: send snapshot worker stopped
2021/08/20 14:25:32.420757 [info] prophet: prophet logger set
2021/08/20 14:25:32.421231 [info] [raftstore]: start scan gc snap files
2021/08/20 14:25:32.421503 [info] [raftstore]: start scan gc snap files
2021/08/20 14:25:32.421663 [info] [raftstore]: begin start raftstore
2021/08/20 14:25:32.421675 [info] [raftstore]: begin to start prophet
[WARNING] Deprecated '--logger=capnslog' flag is set; use '--logger=zap' flag instead
2021/08/20 14:25:32.421709 [info] [raftstore]: start scan gc snap files
2021-08-20 14:25:32.421712 I | embed: pprof is enabled under /debug/pprof
2021-08-20 14:25:32.421779 I | embed: name = node-0
2021-08-20 14:25:32.421793 I | embed: data dir = /tmp/cube/node-0/prophet
2021-08-20 14:25:32.421795 I | embed: member dir = /tmp/cube/node-0/prophet/member
2021-08-20 14:25:32.421797 I | embed: heartbeat = 100ms
2021-08-20 14:25:32.421798 I | embed: election = 3000ms
2021-08-20 14:25:32.421799 I | embed: snapshot count = 100000
2021-08-20 14:25:32.421802 I | embed: advertise client URLs = http://127.0.0.1:40000
2021-08-20 14:25:32.426481 I | etcdserver: starting member 93ccda9956d988f4 in cluster 6a4ade671189dc2f
{"level":"info","ts":"2021-08-20T14:25:32.426+0800","caller":"raft/raft.go:1550","msg":"93ccda9956d988f4 switched to configuration voters=()"}
{"level":"info","ts":"2021-08-20T14:25:32.426+0800","caller":"raft/raft.go:711","msg":"93ccda9956d988f4 became follower at term 0"}
{"level":"info","ts":"2021-08-20T14:25:32.426+0800","caller":"raft/raft.go:388","msg":"newRaft 93ccda9956d988f4 [peers: [], term: 0, commit: 0, applied: 0, lastindex: 0, lastterm: 0]"}
{"level":"info","ts":"2021-08-20T14:25:32.426+0800","caller":"raft/raft.go:711","msg":"93ccda9956d988f4 became follower at term 1"}
{"level":"info","ts":"2021-08-20T14:25:32.426+0800","caller":"raft/raft.go:1550","msg":"93ccda9956d988f4 switched to configuration voters=(10650127570946328820)"}
2021-08-20 14:25:32.428243 W | auth: simple token is not cryptographically signed
2021-08-20 14:25:32.431282 I | etcdserver: starting server... [version: 3.4.15, cluster version: to_be_decided]
2021-08-20 14:25:32.431378 I | etcdserver: 93ccda9956d988f4 as single-node; fast-forwarding 29 ticks (election ticks 30)
{"level":"info","ts":"2021-08-20T14:25:32.431+0800","caller":"raft/raft.go:1550","msg":"93ccda9956d988f4 switched to configuration voters=(10650127570946328820)"}
2021-08-20 14:25:32.431533 I | etcdserver/membership: added member 93ccda9956d988f4 [http://127.0.0.1:50000] to cluster 6a4ade671189dc2f
2021-08-20 14:25:32.431632 I | embed: listening for peers on 127.0.0.1:50000
2021/08/20 14:25:32.518308 [info] prophet: [prophet-leader/node-2]/loop: exit
2021/08/20 14:25:34.229919 [info] prophet: [prophet-leader/node-1]/loop: exit
{"level":"info","ts":"2021-08-20T14:25:35.427+0800","caller":"raft/raft.go:934","msg":"93ccda9956d988f4 is starting a new election at term 1"}
{"level":"info","ts":"2021-08-20T14:25:35.427+0800","caller":"raft/raft.go:724","msg":"93ccda9956d988f4 became candidate at term 2"}
{"level":"info","ts":"2021-08-20T14:25:35.427+0800","caller":"raft/raft.go:835","msg":"93ccda9956d988f4 received MsgVoteResp from 93ccda9956d988f4 at term 2"}
{"level":"info","ts":"2021-08-20T14:25:35.427+0800","caller":"raft/raft.go:776","msg":"93ccda9956d988f4 became leader at term 2"}
{"level":"info","ts":"2021-08-20T14:25:35.427+0800","caller":"raft/node.go:325","msg":"raft.node: 93ccda9956d988f4 elected leader 93ccda9956d988f4 at term 2"}
2021-08-20 14:25:35.427382 I | etcdserver: setting up the initial cluster version to 3.4
2021-08-20 14:25:35.428080 N | etcdserver/membership: set the initial cluster version to 3.4
2021-08-20 14:25:35.428107 I | etcdserver: published {Name:node-0 ClientURLs:[http://127.0.0.1:40000]} to cluster 6a4ade671189dc2f
2021-08-20 14:25:35.428129 I | embed: ready to serve client requests
2021/08/20 14:25:35.428132 [info] prophet: create etcd v3 client with endpoints [http://127.0.0.1:40000]
2021-08-20 14:25:35.428458 N | embed: serving insecure client requests on 127.0.0.1:40000, this is strongly discouraged!
2021/08/20 14:25:35.429286 [info] prophet: net application started
2021/08/20 14:25:35.429316 [info] prophet: start system time monitor 
2021/08/20 14:25:35.429732 [info] prophet: [prophet-leader/node-0]/loop: current leader is []
2021/08/20 14:25:35.429948 [info] prophet: [prophet-leader/node-0]/campaign: load expect leader: []
2021/08/20 14:25:35.429957 [info] prophet: [prophet-leader/node-0]/campaign: start
2021/08/20 14:25:35.430207 [info] prophet: [prophet-leader/node-0]/campaign: grant lease ok
2021/08/20 14:25:35.430698 [info] prophet: [prophet-leader/node-0]/campaign: completed, start keepalive
2021/08/20 14:25:35.430717 [info] prophet: ********node-0 become to leader now********
2021/08/20 14:25:35.431140 [info] prophet: load 0 containers, cost 188.2µs
2021/08/20 14:25:35.431366 [info] prophet: load 0 resources, cost 213µs
2021/08/20 14:25:35.432111 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:35.432122 [info] prophet: coordinator starts to collect cluster information 
2021/08/20 14:25:35.432125 [info] prophet: coordinator has finished cluster information preparation 
2021/08/20 14:25:35.432126 [info] prophet: coordinator starts to run schedulers 
2021/08/20 14:25:35.432128 [info] prophet: client read loop started 
2021/08/20 14:25:35.432133 [info] prophet: client started
2021/08/20 14:25:35.432137 [info] [raftstore]: *********Become prophet leader*********
2021/08/20 14:25:35.432138 [info] [raftstore]: begin to bootstrap the cluster
2021/08/20 14:25:35.432154 [info] [raftstore]: raftstore init with store raftAddr:"127.0.0.1:10000" clientAddr:"127.0.0.1:20000" labels:<key:"c" value:"0" > startTime:1629440735 deployPath:"not set" 
2021/08/20 14:25:35.432165 [info] [raftstore]: begin to create local store metadata
2021/08/20 14:25:35.432171 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:35.432174 [info] prophet: client read loop actived, ready to read from leader
2021/08/20 14:25:35.432179 [info] prophet: session 1[127.0.0.1:39026] connected
2021/08/20 14:25:35.432487 [info] prophet: load 0 jobs
2021/08/20 14:25:35.432799 [info] [raftstore]: create local store with id 1
2021/08/20 14:25:35.433262 [info] [raftstore]: the cluster already bootstrap: false
2021/08/20 14:25:35.433279 [info] [raftstore]: begin to bootstrap the cluster with init shards
2021/08/20 14:25:35.433301 [info] prophet: coordinator begins to actively drive push operator 
2021/08/20 14:25:35.433316 [info] prophet: coordinator starts patrol resources 
2021/08/20 14:25:35.433659 [info] [raftstore]: create init shard id:2 start:"a" end:"b" epoch:<confVer:1 version:1 > peers:<id:3 containerID:1 > 
2021/08/20 14:25:35.433675 [info] [raftstore]: create init shard id:4 start:"b" end:"c" epoch:<confVer:1 version:1 > peers:<id:5 containerID:1 > 
2021/08/20 14:25:35.433681 [info] [raftstore]: create init shard id:6 start:"c" end:"d" epoch:<confVer:1 version:1 > peers:<id:7 containerID:1 > 
2021/08/20 14:25:35.434898 [info] prophet: container 1 limit added
2021/08/20 14:25:35.434950 [info] [raftstore]: prophet started
2021/08/20 14:25:35.434978 [info] prophet: container 1 heartbeat stream binded
2021/08/20 14:25:35.435020 [info] [transport]: net application started
2021/08/20 14:25:35.435023 [info] [raftstore]: start listen at 127.0.0.1:10000 for raft
2021/08/20 14:25:35.435027 [info] [raftstore]: raft shards workers started
2021/08/20 14:25:35.435040 [info] [raftstore]: shard 2 init with raft local state {HardState:{Term:5 Vote:0 Commit:5 XXX_unrecognized:[]} LastIndex:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.435055 [info] [raftstore]: shard 2 init raft apply state, state=<{AppliedIndex:5 TruncatedState:{Index:5 Term:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:35.435056 [info] [raftstore]: shard 2 init last term, last term=<5>
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:1550","msg":"3 switched to configuration voters=(3)"}
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:711","msg":"3 became follower at term 5"}
2021/08/20 14:25:35.435098 [info] [raftstore]: raft worker 0/0 start
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:388","msg":"newRaft 3 [peers: [3], term: 5, commit: 5, applied: 5, lastindex: 5, lastterm: 5]"}
2021/08/20 14:25:35.435106 [info] [raftstore]: shard 2 try to campaign leader, because only self
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:934","msg":"3 is starting a new election at term 5"}
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:724","msg":"3 became candidate at term 6"}
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:835","msg":"3 received MsgVoteResp from 3 at term 6"}
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:776","msg":"3 became leader at term 6"}
2021/08/20 14:25:35.435150 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 add registration job by startShards
2021/08/20 14:25:35.435167 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 add registration job by startShards, completed
2021/08/20 14:25:35.435187 [info] [raftstore]: shard 2 peer 3 raft 3 added, epoch {ConfVer:1 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:35.435192 [info] [raftstore]: shard 4 init with raft local state {HardState:{Term:5 Vote:0 Commit:5 XXX_unrecognized:[]} LastIndex:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.435198 [info] [raftstore]: shard 4 init raft apply state, state=<{AppliedIndex:5 TruncatedState:{Index:5 Term:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:35.435200 [info] [raftstore]: shard 4 init last term, last term=<5>
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:1550","msg":"5 switched to configuration voters=(5)"}
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:711","msg":"5 became follower at term 5"}
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:388","msg":"newRaft 5 [peers: [5], term: 5, commit: 5, applied: 5, lastindex: 5, lastterm: 5]"}
2021/08/20 14:25:35.435231 [info] [raftstore]: shard 4 try to campaign leader, because only self
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:934","msg":"5 is starting a new election at term 5"}
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:724","msg":"5 became candidate at term 6"}
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:835","msg":"5 received MsgVoteResp from 5 at term 6"}
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:776","msg":"5 became leader at term 6"}
2021/08/20 14:25:35.435252 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 5 add registration job by startShards
2021/08/20 14:25:35.435265 [info] [raftstore]: shard 4 peer 5 raft 5 added, epoch {ConfVer:1 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:5 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:35.435270 [info] [raftstore]: shard 6 init with raft local state {HardState:{Term:5 Vote:0 Commit:5 XXX_unrecognized:[]} LastIndex:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.435272 [info] [raftstore]: shard 6 init raft apply state, state=<{AppliedIndex:5 TruncatedState:{Index:5 Term:5 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:35.435273 [info] [raftstore]: shard 6 init last term, last term=<5>
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:1550","msg":"7 switched to configuration voters=(7)"}
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:711","msg":"7 became follower at term 5"}
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:388","msg":"newRaft 7 [peers: [7], term: 5, commit: 5, applied: 5, lastindex: 5, lastterm: 5]"}
2021/08/20 14:25:35.435301 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 5 add registration job by startShards, completed
2021/08/20 14:25:35.435306 [info] [raftstore]: shard 6 try to campaign leader, because only self
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:934","msg":"7 is starting a new election at term 5"}
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:724","msg":"7 became candidate at term 6"}
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:835","msg":"7 received MsgVoteResp from 7 at term 6"}
{"level":"info","ts":"2021-08-20T14:25:35.435+0800","caller":"raft/raft.go:776","msg":"7 became leader at term 6"}
2021/08/20 14:25:35.435332 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 7 add registration job by startShards
2021/08/20 14:25:35.435343 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 7 add registration job by startShards, completed
2021/08/20 14:25:35.435348 [info] [raftstore]: shard 6 peer 7 raft 7 added, epoch {ConfVer:1 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:7 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:35.435349 [info] [raftstore]: starts with 3 shards, including 0 tombstones and 0 applying shards
2021/08/20 14:25:35.435350 [info] [raftstore]: cleanup possible garbage data complete
2021/08/20 14:25:35.435351 [info] [raftstore]: shards started
2021/08/20 14:25:35.435352 [info] [raftstore]: shard timer based tasks started
2021/08/20 14:25:35.435358 [info] [raftstore]: net application started
2021/08/20 14:25:35.435367 [info] [raftstore]: start listen at 127.0.0.1:20000 for client
2021/08/20 14:25:35.435378 [info] [raftstore]: router started
2021/08/20 14:25:35.435384 [info] [raftstore]: shard 2 ********become leader now********
2021/08/20 14:25:35.435412 [info] [raftstore]: shard 4 ********become leader now********
2021/08/20 14:25:35.435421 [info] [raftstore]: router event loop task started
2021/08/20 14:25:35.435422 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:35.435443 [info] [raftstore]: shard 6 ********become leader now********
2021/08/20 14:25:35.435462 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 6
2021/08/20 14:25:35.435468 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 5 AdvanceApply with 6
2021/08/20 14:25:35.435503 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:35.435522 [info] prophet: watcher init leader connection 127.0.0.1:30000 succeed
2021/08/20 14:25:35.435518 [info] prophet: session 2[127.0.0.1:39028] connected
2021/08/20 14:25:35.435580 [info] prophet: new watcher 127.0.0.1:39028 added
2021/08/20 14:25:35.435648 [info] [raftstore]: start init event
2021/08/20 14:25:35.438242 [info] [raftstore]: begin start raftstore
2021/08/20 14:25:35.438253 [info] [raftstore]: begin to start prophet
{"level":"info","ts":"2021-08-20T14:25:35.438+0800","caller":"raft/raft.go:1550","msg":"93ccda9956d988f4 switched to configuration voters=(10650127570946328820 17046132772827027361)"}
2021-08-20 14:25:35.438988 I | etcdserver/membership: added member ec9007714e7fd7a1 [http://127.0.0.1:50001] to cluster 6a4ade671189dc2f
2021-08-20 14:25:35.439002 I | rafthttp: starting peer ec9007714e7fd7a1...
2021-08-20 14:25:35.439025 I | rafthttp: started HTTP pipelining with peer ec9007714e7fd7a1
2021-08-20 14:25:35.439449 I | rafthttp: started streaming with peer ec9007714e7fd7a1 (writer)
2021-08-20 14:25:35.439569 I | rafthttp: started streaming with peer ec9007714e7fd7a1 (writer)
2021-08-20 14:25:35.439625 I | rafthttp: started peer ec9007714e7fd7a1
2021-08-20 14:25:35.439640 I | rafthttp: added peer ec9007714e7fd7a1
2021-08-20 14:25:35.439649 I | rafthttp: started streaming with peer ec9007714e7fd7a1 (stream MsgApp v2 reader)
2021-08-20 14:25:35.439713 I | rafthttp: started streaming with peer ec9007714e7fd7a1 (stream Message reader)
[WARNING] Deprecated '--logger=capnslog' flag is set; use '--logger=zap' flag instead
2021-08-20 14:25:35.439924 I | embed: pprof is enabled under /debug/pprof
2021-08-20 14:25:35.439960 I | embed: name = node-1
2021-08-20 14:25:35.439970 I | embed: data dir = /tmp/cube/node-1/prophet
2021-08-20 14:25:35.439972 I | embed: member dir = /tmp/cube/node-1/prophet/member
2021-08-20 14:25:35.439974 I | embed: heartbeat = 100ms
2021-08-20 14:25:35.439975 I | embed: election = 3000ms
2021-08-20 14:25:35.439976 I | embed: snapshot count = 100000
2021-08-20 14:25:35.439979 I | embed: advertise client URLs = http://127.0.0.1:40001
2021-08-20 14:25:35.445245 I | etcdserver: starting member ec9007714e7fd7a1 in cluster 6a4ade671189dc2f
{"level":"info","ts":"2021-08-20T14:25:35.445+0800","caller":"raft/raft.go:1550","msg":"ec9007714e7fd7a1 switched to configuration voters=()"}
{"level":"info","ts":"2021-08-20T14:25:35.445+0800","caller":"raft/raft.go:711","msg":"ec9007714e7fd7a1 became follower at term 0"}
{"level":"info","ts":"2021-08-20T14:25:35.445+0800","caller":"raft/raft.go:388","msg":"newRaft ec9007714e7fd7a1 [peers: [], term: 0, commit: 0, applied: 0, lastindex: 0, lastterm: 0]"}
2021/08/20 14:25:35.445309 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 7 AdvanceApply with 6
2021-08-20 14:25:35.447109 W | auth: simple token is not cryptographically signed
2021-08-20 14:25:35.450557 I | rafthttp: started HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:35.450581 I | rafthttp: starting peer 93ccda9956d988f4...
2021-08-20 14:25:35.450609 I | rafthttp: started HTTP pipelining with peer 93ccda9956d988f4
2021-08-20 14:25:35.450819 I | rafthttp: started streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:35.451194 I | rafthttp: started streaming with peer 93ccda9956d988f4 (writer)
2021-08-20 14:25:35.452677 I | rafthttp: started peer 93ccda9956d988f4
2021-08-20 14:25:35.452696 I | rafthttp: added peer 93ccda9956d988f4
2021-08-20 14:25:35.452698 I | rafthttp: started streaming with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:35.452710 I | rafthttp: started streaming with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:35.452773 I | etcdserver: starting server... [version: 3.4.15, cluster version: to_be_decided]
2021-08-20 14:25:35.452938 I | rafthttp: peer 93ccda9956d988f4 became active
2021-08-20 14:25:35.452956 I | rafthttp: peer ec9007714e7fd7a1 became active
2021-08-20 14:25:35.452962 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 reader)
2021-08-20 14:25:35.452965 I | rafthttp: established a TCP streaming connection with peer ec9007714e7fd7a1 (stream Message writer)
2021-08-20 14:25:35.453035 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream Message reader)
2021-08-20 14:25:35.453057 I | rafthttp: established a TCP streaming connection with peer ec9007714e7fd7a1 (stream MsgApp v2 writer)
2021-08-20 14:25:35.453114 I | embed: listening for peers on 127.0.0.1:50001
{"level":"info","ts":"2021-08-20T14:25:35.453+0800","caller":"raft/raft.go:870","msg":"ec9007714e7fd7a1 [term: 0] received a MsgApp message with higher term from 93ccda9956d988f4 [term: 2]"}
{"level":"info","ts":"2021-08-20T14:25:35.453+0800","caller":"raft/raft.go:711","msg":"ec9007714e7fd7a1 became follower at term 2"}
{"level":"info","ts":"2021-08-20T14:25:35.453+0800","caller":"raft/node.go:325","msg":"raft.node: ec9007714e7fd7a1 elected leader 93ccda9956d988f4 at term 2"}
{"level":"info","ts":"2021-08-20T14:25:35.454+0800","caller":"raft/raft.go:1550","msg":"ec9007714e7fd7a1 switched to configuration voters=(10650127570946328820)"}
2021-08-20 14:25:35.454233 I | etcdserver/membership: added member 93ccda9956d988f4 [http://127.0.0.1:50000] to cluster 6a4ade671189dc2f
2021-08-20 14:25:35.454283 N | etcdserver/membership: set the initial cluster version to 3.4
{"level":"info","ts":"2021-08-20T14:25:35.454+0800","caller":"raft/raft.go:1550","msg":"ec9007714e7fd7a1 switched to configuration voters=(10650127570946328820 17046132772827027361)"}
2021-08-20 14:25:35.454775 I | etcdserver/membership: added member ec9007714e7fd7a1 [http://127.0.0.1:50001] to cluster 6a4ade671189dc2f
2021-08-20 14:25:35.456107 I | etcdserver: published {Name:node-1 ClientURLs:[http://127.0.0.1:40001]} to cluster 6a4ade671189dc2f
2021-08-20 14:25:35.456121 I | embed: ready to serve client requests
2021/08/20 14:25:35.456129 [info] prophet: create etcd v3 client with endpoints [http://127.0.0.1:40001]
2021-08-20 14:25:35.456320 N | embed: serving insecure client requests on 127.0.0.1:40001, this is strongly discouraged!
2021/08/20 14:25:35.457041 [info] prophet: net application started
2021/08/20 14:25:35.457081 [info] prophet: start system time monitor 
2021/08/20 14:25:35.457458 [info] prophet: [prophet-leader/node-1]/loop: current leader is [涕Ӷnode-0127.0.0.1:30000]
2021/08/20 14:25:35.457470 [info] prophet: [prophet-leader/node-1]/loop: start watch leader 涕Ӷnode-0127.0.0.1:30000
2021/08/20 14:25:35.457472 [info] prophet: ********node-1 become to follower now********
2021/08/20 14:25:35.457487 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:35.457489 [info] prophet: client started
2021/08/20 14:25:35.457492 [info] prophet: client read loop started 
2021/08/20 14:25:35.457493 [info] [raftstore]: *********Become prophet follower*********
2021/08/20 14:25:35.457519 [info] [raftstore]: begin to bootstrap the cluster
2021/08/20 14:25:35.457531 [info] [raftstore]: raftstore init with store raftAddr:"127.0.0.1:10001" clientAddr:"127.0.0.1:20001" labels:<key:"c" value:"1" > startTime:1629440735 deployPath:"not set" 
2021/08/20 14:25:35.457533 [info] [raftstore]: begin to create local store metadata
2021/08/20 14:25:35.457542 [info] prophet: session 3[127.0.0.1:39058] connected
2021/08/20 14:25:35.457546 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:35.457586 [info] prophet: client read loop actived, ready to read from leader
2021/08/20 14:25:35.457645 [info] [raftstore]: create local store with id 9
2021/08/20 14:25:35.458159 [info] [raftstore]: the cluster already bootstrap: true
2021/08/20 14:25:35.460431 [info] prophet: container 9 limit added
2021/08/20 14:25:35.460481 [info] [raftstore]: prophet started
2021/08/20 14:25:35.460501 [info] prophet: container 9 heartbeat stream binded
2021/08/20 14:25:35.460525 [info] [transport]: net application started
2021/08/20 14:25:35.460534 [info] [raftstore]: start listen at 127.0.0.1:10001 for raft
2021/08/20 14:25:35.460536 [info] [raftstore]: raft shards workers started
2021/08/20 14:25:35.460539 [info] [raftstore]: starts with 0 shards, including 0 tombstones and 0 applying shards
2021/08/20 14:25:35.460540 [info] [raftstore]: cleanup possible garbage data complete
2021/08/20 14:25:35.460541 [info] [raftstore]: shards started
2021/08/20 14:25:35.460542 [info] [raftstore]: shard timer based tasks started
2021/08/20 14:25:35.460546 [info] [raftstore]: net application started
2021/08/20 14:25:35.460547 [info] [raftstore]: start listen at 127.0.0.1:20001 for client
2021/08/20 14:25:35.460553 [info] [raftstore]: router started
2021/08/20 14:25:35.460589 [info] [raftstore]: raft worker 0/0 start
2021/08/20 14:25:35.460592 [info] prophet: client start init connection to leader 127.0.0.1:30000
2021/08/20 14:25:35.460594 [info] [raftstore]: router event loop task started
2021/08/20 14:25:35.460649 [info] prophet: client start connect to leader 127.0.0.1:30000
2021/08/20 14:25:35.460651 [info] prophet: watcher init leader connection 127.0.0.1:30000 succeed
2021/08/20 14:25:35.460667 [info] prophet: session 4[127.0.0.1:39060] connected
2021/08/20 14:25:35.460690 [info] prophet: new watcher 127.0.0.1:39060 added
2021/08/20 14:25:35.460756 [info] [raftstore]: start init event
2021/08/20 14:25:35.461944 [info] [raftstore]: begin start raftstore
2021/08/20 14:25:35.461957 [info] [raftstore]: begin to start prophet
2021-08-20 14:25:35.462426 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:9c2555697317caf4 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:35.462+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-5893ad94-827a-4a7c-8f02-d691ed8b1d2e/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:35.462517 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:35.534335 [info] prophet: resource 2 add operator add-rule-peer {add peer: container [9]} (kind:resource,replica, resource:2(1,1), createAt:2021-08-20 14:25:35.5343127 +0800 CST m=+31.067839301, startAt:0001-01-01 00:00:00 +0000 UTC, currentStep:0, steps:[add learner peer 10 on container 9, promote learner peer 10 on container 9 to voter]), 
2021/08/20 14:25:35.534358 [info] prophet: resource 2 send schedule command, step add learner peer 10 on container 9, source create
2021/08/20 14:25:35.534397 [info] prophet: resource 4 add operator add-rule-peer {add peer: container [9]} (kind:resource,replica, resource:4(1,1), createAt:2021-08-20 14:25:35.5343892 +0800 CST m=+31.067915801, startAt:0001-01-01 00:00:00 +0000 UTC, currentStep:0, steps:[add learner peer 11 on container 9, promote learner peer 11 on container 9 to voter]), 
2021/08/20 14:25:35.534412 [info] prophet: resource 4 send schedule command, step add learner peer 11 on container 9, source create
2021/08/20 14:25:35.534439 [info] prophet: resource 6 add operator add-rule-peer {add peer: container [9]} (kind:resource,replica, resource:6(1,1), createAt:2021-08-20 14:25:35.5344314 +0800 CST m=+31.067958001, startAt:0001-01-01 00:00:00 +0000 UTC, currentStep:0, steps:[add learner peer 12 on container 9, promote learner peer 12 on container 9 to voter]), 
2021/08/20 14:25:35.534453 [info] prophet: resource 6 send schedule command, step add learner peer 12 on container 9, source create
2021/08/20 14:25:35.534546 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:10 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.534566 [info] [raftstore]: shard-4 AddLearnerNode peer {ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.534570 [info] [raftstore]: shard-6 AddLearnerNode peer {ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.535640 [info] [raftstore]: shard-2 propose conf change peer [{ChangeType:AddLearnerNode Peer:{ID:10 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.535698 [info] [raftstore]: shard-4 propose conf change peer [{ChangeType:AddLearnerNode Peer:{ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.535724 [info] [raftstore]: shard-6 propose conf change peer [{ChangeType:AddLearnerNode Peer:{ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.535780 [info] [raftstore]: shard 2 do apply change peer changeType:AddLearnerNode peer:<id:10 containerID:9 role:Learner >  at epoch {ConfVer:1 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.535797 [info] [raftstore]: shard-2 add learner peer {ID:10 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} successfully, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:10 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.535816 [info] [raftstore]: shard 4 do apply change peer changeType:AddLearnerNode peer:<id:11 containerID:9 role:Learner >  at epoch {ConfVer:1 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:5 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.535828 [info] [raftstore]: shard-4 add learner peer {ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} successfully, peers [{ID:5 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.535839 [info] [raftstore]: shard 6 do apply change peer changeType:AddLearnerNode peer:<id:12 containerID:9 role:Learner >  at epoch {ConfVer:1 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:7 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.535851 [info] [raftstore]: shard-6 add learner peer {ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} successfully, peers [{ID:7 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.535842 [info] prophet: resource 2 send schedule command, step add learner peer 10 on container 9, source heartbeat
2021/08/20 14:25:35.535905 [info] prophet: resource 4 send schedule command, step add learner peer 11 on container 9, source heartbeat
2021/08/20 14:25:35.535923 [info] prophet: resource 6 send schedule command, step add learner peer 12 on container 9, source heartbeat
2021/08/20 14:25:35.535968 [info] [raftstore]: shard-2 AddLearnerNode peer {ID:10 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.535987 [info] [raftstore]: shard-4 AddLearnerNode peer {ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.536010 [info] [raftstore]: shard-6 AddLearnerNode peer {ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021-08-20 14:25:35.540622 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream Message writer)
2021-08-20 14:25:35.540644 I | rafthttp: established a TCP streaming connection with peer ec9007714e7fd7a1 (stream Message reader)
2021-08-20 14:25:35.540652 I | rafthttp: established a TCP streaming connection with peer ec9007714e7fd7a1 (stream MsgApp v2 reader)
2021-08-20 14:25:35.540697 I | rafthttp: established a TCP streaming connection with peer 93ccda9956d988f4 (stream MsgApp v2 writer)
2021/08/20 14:25:35.546182 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 7
{"level":"info","ts":"2021-08-20T14:25:35.546+0800","caller":"raft/raft.go:1550","msg":"3 switched to configuration voters=(3) learners=(10)"}
2021/08/20 14:25:35.546252 [info] [raftstore]: shard 2 notify pd with {Transition:ConfChangeTransitionAuto Changes:[{Type:ConfChangeAddLearnerNode NodeID:10 XXX_unrecognized:[]}] Context:[10 32 10 16 127 131 43 74 48 63 70 130 186 151 11 226 78 41 215 201 16 2 26 4 8 3 16 1 42 4 8 1 16 1 26 14 8 1 18 10 8 3 18 6 8 10 16 9 24 1] XXX_unrecognized:[]} with changes [{ChangeType:AddLearnerNode Peer:{ID:10 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.546274 [info] [raftstore]: shard 2 applied changes [{ChangeType:AddLearnerNode Peer:{ID:10 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, new peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:10 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.546298 [info] [raftstore]: shard-2 propose conf change peer [{ChangeType:AddLearnerNode Peer:{ID:10 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.546441 [info] [raftstore]: shard 2 do apply change peer changeType:AddLearnerNode peer:<id:10 containerID:9 role:Learner >  at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:10 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.546467 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 5 AdvanceApply with 7
{"level":"info","ts":"2021-08-20T14:25:35.546+0800","caller":"raft/raft.go:1550","msg":"5 switched to configuration voters=(5) learners=(11)"}
2021/08/20 14:25:35.546510 [info] [raftstore]: shard 4 notify pd with {Transition:ConfChangeTransitionAuto Changes:[{Type:ConfChangeAddLearnerNode NodeID:11 XXX_unrecognized:[]}] Context:[10 32 10 16 96 87 20 140 107 7 78 137 143 186 37 0 219 102 195 66 16 4 26 4 8 5 16 1 42 4 8 1 16 1 26 14 8 1 18 10 8 3 18 6 8 11 16 9 24 1] XXX_unrecognized:[]} with changes [{ChangeType:AddLearnerNode Peer:{ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.546519 [info] [raftstore]: shard 4 applied changes [{ChangeType:AddLearnerNode Peer:{ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, new peers [{ID:5 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.546543 [info] [raftstore]: shard-4 propose conf change peer [{ChangeType:AddLearnerNode Peer:{ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.546560 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 7 AdvanceApply with 7
{"level":"info","ts":"2021-08-20T14:25:35.546+0800","caller":"raft/raft.go:1550","msg":"7 switched to configuration voters=(7) learners=(12)"}
2021/08/20 14:25:35.546589 [info] [raftstore]: shard 6 notify pd with {Transition:ConfChangeTransitionAuto Changes:[{Type:ConfChangeAddLearnerNode NodeID:12 XXX_unrecognized:[]}] Context:[10 32 10 16 37 206 177 7 153 146 74 237 137 98 95 131 160 193 225 96 16 6 26 4 8 7 16 1 42 4 8 1 16 1 26 14 8 1 18 10 8 3 18 6 8 12 16 9 24 1] XXX_unrecognized:[]} with changes [{ChangeType:AddLearnerNode Peer:{ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.546607 [info] [raftstore]: shard 6 applied changes [{ChangeType:AddLearnerNode Peer:{ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, new peers [{ID:7 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.546618 [info] [raftstore]: shard-6 propose conf change peer [{ChangeType:AddLearnerNode Peer:{ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.546641 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 8
2021/08/20 14:25:35.546621 [info] prophet: resource 2 ConfVer changed from 1 to 2
2021/08/20 14:25:35.546662 [info] [raftstore]: shard 4 do apply change peer changeType:AddLearnerNode peer:<id:11 containerID:9 role:Learner >  at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:5 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.546780 [info] [raftstore]: shard 6 do apply change peer changeType:AddLearnerNode peer:<id:12 containerID:9 role:Learner >  at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:7 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.546780 [info] [transport]: connected to store 9
2021/08/20 14:25:35.546799 [info] [transport]: session 1[127.0.0.1:58950] connected
2021/08/20 14:25:35.546859 [info] [raftstore]: shard 2 target peer doesn't exist, peer=<{ID:10 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}> message=<MsgApp>
2021/08/20 14:25:35.546876 [info] [raftstore]: shard 2 replicate peer {ID:10 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.546893 [info] [raftstore]: shard 2 init with raft local state {HardState:{Term:0 Vote:0 Commit:0 XXX_unrecognized:[]} LastIndex:0 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.546906 [info] [raftstore]: shard 2 init raft apply state, state=<{AppliedIndex:0 TruncatedState:{Index:0 Term:0 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:35.546907 [info] [raftstore]: shard 2 init last term, last term=<0>
{"level":"info","ts":"2021-08-20T14:25:35.546+0800","caller":"raft/raft.go:1550","msg":"a switched to configuration voters=()"}
{"level":"info","ts":"2021-08-20T14:25:35.546+0800","caller":"raft/raft.go:711","msg":"a became follower at term 0"}
{"level":"info","ts":"2021-08-20T14:25:35.546+0800","caller":"raft/raft.go:388","msg":"newRaft a [peers: [], term: 0, commit: 0, applied: 0, lastindex: 0, lastterm: 0]"}
2021/08/20 14:25:35.546963 [info] [raftstore]: shard 2 peer 10 raft a added, epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:10 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:35.546981 [info] [raftstore]: shard 4 target peer doesn't exist, peer=<{ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}> message=<MsgApp>
2021/08/20 14:25:35.546986 [info] [raftstore]: shard 4 replicate peer {ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.546989 [info] [raftstore]: shard 4 init with raft local state {HardState:{Term:0 Vote:0 Commit:0 XXX_unrecognized:[]} LastIndex:0 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.546992 [info] [raftstore]: shard 4 init raft apply state, state=<{AppliedIndex:0 TruncatedState:{Index:0 Term:0 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:35.546993 [info] [raftstore]: shard 4 init last term, last term=<0>
{"level":"info","ts":"2021-08-20T14:25:35.546+0800","caller":"raft/raft.go:870","msg":"a [term: 0] received a MsgHeartbeat message with higher term from 3 [term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:35.547+0800","caller":"raft/raft.go:711","msg":"a became follower at term 6"}
2021/08/20 14:25:35.547050 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 10 send 1 msgs
{"level":"info","ts":"2021-08-20T14:25:35.546+0800","caller":"raft/raft.go:1550","msg":"b switched to configuration voters=()"}
2021/08/20 14:25:35.547105 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 10 skip with no delegates, 0 commits, result <nil>
{"level":"info","ts":"2021-08-20T14:25:35.547+0800","caller":"raft/raft.go:711","msg":"b became follower at term 0"}
{"level":"info","ts":"2021-08-20T14:25:35.547+0800","caller":"raft/raft.go:388","msg":"newRaft b [peers: [], term: 0, commit: 0, applied: 0, lastindex: 0, lastterm: 0]"}
2021/08/20 14:25:35.547159 [info] [raftstore]: shard 4 peer 11 raft b added, epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:5 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:35.547178 [info] [raftstore]: shard 6 target peer doesn't exist, peer=<{ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}> message=<MsgApp>
2021/08/20 14:25:35.547183 [info] [raftstore]: shard 6 replicate peer {ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.547186 [info] [raftstore]: shard 6 init with raft local state {HardState:{Term:0 Vote:0 Commit:0 XXX_unrecognized:[]} LastIndex:0 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.547188 [info] [raftstore]: shard 6 init raft apply state, state=<{AppliedIndex:0 TruncatedState:{Index:0 Term:0 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:35.547189 [info] [raftstore]: shard 6 init last term, last term=<0>
{"level":"info","ts":"2021-08-20T14:25:35.547+0800","caller":"raft/raft.go:1550","msg":"c switched to configuration voters=()"}
{"level":"info","ts":"2021-08-20T14:25:35.547+0800","caller":"raft/raft.go:711","msg":"c became follower at term 0"}
{"level":"info","ts":"2021-08-20T14:25:35.547+0800","caller":"raft/raft.go:388","msg":"newRaft c [peers: [], term: 0, commit: 0, applied: 0, lastindex: 0, lastterm: 0]"}
{"level":"info","ts":"2021-08-20T14:25:35.547+0800","caller":"raft/raft.go:870","msg":"b [term: 0] received a MsgHeartbeat message with higher term from 5 [term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:35.547+0800","caller":"raft/raft.go:711","msg":"b became follower at term 6"}
2021/08/20 14:25:35.547217 [info] [raftstore]: shard 6 peer 12 raft c added, epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:7 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}], raft worker 0, apply worker apply-0-0
2021/08/20 14:25:35.547240 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 1 msgs
2021/08/20 14:25:35.547260 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 0 commits, result <nil>
{"level":"info","ts":"2021-08-20T14:25:35.547+0800","caller":"raft/raft.go:870","msg":"c [term: 0] received a MsgHeartbeat message with higher term from 7 [term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:35.547+0800","caller":"raft/raft.go:711","msg":"c became follower at term 6"}
2021/08/20 14:25:35.547287 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 send 1 msgs
2021/08/20 14:25:35.547297 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 skip with no delegates, 0 commits, result <nil>
2021/08/20 14:25:35.547643 [info] prophet: resource 2 send schedule command, step promote learner peer 10 on container 9 to voter, source heartbeat
2021/08/20 14:25:35.547698 [info] prophet: resource 4 ConfVer changed from 1 to 2
2021/08/20 14:25:35.547730 [info] [raftstore]: shard-2 AddNode peer {ID:10 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.547775 [info] [transport]: connected to store 1
2021/08/20 14:25:35.547794 [info] [transport]: session 1[127.0.0.1:36636] connected
2021/08/20 14:25:35.547860 [info] [raftstore]: shard-2 propose conf change peer [{ChangeType:AddNode Peer:{ID:10 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.547929 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 5 AdvanceApply with 8
2021/08/20 14:25:35.547954 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 7 AdvanceApply with 8
2021/08/20 14:25:35.547931 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 10 send 1 msgs
2021/08/20 14:25:35.547977 [info] [raftstore]: shard 2 do apply change peer peer:<id:10 containerID:9 >  at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:10 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.547986 [info] [raftstore]: shard-2 add peer {ID:10 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} successfully, peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:10 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.547990 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 10 skip with no delegates, 0 commits, result <nil>
2021/08/20 14:25:35.547997 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 send 1 msgs
2021/08/20 14:25:35.548027 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 skip with no delegates, 0 commits, result <nil>
2021/08/20 14:25:35.548040 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 1 msgs
2021/08/20 14:25:35.548042 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 0 commits, result <nil>
{"level":"error","ts":"2021-08-20T14:25:35.548+0800","caller":"raft/log.go:354","msg":"3 >>>>>>>>>>>>>>>> [1:10:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).sendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:442\ngo.etcd.io/etcd/raft.stepLeader\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1150\ngo.etcd.io/etcd/raft.(*raft).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:995\ngo.etcd.io/etcd/raft.(*RawNode).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:114\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleStep\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:257\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:183\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:443\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:35.548091 [info] [raftstore]: shard 2 start snapshot, epoch=<{ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:35.548200 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 3 AdvanceApply with 9
{"level":"info","ts":"2021-08-20T14:25:35.548+0800","caller":"raft/raft.go:1550","msg":"3 switched to configuration voters=(3 10)"}
{"level":"error","ts":"2021-08-20T14:25:35.548+0800","caller":"raft/log.go:354","msg":"3 >>>>>>>>>>>>>>>> [1:10:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).switchToConfig.func1\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1586\ngo.etcd.io/etcd/raft/tracker.(*ProgressTracker).Visit\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/tracker/tracker.go:209\ngo.etcd.io/etcd/raft.(*raft).switchToConfig\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1585\ngo.etcd.io/etcd/raft.(*raft).applyConfChange\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1537\ngo.etcd.io/etcd/raft.(*RawNode).ApplyConfChange\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:103\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).doApplyConfChange\n\t/root/projects/matrixcube/raftstore/peer_event_post_apply.go:106\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).doPostApplyResult\n\t/root/projects/matrixcube/raftstore/peer_event_post_apply.go:92\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).doPollApply\n\t/root/projects/matrixcube/raftstore/peer_event_post_apply.go:51\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleApplyResult\n\t/root/projects/matrixcube/raftstore/peer_event_post_apply.go:39\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:186\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:443\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:35.548281 [info] [raftstore]: shard 2 notify pd with {Transition:ConfChangeTransitionAuto Changes:[{Type:ConfChangeAddNode NodeID:10 XXX_unrecognized:[]}] Context:[10 32 10 16 87 92 67 97 108 116 74 97 148 84 49 214 167 195 130 217 16 2 26 4 8 3 16 1 42 4 8 2 16 1 26 10 8 1 18 6 18 4 8 10 16 9] XXX_unrecognized:[]} with changes [{ChangeType:AddNode Peer:{ID:10 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.548292 [info] [raftstore]: shard 2 applied changes [{ChangeType:AddNode Peer:{ID:10 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, new peers [{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:10 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.548356 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 10 send 1 msgs
{"level":"error","ts":"2021-08-20T14:25:35.548+0800","caller":"raft/log.go:354","msg":"5 >>>>>>>>>>>>>>>> [1:9:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).sendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:442\ngo.etcd.io/etcd/raft.stepLeader\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1150\ngo.etcd.io/etcd/raft.(*raft).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:995\ngo.etcd.io/etcd/raft.(*RawNode).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:114\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleStep\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:257\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:183\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:443\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:35.548394 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 10 skip with no delegates, 0 commits, result <nil>
2021/08/20 14:25:35.548397 [info] [raftstore]: shard 4 start snapshot, epoch=<{ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
{"level":"error","ts":"2021-08-20T14:25:35.548+0800","caller":"raft/log.go:354","msg":"7 >>>>>>>>>>>>>>>> [1:9:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).sendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:442\ngo.etcd.io/etcd/raft.stepLeader\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1150\ngo.etcd.io/etcd/raft.(*raft).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:995\ngo.etcd.io/etcd/raft.(*RawNode).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:114\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleStep\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:257\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:183\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:443\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:35.548422 [info] [raftstore]: shard 2 snapshot created, epoch=<confVer:3 version:1 > term=<6> index=<9> 
2021/08/20 14:25:35.548435 [info] [raftstore]: shard 6 start snapshot, epoch=<{ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
{"level":"error","ts":"2021-08-20T14:25:35.548+0800","caller":"raft/log.go:354","msg":"3 >>>>>>>>>>>>>>>> [1:10:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).sendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:442\ngo.etcd.io/etcd/raft.stepLeader\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1208\ngo.etcd.io/etcd/raft.(*raft).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:995\ngo.etcd.io/etcd/raft.(*RawNode).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:114\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleStep\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:257\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:183\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:443\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:35.548597 [info] [transport]: shard 2 start send pending snap, epoch=<confVer:3 version:1 > term=<6> index=<9>
2021/08/20 14:25:35.548707 [info] [raftstore]: shard 4 snapshot created, epoch=<confVer:2 version:1 > term=<6> index=<8> 
2021/08/20 14:25:35.548732 [info] [transport]: connected to store 9
2021/08/20 14:25:35.548740 [info] [transport]: session 2[127.0.0.1:58954] connected
{"level":"info","ts":"2021-08-20T14:25:35.548+0800","caller":"raft/log.go:301","msg":"log [committed=0, applied=0, unstable.offset=1, len(unstable.Entries)=0] starts to restore snapshot [index: 9, term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:35.548+0800","caller":"raft/raft.go:1550","msg":"a switched to configuration voters=(3 10)"}
{"level":"info","ts":"2021-08-20T14:25:35.548+0800","caller":"raft/raft.go:1503","msg":"a [commit: 9, lastindex: 9, lastterm: 6] restored snapshot [index: 9, term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:35.548+0800","caller":"raft/raft.go:1420","msg":"a [commit: 9] restored snapshot [index: 9, term: 6]"}
2021/08/20 14:25:35.548831 [info] [raftstore]: shard 2 peer 10 receiving snapshot, skip further handling
2021/08/20 14:25:35.548913 [info] [raftstore]: shard 6 snapshot created, epoch=<confVer:2 version:1 > term=<6> index=<8> 
2021/08/20 14:25:35.548933 [info] [raftstore]: shard 2 try to send snap, header=<shard:<id:2 start:"a" end:"b" epoch:<confVer:3 version:1 > peers:<id:3 containerID:1 > peers:<id:10 containerID:9 > > from:<id:3 containerID:1 > to:<id:10 containerID:9 role:Learner > term:6 index:9 >,size=<126>
2021/08/20 14:25:35.548958 [info] [raftstore]: shard 2 send snap complete
2021/08/20 14:25:35.548963 [info] [transport]: shard 2 pending snap sent succ, size=<126>, epoch=<confVer:3 version:1 > term=<6> index=<9>
2021/08/20 14:25:35.550241 [info] prophet: [prophet-leader/node-1]/watch: leader updated to 涕Ӷnode-0127.0.0.1:30000
2021/08/20 14:25:35.550834 [info] prophet: resource 4 send schedule command, step promote learner peer 11 on container 9 to voter, source heartbeat
2021/08/20 14:25:35.550876 [info] prophet: resource 6 ConfVer changed from 1 to 2
2021/08/20 14:25:35.550946 [info] [raftstore]: shard-4 AddNode peer {ID:11 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.551713 [info] prophet: resource 6 send schedule command, step promote learner peer 12 on container 9 to voter, source heartbeat
2021/08/20 14:25:35.551748 [info] prophet: resource 2 ConfVer changed from 2 to 3
2021/08/20 14:25:35.551793 [info] [raftstore]: shard-6 AddNode peer {ID:12 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.552790 [info] prophet: resource 2 operator(add-rule-peer {add peer: container [9]} (kind:resource,replica, resource:2(1,1), createAt:2021-08-20 14:25:35.5343127 +0800 CST m=+31.067839301, startAt:2021-08-20 14:25:35.5343509 +0800 CST m=+31.067877601, currentStep:2, steps:[add learner peer 10 on container 9, promote learner peer 10 on container 9 to voter]) finished) finish, takes 18.4296ms, 
2021/08/20 14:25:35.556136 [info] [raftstore]: shard-4 propose conf change peer [{ChangeType:AddNode Peer:{ID:11 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
{"level":"error","ts":"2021-08-20T14:25:35.556+0800","caller":"raft/log.go:354","msg":"5 >>>>>>>>>>>>>>>> [1:10:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).sendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:442\ngo.etcd.io/etcd/raft.(*raft).bcastAppend.func1\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:538\ngo.etcd.io/etcd/raft/tracker.(*ProgressTracker).Visit\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/tracker/tracker.go:209\ngo.etcd.io/etcd/raft.(*raft).bcastAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:534\ngo.etcd.io/etcd/raft.stepLeader\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1090\ngo.etcd.io/etcd/raft.(*raft).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:995\ngo.etcd.io/etcd/raft.(*RawNode).ProposeConfChange\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:98\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).proposeConfChangeInternal\n\t/root/projects/matrixcube/raftstore/peer_event_proposal.go:262\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).proposeConfChange\n\t/root/projects/matrixcube/raftstore/peer_event_proposal.go:232\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).propose\n\t/root/projects/matrixcube/raftstore/peer_event_proposal.go:141\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleRequest\n\t/root/projects/matrixcube/raftstore/peer_event_proposal.go:98\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:187\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:447\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:35.556220 [info] [transport]: shard 4 start send pending snap, epoch=<confVer:2 version:1 > term=<6> index=<8>
2021/08/20 14:25:35.556425 [info] [raftstore]: shard 4 do apply change peer peer:<id:11 containerID:9 >  at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:5 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
{"level":"info","ts":"2021-08-20T14:25:35.556+0800","caller":"raft/log.go:301","msg":"log [committed=0, applied=0, unstable.offset=1, len(unstable.Entries)=0] starts to restore snapshot [index: 8, term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:35.556+0800","caller":"raft/raft.go:1550","msg":"b switched to configuration voters=(5 11)"}
{"level":"info","ts":"2021-08-20T14:25:35.556+0800","caller":"raft/raft.go:1503","msg":"b [commit: 8, lastindex: 8, lastterm: 6] restored snapshot [index: 8, term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:35.556+0800","caller":"raft/raft.go:1420","msg":"b [commit: 8] restored snapshot [index: 8, term: 6]"}
2021/08/20 14:25:35.556447 [info] [raftstore]: shard-4 add peer {ID:11 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} successfully, peers [{ID:5 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:11 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.556470 [info] [raftstore]: shard-6 propose conf change peer [{ChangeType:AddNode Peer:{ID:12 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
{"level":"error","ts":"2021-08-20T14:25:35.556+0800","caller":"raft/log.go:354","msg":"7 >>>>>>>>>>>>>>>> [1:10:6)","stacktrace":"go.etcd.io/etcd/pkg/logutil.(*zapRaftLogger).Errorf\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/pkg/logutil/zap_raft.go:69\ngo.etcd.io/etcd/raft.(*raftLog).mustCheckOutOfBounds\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:354\ngo.etcd.io/etcd/raft.(*raftLog).slice\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:308\ngo.etcd.io/etcd/raft.(*raftLog).entries\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/log.go:258\ngo.etcd.io/etcd/raft.(*raft).maybeSendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:459\ngo.etcd.io/etcd/raft.(*raft).sendAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:442\ngo.etcd.io/etcd/raft.(*raft).bcastAppend.func1\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:538\ngo.etcd.io/etcd/raft/tracker.(*ProgressTracker).Visit\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/tracker/tracker.go:209\ngo.etcd.io/etcd/raft.(*raft).bcastAppend\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:534\ngo.etcd.io/etcd/raft.stepLeader\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:1090\ngo.etcd.io/etcd/raft.(*raft).Step\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/raft.go:995\ngo.etcd.io/etcd/raft.(*RawNode).ProposeConfChange\n\t/root/projects/matrixcube/vendor/go.etcd.io/etcd/raft/rawnode.go:98\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).proposeConfChangeInternal\n\t/root/projects/matrixcube/raftstore/peer_event_proposal.go:262\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).proposeConfChange\n\t/root/projects/matrixcube/raftstore/peer_event_proposal.go:232\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).propose\n\t/root/projects/matrixcube/raftstore/peer_event_proposal.go:141\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleRequest\n\t/root/projects/matrixcube/raftstore/peer_event_proposal.go:98\ngithub.com/matrixorigin/matrixcube/raftstore.(*peerReplica).handleEvent\n\t/root/projects/matrixcube/raftstore/peer_event_loop.go:187\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1.1\n\t/root/projects/matrixcube/raftstore/store.go:420\nsync.(*Map).Range\n\t/opt/lib/go/src/sync/map.go:345\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask.func1\n\t/root/projects/matrixcube/raftstore/store.go:418\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).runPRTask\n\t/root/projects/matrixcube/raftstore/store.go:447\ngithub.com/matrixorigin/matrixcube/raftstore.(*store).startRaftWorkers.func1\n\t/root/projects/matrixcube/raftstore/store.go:406\ngithub.com/fagongzi/util/task.(*Runner).RunCancelableTask.func1\n\t/root/projects/matrixcube/vendor/github.com/fagongzi/util/task/task.go:350"}
2021/08/20 14:25:35.556508 [info] [raftstore]: shard 4 peer 11 receiving snapshot, skip further handling
2021/08/20 14:25:35.556510 [info] [raftstore]: shard 4 try to send snap, header=<shard:<id:4 start:"b" end:"c" epoch:<confVer:2 version:1 > peers:<id:5 containerID:1 > peers:<id:11 containerID:9 role:Learner > > from:<id:5 containerID:1 > to:<id:11 containerID:9 role:Learner > term:6 index:8 >,size=<126>
2021/08/20 14:25:35.556659 [info] [raftstore]: shard 4 send snap complete
{"level":"info","ts":"2021-08-20T14:25:35.556+0800","caller":"raft/log.go:301","msg":"log [committed=0, applied=0, unstable.offset=1, len(unstable.Entries)=0] starts to restore snapshot [index: 8, term: 6]"}
2021/08/20 14:25:35.556667 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 5 AdvanceApply with 9
2021/08/20 14:25:35.556673 [info] [transport]: shard 4 pending snap sent succ, size=<126>, epoch=<confVer:2 version:1 > term=<6> index=<8>
{"level":"info","ts":"2021-08-20T14:25:35.556+0800","caller":"raft/raft.go:1550","msg":"c switched to configuration voters=(7 12)"}
{"level":"info","ts":"2021-08-20T14:25:35.556+0800","caller":"raft/raft.go:1550","msg":"5 switched to configuration voters=(5 11)"}
{"level":"info","ts":"2021-08-20T14:25:35.556+0800","caller":"raft/raft.go:1503","msg":"c [commit: 8, lastindex: 8, lastterm: 6] restored snapshot [index: 8, term: 6]"}
{"level":"info","ts":"2021-08-20T14:25:35.556+0800","caller":"raft/raft.go:1420","msg":"c [commit: 8] restored snapshot [index: 8, term: 6]"}
2021/08/20 14:25:35.556680 [info] [transport]: shard 6 start send pending snap, epoch=<confVer:2 version:1 > term=<6> index=<8>
2021/08/20 14:25:35.556705 [info] [raftstore]: shard 4 notify pd with {Transition:ConfChangeTransitionAuto Changes:[{Type:ConfChangeAddNode NodeID:11 XXX_unrecognized:[]}] Context:[10 32 10 16 249 232 133 14 110 35 77 215 133 173 173 187 48 123 102 172 16 4 26 4 8 5 16 1 42 4 8 2 16 1 26 10 8 1 18 6 18 4 8 11 16 9] XXX_unrecognized:[]} with changes [{ChangeType:AddNode Peer:{ID:11 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.556890 [info] [raftstore]: shard 4 applied changes [{ChangeType:AddNode Peer:{ID:11 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, new peers [{ID:5 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:11 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.556659 [info] [raftstore]: shard 6 do apply change peer peer:<id:12 containerID:9 >  at epoch {ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, peers [{ID:7 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.556968 [info] [raftstore]: shard-6 add peer {ID:12 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} successfully, peers [{ID:7 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:12 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.556971 [info] prophet: resource 4 ConfVer changed from 2 to 3
2021/08/20 14:25:35.557001 [info] [raftstore]: shard 6 try to send snap, header=<shard:<id:6 start:"c" end:"d" epoch:<confVer:2 version:1 > peers:<id:7 containerID:1 > peers:<id:12 containerID:9 role:Learner > > from:<id:7 containerID:1 > to:<id:12 containerID:9 role:Learner > term:6 index:8 >,size=<126>
2021/08/20 14:25:35.556714 [info] [raftstore]: shard 6 peer 12 receiving snapshot, skip further handling
2021/08/20 14:25:35.557034 [info] [raftstore]: shard 6 send snap complete
2021/08/20 14:25:35.557040 [info] [raftstore]: shard 4 begin to apply snapshot
2021/08/20 14:25:35.557047 [info] [transport]: shard 6 pending snap sent succ, size=<126>, epoch=<confVer:2 version:1 > term=<6> index=<8>
2021/08/20 14:25:35.557047 [info] [raftstore]: shard 4 clear 0 meta keys and 0 raft keys
2021/08/20 14:25:35.557054 [info] [raftstore]: shard 4 apply snapshot state completed, apply state {AppliedIndex:8 TruncatedState:{Index:8 Term:6 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.557061 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 start applying snapshot
2021/08/20 14:25:35.557116 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 1 msgs
2021/08/20 14:25:35.557143 [info] [raftstore]: shard 4 begin apply snapshot data
2021/08/20 14:25:35.557195 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 7 AdvanceApply with 9
{"level":"info","ts":"2021-08-20T14:25:35.557+0800","caller":"raft/raft.go:1550","msg":"7 switched to configuration voters=(7 12)"}
2021/08/20 14:25:35.557150 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 add registration job by handleRaftReadyApply
2021/08/20 14:25:35.557245 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 applying snapshot to set read 8
2021/08/20 14:25:35.557253 [info] [raftstore]: shard 4 snapshot is applied, shard=<{ID:4 Start:[98] End:[99] Epoch:{ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:5 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:35.557273 [info] [raftstore]: shard 4 shard changed after apply snapshot, from=<{ID:4 Start:[98] End:[99] Epoch:{ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:5 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}> to=<{ID:4 Start:[98] End:[99] Epoch:{ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:5 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:11 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:35.557276 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 AdvanceApply with 8
2021/08/20 14:25:35.557242 [info] [raftstore]: shard 6 notify pd with {Transition:ConfChangeTransitionAuto Changes:[{Type:ConfChangeAddNode NodeID:12 XXX_unrecognized:[]}] Context:[10 32 10 16 197 70 150 229 166 95 72 100 169 249 233 191 52 139 214 124 16 6 26 4 8 7 16 1 42 4 8 2 16 1 26 10 8 1 18 6 18 4 8 12 16 9] XXX_unrecognized:[]} with changes [{ChangeType:AddNode Peer:{ID:12 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.557290 [info] [raftstore]: shard 6 applied changes [{ChangeType:AddNode Peer:{ID:12 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] at epoch {ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}, new peers [{ID:7 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:12 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}]
2021/08/20 14:25:35.557335 [info] [raftstore]: shard 4 delete exists snap gz file /tmp/cube/node-1/snapshots/4_6_8.gz, header is shard:<id:4 start:"b" end:"c" epoch:<confVer:2 version:1 > peers:<id:5 containerID:1 > peers:<id:11 containerID:9 role:Learner > > from:<> to:<> term:6 index:8 
2021/08/20 14:25:35.557335 [info] [raftstore]: shard 6 begin to apply snapshot
2021/08/20 14:25:35.557395 [info] [raftstore]: shard 6 clear 0 meta keys and 0 raft keys
2021/08/20 14:25:35.557399 [info] [raftstore]: shard 4 apply snapshot data complete, {Term:6 Vote:0 Commit:8 XXX_unrecognized:[]}
2021/08/20 14:25:35.557403 [info] [raftstore]: shard 6 apply snapshot state completed, apply state {AppliedIndex:8 TruncatedState:{Index:8 Term:6 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.557409 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 start applying snapshot
2021/08/20 14:25:35.557411 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 send 1 msgs
2021/08/20 14:25:35.557440 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 add registration job by handleRaftReadyApply
2021/08/20 14:25:35.557450 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 applying snapshot to set read 8
2021/08/20 14:25:35.557460 [info] [raftstore]: shard 6 snapshot is applied, shard=<{ID:6 Start:[99] End:[100] Epoch:{ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:7 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:35.557477 [info] [raftstore]: shard 6 shard changed after apply snapshot, from=<{ID:6 Start:[99] End:[100] Epoch:{ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:7 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}> to=<{ID:6 Start:[99] End:[100] Epoch:{ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:7 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:12 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:35.557487 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 AdvanceApply with 8
2021/08/20 14:25:35.558146 [info] prophet: resource 4 operator(add-rule-peer {add peer: container [9]} (kind:resource,replica, resource:4(1,1), createAt:2021-08-20 14:25:35.5343892 +0800 CST m=+31.067915801, startAt:2021-08-20 14:25:35.5344096 +0800 CST m=+31.067936201, currentStep:2, steps:[add learner peer 11 on container 9, promote learner peer 11 on container 9 to voter]) finished) finish, takes 23.7102ms, 
2021/08/20 14:25:35.558185 [info] prophet: resource 6 ConfVer changed from 2 to 3
2021/08/20 14:25:35.559301 [info] prophet: resource 6 operator(add-rule-peer {add peer: container [9]} (kind:resource,replica, resource:6(1,1), createAt:2021-08-20 14:25:35.5344314 +0800 CST m=+31.067958001, startAt:2021-08-20 14:25:35.5344502 +0800 CST m=+31.067976901, currentStep:2, steps:[add learner peer 12 on container 9, promote learner peer 12 on container 9 to voter]) finished) finish, takes 24.8422ms, 
2021/08/20 14:25:35.624069 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 1 msgs
2021/08/20 14:25:35.624113 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:35.624230 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 1 msgs
2021/08/20 14:25:35.624273 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:35.723695 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 0 msgs
2021/08/20 14:25:35.723717 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:35.723771 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 1 msgs
2021/08/20 14:25:35.723813 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:35.723855 [info] [raftstore]: shard 2 begin to apply snapshot
2021/08/20 14:25:35.723873 [info] [raftstore]: shard 2 clear 0 meta keys and 0 raft keys
2021/08/20 14:25:35.723889 [info] [raftstore]: shard 2 apply snapshot state completed, apply state {AppliedIndex:9 TruncatedState:{Index:9 Term:6 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}
2021/08/20 14:25:35.723909 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 10 start applying snapshot
2021/08/20 14:25:35.723913 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 10 send 1 msgs
2021/08/20 14:25:35.723959 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 10 add registration job by handleRaftReadyApply
2021/08/20 14:25:35.723978 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 10 applying snapshot to set read 9
2021/08/20 14:25:35.724002 [info] [raftstore]: shard 2 snapshot is applied, shard=<{ID:2 Start:[97] End:[98] Epoch:{ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:10 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:35.724021 [info] [raftstore]: shard 2 shard changed after apply snapshot, from=<{ID:2 Start:[97] End:[98] Epoch:{ConfVer:2 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:10 ContainerID:9 Role:Learner XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}> to=<{ID:2 Start:[97] End:[98] Epoch:{ConfVer:3 Version:1 XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} State:Running Peers:[{ID:3 ContainerID:1 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0} {ID:10 ContainerID:9 Role:Voter XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}] DisableSplit:false Group:0 Unique: RuleGroups:[] Data:[] XXX_NoUnkeyedLiteral:{} XXX_unrecognized:[] XXX_sizecache:0}>
2021/08/20 14:25:35.724048 [error] [raftstore]: >>>>>>>>>>>> shard 2 peer 10 AdvanceApply with 9
2021/08/20 14:25:35.823444 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 0 msgs
2021/08/20 14:25:35.823454 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:35.924201 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 0 msgs
2021/08/20 14:25:35.924220 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:35.924313 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 1 msgs
2021/08/20 14:25:35.924362 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 1 commits, result <nil>
2021-08-20 14:25:35.963308 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:9c2555697317caf4 RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:35.963+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-5893ad94-827a-4a7c-8f02-d691ed8b1d2e/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:35.963464 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:36.023769 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 0 msgs
2021/08/20 14:25:36.023784 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:36.124091 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 0 msgs
2021/08/20 14:25:36.124106 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:36.124188 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 1 msgs
2021/08/20 14:25:36.124226 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:36.223516 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 0 msgs
2021/08/20 14:25:36.223533 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:36.324062 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 0 msgs
2021/08/20 14:25:36.324081 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:36.324158 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 1 msgs
2021/08/20 14:25:36.324207 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:36.423391 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 0 msgs
2021/08/20 14:25:36.423409 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 1 commits, result <nil>
2021-08-20 14:25:36.464454 W | etcdserver: not healthy for reconfigure, rejecting member add {ID:fde6983e274f47fc RaftAttributes:{PeerURLs:[http://127.0.0.1:50002] IsLearner:false} Attributes:{Name: ClientURLs:[]}}
{"level":"warn","ts":"2021-08-20T14:25:36.464+0800","caller":"clientv3/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"endpoint://client-5893ad94-827a-4a7c-8f02-d691ed8b1d2e/127.0.0.1:40000","attempt":0,"error":"rpc error: code = Unavailable desc = etcdserver: unhealthy cluster"}
2021/08/20 14:25:36.464588 [error] prophet: add member to embed etcd failed with etcdserver: unhealthy cluster, retry later
2021/08/20 14:25:36.524071 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 0 msgs
2021/08/20 14:25:36.524092 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:36.524219 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 1 msgs
2021/08/20 14:25:36.524264 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:36.557534 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 add registration job by handleRaftReadyApply, completed
2021/08/20 14:25:36.557548 [info] [raftstore]: shard 6 begin apply snapshot data
2021/08/20 14:25:36.557759 [info] [raftstore]: shard 6 delete exists snap gz file /tmp/cube/node-1/snapshots/6_6_8.gz, header is shard:<id:6 start:"c" end:"d" epoch:<confVer:2 version:1 > peers:<id:7 containerID:1 > peers:<id:12 containerID:9 role:Learner > > from:<> to:<> term:6 index:8 
2021/08/20 14:25:36.557805 [info] [raftstore]: shard 6 apply snapshot data complete, {Term:6 Vote:0 Commit:8 XXX_unrecognized:[]}
2021/08/20 14:25:36.623406 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 0 msgs
2021/08/20 14:25:36.623435 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 send 6 msgs
2021/08/20 14:25:36.623490 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:36.623627 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 send 1 msgs
2021/08/20 14:25:36.623664 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:36.723862 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 send 0 msgs
2021/08/20 14:25:36.723881 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 skip with no delegates, 1 commits, result <nil>
2021/08/20 14:25:36.724008 [error] [raftstore]: >>>>>>>>>>>> shard 4 peer 11 send 1 msgs
2021/08/20 14:25:36.724079 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 send 1 msgs
2021/08/20 14:25:36.724093 [error] [raftstore]: >>>>>>>>>>>> shard 6 peer 12 skip with no delegates, 1 commits, result <nil>
FAIL	github.com/matrixorigin/matrixcube/raftstore	32.304s
